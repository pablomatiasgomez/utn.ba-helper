/**
 * Skipped minification because the original files appears to be already minified.
 * Original file: /npm/@embrace-io/web-sdk@2.2.0/build/iife/bundle.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var EmbraceWebSdk=function(t){"use strict";const e=new class{logException(t,e){}message(t,e,n){}};class n{getDelegate(){var t;return null!=(t=this._delegate)?t:e}setDelegate(t){this._delegate=t}logException(t,e){this.getDelegate().logException(t,e)}message(t,e,n){this.getDelegate().message(t,e,n)}}class r{static getInstance(){return r._instance||(r._instance=new r({proxyLogManager:new n})),r._instance}setGlobalLogManager(t){this._proxyLogManager.setDelegate(t)}logException(t,e){this.getLogManager().logException(t,e)}message(t,e,n){this.getLogManager().message(t,e,n)}constructor({proxyLogManager:t}){this.getLogManager=()=>this._proxyLogManager,this._proxyLogManager=t}}const i=r.getInstance();const s=new class{addBreadcrumb(t){}addProperty(t,e,n){}removeProperty(t){}endSessionSpan(){}endSessionSpanInternal(t){}currentSessionAsReadableSpan(t){return null}getSessionSpan(){return null}getSessionStartTime(){return null}startSessionSpan(){}addSessionStartedListener(t){return()=>{}}addSessionEndedListener(t){return()=>{}}constructor(){this.getSessionId=()=>null}};class o{getDelegate(){var t;return null!=(t=this._delegate)?t:s}setDelegate(t){this._delegate=t}addBreadcrumb(t){this.getDelegate().addBreadcrumb(t)}addProperty(t,e,n){this.getDelegate().addProperty(t,e,n)}removeProperty(t){this.getDelegate().removeProperty(t)}endSessionSpan(){this.getDelegate().endSessionSpan()}endSessionSpanInternal(t){this.getDelegate().endSessionSpanInternal(t)}currentSessionAsReadableSpan(t){return this.getDelegate().currentSessionAsReadableSpan(t)}getSessionId(){return this.getDelegate().getSessionId()}getSessionSpan(){return this.getDelegate().getSessionSpan()}getSessionStartTime(){return this.getDelegate().getSessionStartTime()}startSessionSpan(t){this.getDelegate().startSessionSpan(t)}addSessionStartedListener(t){return this.getDelegate().addSessionStartedListener(t)}addSessionEndedListener(t){return this.getDelegate().addSessionEndedListener(t)}}class a{static getInstance(){return a._instance||(a._instance=new a({proxySpanSessionManager:new o})),a._instance}setGlobalSessionManager(t){this._proxySpanSessionManager.setDelegate(t)}addBreadcrumb(t){this.getSpanSessionManager().addBreadcrumb(t)}addProperty(t,e,n){this.getSpanSessionManager().addProperty(t,e,n)}removeProperty(t){this.getSpanSessionManager().removeProperty(t)}endSessionSpan(){this.getSpanSessionManager().endSessionSpan()}endSessionSpanInternal(t){this.getSpanSessionManager().endSessionSpanInternal(t)}currentSessionAsReadableSpan(t){return this.getSpanSessionManager().currentSessionAsReadableSpan(t)}getSessionId(){return this.getSpanSessionManager().getSessionId()}getSessionSpan(){return this.getSpanSessionManager().getSessionSpan()}getSessionStartTime(){return this.getSpanSessionManager().getSessionStartTime()}startSessionSpan(t){this.getSpanSessionManager().startSessionSpan(t)}addSessionStartedListener(t){return this.getSpanSessionManager().addSessionStartedListener(t)}addSessionEndedListener(t){return this.getSpanSessionManager().addSessionEndedListener(t)}constructor({proxySpanSessionManager:t}){this.getSpanSessionManager=()=>this._proxySpanSessionManager,this._proxySpanSessionManager=t}}const u=a.getInstance();var c="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},l="1.9.0",d=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var h=function(t){var e=new Set([t]),n=new Set,r=t.match(d);if(!r)return function(){return!1};var i=+r[1],s=+r[2],o=+r[3];if(null!=r[4])return function(e){return e===t};function a(t){return n.add(t),!1}function u(t){return e.add(t),!0}return function(t){if(e.has(t))return!0;if(n.has(t))return!1;var r=t.match(d);if(!r)return a(t);var c=+r[1],l=+r[2],h=+r[3];return null!=r[4]||i!==c?a(t):0===i?s===l&&o<=h?u(t):a(t):s<=l?u(t):a(t)}}(l),p=l.split(".")[0],g=Symbol.for("opentelemetry.js.api."+p),m=c;function f(t,e,n,r){var i;void 0===r&&(r=!1);var s=m[g]=null!==(i=m[g])&&void 0!==i?i:{version:l};if(!r&&s[t]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return n.error(o.stack||o.message),!1}if(s.version!==l){o=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+l);return n.error(o.stack||o.message),!1}return s[t]=e,n.debug("@opentelemetry/api: Registered a global for "+t+" v"+l+"."),!0}function _(t){var e,n,r=null===(e=m[g])||void 0===e?void 0:e.version;if(r&&h(r))return null===(n=m[g])||void 0===n?void 0:n[t]}function v(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+l+".");var n=m[g];n&&delete n[t]}var b,S=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},y=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},E=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("verbose",this._namespace,t)},t}();function T(t,e,n){var r=_("diag");if(r)return n.unshift(e),r[t].apply(r,y([],S(n),!1))}t.DiagLogLevel=void 0,(b=t.DiagLogLevel||(t.DiagLogLevel={}))[b.NONE=0]="NONE",b[b.ERROR=30]="ERROR",b[b.WARN=50]="WARN",b[b.INFO=60]="INFO",b[b.DEBUG=70]="DEBUG",b[b.VERBOSE=80]="VERBOSE",b[b.ALL=9999]="ALL";var w=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},A=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},L=function(){function e(){function e(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_("diag");if(r)return r[t].apply(r,A([],w(e),!1))}}var n=this;n.setLogger=function(e,r){var i,s,o;if(void 0===r&&(r={logLevel:t.DiagLogLevel.INFO}),e===n){var a=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error(null!==(i=a.stack)&&void 0!==i?i:a.message),!1}"number"==typeof r&&(r={logLevel:r});var u=_("diag"),c=function(e,n){function r(t,r){var i=n[t];return"function"==typeof i&&e>=r?i.bind(n):function(){}}return e<t.DiagLogLevel.NONE?e=t.DiagLogLevel.NONE:e>t.DiagLogLevel.ALL&&(e=t.DiagLogLevel.ALL),n=n||{},{error:r("error",t.DiagLogLevel.ERROR),warn:r("warn",t.DiagLogLevel.WARN),info:r("info",t.DiagLogLevel.INFO),debug:r("debug",t.DiagLogLevel.DEBUG),verbose:r("verbose",t.DiagLogLevel.VERBOSE)}}(null!==(s=r.logLevel)&&void 0!==s?s:t.DiagLogLevel.INFO,e);if(u&&!r.suppressOverrideMessage){var l=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+l),c.warn("Current logger will overwrite one already registered from "+l)}return f("diag",c,n,!0)},n.disable=function(){v("diag",n)},n.createComponentLogger=function(t){return new E(t)},n.verbose=e("verbose"),n.debug=e("debug"),n.info=e("info"),n.warn=e("warn"),n.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),C=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},R=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},O=function(){function t(t){this._entries=t?new Map(t):new Map}return t.prototype.getEntry=function(t){var e=this._entries.get(t);if(e)return Object.assign({},e)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(t){var e=C(t,2);return[e[0],e[1]]})},t.prototype.setEntry=function(e,n){var r=new t(this._entries);return r._entries.set(e,n),r},t.prototype.removeEntry=function(e){var n=new t(this._entries);return n._entries.delete(e),n},t.prototype.removeEntries=function(){for(var e,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=new t(this._entries);try{for(var o=R(r),a=o.next();!a.done;a=o.next()){var u=a.value;s._entries.delete(u)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}(),x=Symbol("BaggageEntryMetadata"),P=L.instance();function D(t){return void 0===t&&(t={}),new O(new Map(Object.entries(t)))}function N(t){return Symbol.for(t)}var I,M,k=function t(e){var n=this;n._currentContext=e?new Map(e):new Map,n.getValue=function(t){return n._currentContext.get(t)},n.setValue=function(e,r){var i=new t(n._currentContext);return i._currentContext.set(e,r),i},n.deleteValue=function(e){var r=new t(n._currentContext);return r._currentContext.delete(e),r}},U=new k,F=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],j=function(){function t(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(console){var r=console[t];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,e)}}}for(var e=0;e<F.length;e++)this[F[e].n]=t(F[e].c)},B=(I=function(t,e){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},I(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}I(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),V=function(){function t(){}return t.prototype.createGauge=function(t,e){return Z},t.prototype.createHistogram=function(t,e){return tt},t.prototype.createCounter=function(t,e){return Y},t.prototype.createUpDownCounter=function(t,e){return et},t.prototype.createObservableGauge=function(t,e){return rt},t.prototype.createObservableCounter=function(t,e){return nt},t.prototype.createObservableUpDownCounter=function(t,e){return it},t.prototype.addBatchObservableCallback=function(t,e){},t.prototype.removeBatchObservableCallback=function(t){},t}(),$=function(){},z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.add=function(t,e){},e}($),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.add=function(t,e){},e}($),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.record=function(t,e){},e}($),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.record=function(t,e){},e}($),K=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.removeCallback=function(t){},t}(),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e}(K),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e}(K),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e}(K),J=new V,Y=new z,Z=new q,tt=new G,et=new H,nt=new W,rt=new Q,it=new X,st={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},ot={set:function(t,e,n){null!=t&&(t[e]=n)}},at=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},ut=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},ct=function(){function t(){}return t.prototype.active=function(){return U},t.prototype.with=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return e.call.apply(e,ut([n],at(r),!1))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),lt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},dt=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},ht="context",pt=new ct,gt=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return f(ht,t,L.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,n){for(var r,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(r=this._getContextManager()).with.apply(r,dt([t,e,n],lt(i),!1))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return _(ht)||pt},t.prototype.disable=function(){this._getContextManager().disable(),v(ht,L.instance())},t}();!function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"}(M||(M={}));var mt="0000000000000000",ft="00000000000000000000000000000000",_t={traceId:ft,spanId:mt,traceFlags:M.NONE},vt=function(){function t(t){void 0===t&&(t=_t),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.addLink=function(t){return this},t.prototype.addLinks=function(t){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),bt=N("OpenTelemetry Context Key SPAN");function St(t){return t.getValue(bt)||void 0}function yt(){return St(gt.getInstance().active())}function Et(t,e){return t.setValue(bt,e)}function Tt(t){return t.deleteValue(bt)}function wt(t,e){return Et(t,new vt(e))}function At(t){var e;return null===(e=St(t))||void 0===e?void 0:e.spanContext()}var Lt=/^([0-9a-f]{32})$/i,Ct=/^[0-9a-f]{16}$/i;function Rt(t){return Lt.test(t)&&t!==ft}function Ot(t){return Rt(t.traceId)&&(e=t.spanId,Ct.test(e)&&e!==mt);var e}function xt(t){return new vt(t)}var Pt=gt.getInstance(),Dt=function(){function t(){}return t.prototype.startSpan=function(t,e,n){if(void 0===n&&(n=Pt.active()),Boolean(null==e?void 0:e.root))return new vt;var r,i=n&&At(n);return"object"==typeof(r=i)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&Ot(i)?new vt(i):new vt},t.prototype.startActiveSpan=function(t,e,n,r){var i,s,o;if(!(arguments.length<2)){2===arguments.length?o=e:3===arguments.length?(i=e,o=n):(i=e,s=n,o=r);var a=null!=s?s:Pt.active(),u=this.startSpan(t,i,a),c=Et(a,u);return Pt.with(c,o,void 0,u)}},t}();var Nt,It,Mt,kt=new Dt,Ut=function(){function t(t,e,n,r){this._provider=t,this.name=e,this.version=n,this.options=r}return t.prototype.startSpan=function(t,e,n){return this._getTracer().startSpan(t,e,n)},t.prototype.startActiveSpan=function(t,e,n,r){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):kt},t}(),Ft=new(function(){function t(){}return t.prototype.getTracer=function(t,e,n){return new Dt},t}()),jt=function(){function t(){}return t.prototype.getTracer=function(t,e,n){var r;return null!==(r=this.getDelegateTracer(t,e,n))&&void 0!==r?r:new Ut(this,t,e,n)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Ft},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(t,e,n)},t}();!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Nt||(Nt={})),function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}(It||(It={})),function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(Mt||(Mt={}));var Bt=gt.getInstance(),Vt=L.instance(),$t=new(function(){function t(){}return t.prototype.getMeter=function(t,e,n){return J},t}()),zt="metrics",Ht=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return f(zt,t,L.instance())},t.prototype.getMeterProvider=function(){return _(zt)||$t},t.prototype.getMeter=function(t,e,n){return this.getMeterProvider().getMeter(t,e,n)},t.prototype.disable=function(){v(zt,L.instance())},t}().getInstance(),qt=function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}(),Gt=N("OpenTelemetry Baggage Key");function Kt(t){return t.getValue(Gt)||void 0}function Wt(){return Kt(gt.getInstance().active())}function Qt(t,e){return t.setValue(Gt,e)}function Xt(t){return t.deleteValue(Gt)}var Jt="propagation",Yt=new qt,Zt=function(){function t(){this.createBaggage=D,this.getBaggage=Kt,this.getActiveBaggage=Wt,this.setBaggage=Qt,this.deleteBaggage=Xt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return f(Jt,t,L.instance())},t.prototype.inject=function(t,e,n){return void 0===n&&(n=ot),this._getGlobalPropagator().inject(t,e,n)},t.prototype.extract=function(t,e,n){return void 0===n&&(n=st),this._getGlobalPropagator().extract(t,e,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){v(Jt,L.instance())},t.prototype._getGlobalPropagator=function(){return _(Jt)||Yt},t}(),te=Zt.getInstance(),ee="trace",ne=function(){function t(){this._proxyTracerProvider=new jt,this.wrapSpanContext=xt,this.isSpanContextValid=Ot,this.deleteSpan=Tt,this.getSpan=St,this.getActiveSpan=yt,this.getSpanContext=At,this.setSpan=Et,this.setSpanContext=wt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=f(ee,this._proxyTracerProvider,L.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return _(ee)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){v(ee,L.instance()),this._proxyTracerProvider=new jt},t}(),re=ne.getInstance();class ie{fail(t){}spanContext(){return this._spanContext}setAttribute(t,e){return this}setAttributes(t){return this}removeAttribute(t){return this}addEvent(t,e,n){return this}addLink(t){return this}addLinks(t){return this}setStatus(t){return this}updateName(t){return this}end(t){}isRecording(){return!1}recordException(t,e){}constructor(t=_t){this.attributes={},this._spanContext=t}}const se=new class{startSpan(t,e){return new ie}setSpan(t,e){return U}getSpan(t){}};class oe{getDelegate(){var t;return null!=(t=this._delegate)?t:se}setDelegate(t){this._delegate=t}startSpan(t,e,n){return this.getDelegate().startSpan(t,e,n)}setSpan(t,e){return this.getDelegate().setSpan(t,e)}getSpan(t){return this.getDelegate().getSpan(t)}}class ae{static getInstance(){return ae._instance||(ae._instance=new ae({proxyTraceManager:new oe})),ae._instance}setGlobalTraceManager(t){this._proxyTraceManager.setDelegate(t)}startSpan(t,e,n){return this.getTraceManager().startSpan(t,e,n)}setSpan(t,e){return this.getTraceManager().setSpan(t,e)}getSpan(t){return this.getTraceManager().getSpan(t)}constructor({proxyTraceManager:t}){this.getTraceManager=()=>this._proxyTraceManager,this._proxyTraceManager=t}}const ue=ae.getInstance(),ce="enduser.pseudo.id";const le=new class{getEmbraceUserId(){return""}getUserId(){return null}setUserId(){}clearUserId(){}};class de{getDelegate(){var t;return null!=(t=this._delegate)?t:le}setDelegate(t){this._delegate=t}getEmbraceUserId(){return this.getDelegate().getEmbraceUserId()}getUserId(){return this.getDelegate().getUserId()}setUserId(t){this.getDelegate().setUserId(t)}clearUserId(){this.getDelegate().clearUserId()}}class he{static getInstance(){return he._instance||(he._instance=new he({proxyUserManager:new de})),he._instance}getUserManager(){return this._proxyUserManager}setGlobalUserManager(t){this._proxyUserManager.setDelegate(t)}getEmbraceUserId(){return this.getUserManager().getEmbraceUserId()}getUserId(){return this.getUserManager().getUserId()}setUserId(t){this.getUserManager().setUserId(t)}clearUserId(){this.getUserManager().clearUserId()}constructor({proxyUserManager:t}){this._proxyUserManager=t}}const pe=he.getInstance();var ge;!function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TRACE=1]="TRACE",t[t.TRACE2=2]="TRACE2",t[t.TRACE3=3]="TRACE3",t[t.TRACE4=4]="TRACE4",t[t.DEBUG=5]="DEBUG",t[t.DEBUG2=6]="DEBUG2",t[t.DEBUG3=7]="DEBUG3",t[t.DEBUG4=8]="DEBUG4",t[t.INFO=9]="INFO",t[t.INFO2=10]="INFO2",t[t.INFO3=11]="INFO3",t[t.INFO4=12]="INFO4",t[t.WARN=13]="WARN",t[t.WARN2=14]="WARN2",t[t.WARN3=15]="WARN3",t[t.WARN4=16]="WARN4",t[t.ERROR=17]="ERROR",t[t.ERROR2=18]="ERROR2",t[t.ERROR3=19]="ERROR3",t[t.ERROR4=20]="ERROR4",t[t.FATAL=21]="FATAL",t[t.FATAL2=22]="FATAL2",t[t.FATAL3=23]="FATAL3",t[t.FATAL4=24]="FATAL4"}(ge||(ge={}));class me{emit(t){}}const fe=new me;const _e=new class{getLogger(t,e,n){return new me}};class ve{emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;const t=this._provider._getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):fe}constructor(t,e,n,r){this._provider=t,this.name=e,this.version=n,this.options=r}}class be{getLogger(t,e,n){var r;return null!==(r=this._getDelegateLogger(t,e,n))&&void 0!==r?r:new ve(this,t,e,n)}_getDelegate(){var t;return null!==(t=this._delegate)&&void 0!==t?t:_e}_setDelegate(t){this._delegate=t}_getDelegateLogger(t,e,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getLogger(t,e,n)}}const Se="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},ye=Symbol.for("io.opentelemetry.js.api.logs"),Ee=Se;class Te{static getInstance(){return this._instance||(this._instance=new Te),this._instance}setGlobalLoggerProvider(t){return Ee[ye]?this.getLoggerProvider():(Ee[ye]=(e=1,n=t,r=_e,t=>t===e?n:r),this._proxyLoggerProvider._setDelegate(t),t);var e,n,r}getLoggerProvider(){var t,e;return null!==(e=null===(t=Ee[ye])||void 0===t?void 0:t.call(Ee,1))&&void 0!==e?e:this._proxyLoggerProvider}getLogger(t,e,n){return this.getLoggerProvider().getLogger(t,e,n)}disable(){delete Ee[ye],this._proxyLoggerProvider=new be}constructor(){this._proxyLoggerProvider=new be}}const we=Te.getInstance(),Ae="http.method",Le="http.url",Ce="http.status_code",Re="error.type",Oe="exception.message",xe="exception.stacktrace",Pe="exception.type",De="http.request.method",Ne="http.request.method_original",Ie="http.response.status_code",Me="server.address",ke="server.port",Ue="service.name",Fe="telemetry.sdk.language",je="webjs",Be="telemetry.sdk.name",Ve="telemetry.sdk.version",$e="url.full",ze="user_agent.original",He="emb.type",qe="emb.state",Ge="emb.cold_start",Ke="emb.session_number",We="emb.sdk_startup_duration",Qe="emb.properties.",Xe="emb.session_end_type",Je="emb.stacktrace.js",Ye="emb.exception_handling",Ze="emb.app_instance_id",tn="emb.tab_id",en="emb.experience_id",nn="emb.from_storage",rn="emb.js_file_bundle_ids",sn="view.name";var on=function(t){return t.Session="ux.session",t.View="ux.view",t.Network="perf.network_request",t.Perf="perf",t.SystemLog="sys.log",t.SystemException="sys.exception",t.WebVital="ux.web_vital",t.ResourceFetch="ux.resource_fetch",t.DocumentLoad="ux.document_load",t}({}),an=function(t){return t.Foreground="foreground",t.Background="background",t}({});const un=[];for(let t=0;t<256;++t)un.push((t+256).toString(16).slice(1));let cn;const ln=new Uint8Array(16);var dn={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function hn(t,e,n){if(dn.randomUUID&&!t)return dn.randomUUID();var r,i;const s=null!=(i=null!=(r=(t=t||{}).random)?r:null==t.rng?void 0:t.rng.call(t))?i:function(){if(!cn){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");cn=crypto.getRandomValues.bind(crypto)}return cn(ln)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=15&s[6]|64,s[8]=63&s[8]|128,function(t,e=0){return(un[t[e+0]]+un[t[e+1]]+un[t[e+2]]+un[t[e+3]]+"-"+un[t[e+4]]+un[t[e+5]]+"-"+un[t[e+6]]+un[t[e+7]]+"-"+un[t[e+8]]+un[t[e+9]]+"-"+un[t[e+10]]+un[t[e+11]]+un[t[e+12]]+un[t[e+13]]+un[t[e+14]]+un[t[e+15]]).toLowerCase()}(s)}const pn=()=>hn().replace(/-/g,"").toUpperCase(),gn=({target:t,events:e,callback:n})=>{e.forEach(e=>{t.addEventListener(e,n)})},mn=({target:t,events:e,callback:n})=>{e.forEach(e=>{t.removeEventListener(e,n)})},fn=(t,e)=>{if(!e||e<=0||e>100)return!1;return e>=_n(t)},_n=t=>{const e=t.slice(-6),n=Math.pow(16,6)-1;return parseInt(e,16)/n*100},vn=N("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function bn(t){return null==t||(Array.isArray(t)?function(t){let e;for(const n of t)if(null!=n){if(!e){if(Sn(n)){e=typeof n;continue}return!1}if(typeof n!==e)return!1}return!0}(t):Sn(t))}function Sn(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}let yn=t=>{Vt.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){const e={};let n=t;for(;null!==n;)Object.getOwnPropertyNames(n).forEach(t=>{if(e[t])return;const r=n[t];r&&(e[t]=String(r))}),n=Object.getPrototypeOf(n);return e}(t))}(t))};function En(t){try{yn(t)}catch(t){}}const Tn="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},wn=performance,An="process.runtime.name",Ln={[Be]:"opentelemetry",[An]:"browser",[Fe]:je,[Ve]:"2.1.0"};const Cn=Math.pow(10,6),Rn=Math.pow(10,9);function On(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*Cn)]}function xn(){let t=wn.timeOrigin;if("number"!=typeof t){const e=wn;t=e.timing&&e.timing.fetchStart}return t}function Pn(t){return function(t,e){const n=[t[0]+e[0],t[1]+e[1]];n[1]>=Rn&&(n[1]-=Rn,n[0]+=1);return n}(On(xn()),On("number"==typeof t?t:wn.now()))}function Dn(t){if(e=t,Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])return t;if("number"==typeof t)return t<xn()?Pn(t):On(t);if(t instanceof Date)return On(t.getTime());throw TypeError("Invalid input type");var e}function Nn(t){return t[0]*Rn+t[1]}var In;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(In||(In={}));const Mn="[_0-9a-z-*/]",kn=new RegExp(`^(?:${`[a-z]${Mn}{0,255}`}|${`[a-z0-9]${Mn}{0,240}@[a-z]${Mn}{0,13}`})$`),Un=/^[ -~]{0,255}[!-~]$/,Fn=/,|=/;let jn=class t{set(t,e){const n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n}unset(t){const e=this._clone();return e._internalState.delete(t),e}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce((t,e)=>(t.push(e+"="+this.get(e)),t),[]).join(",")}_parse(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((t,e)=>{const n=e.trim(),r=n.indexOf("=");if(-1!==r){const i=n.slice(0,r),s=n.slice(r+1,e.length);(function(t){return kn.test(t)})(i)&&function(t){return Un.test(t)&&!Fn.test(t)}(s)&&t.set(i,s)}return t},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const e=new t;return e._internalState=new Map(this._internalState),e}constructor(t){this._internalState=new Map,t&&this._parse(t)}};const Bn="traceparent",Vn="tracestate",$n=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");let zn=class{inject(t,e,n){const r=re.getSpanContext(t);if(!r||function(t){return!0===t.getValue(vn)}(t)||!Ot(r))return;const i=`00-${r.traceId}-${r.spanId}-0${Number(r.traceFlags||M.NONE).toString(16)}`;n.set(e,Bn,i),r.traceState&&n.set(e,Vn,r.traceState.serialize())}extract(t,e,n){const r=n.get(e,Bn);if(!r)return t;const i=Array.isArray(r)?r[0]:r;if("string"!=typeof i)return t;const s=function(t){const e=$n.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(i);if(!s)return t;s.isRemote=!0;const o=n.get(e,Vn);if(o){const t=Array.isArray(o)?o.join(","):o;s.traceState=new jn("string"==typeof t?t:void 0)}return re.setSpanContext(t,s)}fields(){return[Bn,Vn]}};const Hn="[object Null]",qn="[object Undefined]",Gn=Function.prototype.toString,Kn=Gn.call(Object),Wn=Object.getPrototypeOf,Qn=Object.prototype,Xn=Qn.hasOwnProperty,Jn=Symbol?Symbol.toStringTag:void 0,Yn=Qn.toString;function Zn(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||"[object Object]"!==function(t){if(null==t)return void 0===t?qn:Hn;return Jn&&Jn in Object(t)?function(t){const e=Xn.call(t,Jn),n=t[Jn];let r=!1;try{t[Jn]=void 0,r=!0}catch(t){}const i=Yn.call(t);r&&(e?t[Jn]=n:delete t[Jn]);return i}(t):function(t){return Yn.call(t)}(t)}(t))return!1;const e=Wn(t);if(null===e)return!0;const n=Xn.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Gn.call(n)===Kn}function tr(t){return rr(t)?t.slice():t}function er(t,e,n=0,r){let i;if(!(n>20)){if(n++,or(t)||or(e)||ir(e))i=tr(e);else if(rr(t)){if(i=t.slice(),rr(e))for(let t=0,n=e.length;t<n;t++)i.push(tr(e[t]));else if(sr(e)){const t=Object.keys(e);for(let n=0,r=t.length;n<r;n++){const r=t[n];i[r]=tr(e[r])}}}else if(sr(t))if(sr(e)){if(!function(t,e){if(!Zn(t)||!Zn(e))return!1;return!0}(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let o=0,a=s.length;o<a;o++){const a=s[o],u=e[a];if(or(u))void 0===u?delete i[a]:i[a]=u;else{const s=i[a],o=u;if(nr(t,a,r)||nr(e,a,r))delete i[a];else{if(sr(s)&&sr(o)){const n=r.get(s)||[],i=r.get(o)||[];n.push({obj:t,key:a}),i.push({obj:e,key:a}),r.set(s,n),r.set(o,i)}i[a]=er(i[a],u,n,r)}}}}else i=e;return i}}function nr(t,e,n){const r=n.get(t[e])||[];for(let n=0,i=r.length;n<i;n++){const i=r[n];if(i.key===e&&i.obj===t)return!0}return!1}function rr(t){return Array.isArray(t)}function ir(t){return"function"==typeof t}function sr(t){return!or(t)&&!rr(t)&&!ir(t)&&"object"==typeof t}function or(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}class ar extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ar.prototype)}}function ur(t,e){let n;const r=new Promise(function(t,r){n=setTimeout(function(){r(new ar("Operation timed out."))},e)});return Promise.race([t,r]).then(t=>(clearTimeout(n),t),t=>{throw clearTimeout(n),t})}function cr(t,e){return"string"==typeof e?t===e:!!t.match(e)}function lr(t,e){if(!e)return!1;for(const n of e)if(cr(t,n))return!0;return!1}let dr=class{get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}constructor(){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}},hr=class{get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then(t=>this._deferred.resolve(t),t=>this._deferred.reject(t))}catch(t){this._deferred.reject(t)}}return this._deferred.promise}constructor(t,e){this._isCalled=!1,this._deferred=new dr,this._callback=t,this._that=e}};const pr={_export:function(t,e){return new Promise(n=>{Bt.with(function(t){return t.setValue(vn,!0)}(Bt.active()),()=>{t.export(e,t=>{n(t)})})})}};class gr{constructor(t=window.performance){this.epochMillisFromOriginOffset=t=>this._clock.timeOrigin+t,this.getNowHRTime=()=>On(this.getNowMillis()),this.getNowMillis=()=>this.epochMillisFromOriginOffset(this._clock.now()),this.millisSinceHRTime=t=>this.getNowMillis()-function(t){return 1e3*t[0]+t[1]/1e6}(t),this._clock=t}}const mr=(t,e=1e3)=>{let n=!1;return(...r)=>{n||(t(...r),setTimeout(()=>{n=!1},e),n=!0)}},fr=N("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function _r(t){const e={};if("object"!=typeof t||null==t)return e;for(const[n,r]of Object.entries(t))vr(n)?br(r)?Array.isArray(r)?e[n]=r.slice():e[n]=r:Vt.warn(`Invalid attribute value set for key: ${n}`):Vt.warn(`Invalid attribute key: ${n}`);return e}function vr(t){return"string"==typeof t&&t.length>0}function br(t){return null==t||(Array.isArray(t)?function(t){let e;for(const n of t)if(null!=n){if(!e){if(Sr(n)){e=typeof n;continue}return!1}if(typeof n!==e)return!1}return!0}(t):Sr(t))}function Sr(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}let yr=t=>{Vt.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){const e={};let n=t;for(;null!==n;)Object.getOwnPropertyNames(n).forEach(t=>{if(e[t])return;const r=n[t];r&&(e[t]=String(r))}),n=Object.getPrototypeOf(n);return e}(t))}(t))};function Er(t){try{yr(t)}catch(t){}}const Tr=performance,wr="process.runtime.name",Ar={[Be]:"opentelemetry",[wr]:"browser",[Fe]:je,[Ve]:"2.0.1"};const Lr=Math.pow(10,6),Cr=Math.pow(10,9);function Rr(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*Lr)]}function Or(){let t=Tr.timeOrigin;if("number"!=typeof t){const e=Tr;t=e.timing&&e.timing.fetchStart}return t}function xr(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function Pr(t){return xr(t)||"number"==typeof t||t instanceof Date}function Dr(t,e){const n=[t[0]+e[0],t[1]+e[1]];return n[1]>=Cr&&(n[1]-=Cr,n[0]+=1),n}var Nr;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(Nr||(Nr={}));const Ir="[object Null]",Mr="[object Undefined]",kr=Function.prototype.toString,Ur=kr.call(Object),Fr=Object.getPrototypeOf,jr=Object.prototype,Br=jr.hasOwnProperty,Vr=Symbol?Symbol.toStringTag:void 0,$r=jr.toString;function zr(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||"[object Object]"!==function(t){if(null==t)return void 0===t?Mr:Ir;return Vr&&Vr in Object(t)?function(t){const e=Br.call(t,Vr),n=t[Vr];let r=!1;try{t[Vr]=void 0,r=!0}catch(t){}const i=$r.call(t);r&&(e?t[Vr]=n:delete t[Vr]);return i}(t):function(t){return $r.call(t)}(t)}(t))return!1;const e=Fr(t);if(null===e)return!0;const n=Br.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&kr.call(n)===Ur}function Hr(t){return Kr(t)?t.slice():t}function qr(t,e,n=0,r){let i;if(!(n>20)){if(n++,Xr(t)||Xr(e)||Wr(e))i=Hr(e);else if(Kr(t)){if(i=t.slice(),Kr(e))for(let t=0,n=e.length;t<n;t++)i.push(Hr(e[t]));else if(Qr(e)){const t=Object.keys(e);for(let n=0,r=t.length;n<r;n++){const r=t[n];i[r]=Hr(e[r])}}}else if(Qr(t))if(Qr(e)){if(!function(t,e){if(!zr(t)||!zr(e))return!1;return!0}(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let o=0,a=s.length;o<a;o++){const a=s[o],u=e[a];if(Xr(u))void 0===u?delete i[a]:i[a]=u;else{const s=i[a],o=u;if(Gr(t,a,r)||Gr(e,a,r))delete i[a];else{if(Qr(s)&&Qr(o)){const n=r.get(s)||[],i=r.get(o)||[];n.push({obj:t,key:a}),i.push({obj:e,key:a}),r.set(s,n),r.set(o,i)}i[a]=qr(i[a],u,n,r)}}}}else i=e;return i}}function Gr(t,e,n){const r=n.get(t[e])||[];for(let n=0,i=r.length;n<i;n++){const i=r[n];if(i.key===e&&i.obj===t)return!0}return!1}function Kr(t){return Array.isArray(t)}function Wr(t){return"function"==typeof t}function Qr(t){return!Xr(t)&&!Kr(t)&&!Wr(t)&&"object"==typeof t}function Xr(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}class Jr{get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}constructor(){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}}class Yr{get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then(t=>this._deferred.resolve(t),t=>this._deferred.reject(t))}catch(t){this._deferred.reject(t)}}return this._deferred.promise}constructor(t,e){this._isCalled=!1,this._deferred=new Jr,this._callback=t,this._that=e}}const Zr=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;function ti(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}let ei=class t{static FromAttributeList(e){const n=new t({});return n._rawAttributes=ri(e),n._asyncAttributesPending=e.filter(([t,e])=>Zr(e)).length>0,n}get asyncAttributesPending(){return this._asyncAttributesPending}waitForAsyncAttributes(){return(t=function*(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){const[e,n]=this._rawAttributes[t];this._rawAttributes[t]=[e,Zr(n)?yield n:n]}this._asyncAttributesPending=!1}},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){ti(s,r,i,o,a,"next",t)}function a(t){ti(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}get attributes(){if(this.asyncAttributesPending&&Vt.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const t={};for(const[r,i]of this._rawAttributes){var e,n;if(Zr(i))Vt.debug(`Unsettled resource attribute ${r} skipped`);else if(null!=i)null!=(e=t)[n=r]||(e[n]=i)}return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}merge(e){return null==e?this:t.FromAttributeList([...e.getRawAttributes(),...this.getRawAttributes()])}constructor(t){var e;this._asyncAttributesPending=!1;const n=null!=(e=t.attributes)?e:{};this._rawAttributes=Object.entries(n).map(([t,e])=>(Zr(e)&&(this._asyncAttributesPending=!0),[t,e])),this._rawAttributes=ri(this._rawAttributes)}};function ni(){return t={[Ue]:"unknown_service",[Fe]:Ar[Fe],[Be]:Ar[Be],[Ve]:Ar[Ve]},ei.FromAttributeList(Object.entries(t));var t}function ri(t){return t.map(([t,e])=>Zr(e)?[t,e.catch(e=>{Vt.debug("promise rejection for resource attribute: %s - %s",t,e)})]:[t,e])}function ii(){return ii=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ii.apply(this,arguments)}class si{spanContext(){return this._spanContext}setAttribute(t,e){if(null==e||this._isSpanEnded())return this;if(0===t.length)return Vt.warn(`Invalid attribute key: ${t}`),this;if(!br(e))return Vt.warn(`Invalid attribute value set for key: ${t}`),this;const{attributeCountLimit:n}=this._spanLimits;return void 0!==n&&Object.keys(this.attributes).length>=n&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(e),this)}setAttributes(t){for(const[e,n]of Object.entries(t))this.setAttribute(e,n);return this}addEvent(t,e,n){if(this._isSpanEnded())return this;const{eventCountLimit:r}=this._spanLimits;if(0===r)return Vt.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==r&&this.events.length>=r&&(0===this._droppedEventsCount&&Vt.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Pr(e)&&(Pr(n)||(n=e),e=void 0);const i=_r(e);return this.events.push({name:t,attributes:i,time:this._getTime(n),droppedAttributesCount:0}),this}addLink(t){return this.links.push(t),this}addLinks(t){return this.links.push(...t),this}setStatus(t){return this._isSpanEnded()||(this.status=ii({},t),null!=this.status.message&&"string"!=typeof t.message&&(Vt.warn(`Dropping invalid status.message of type '${typeof t.message}', expected 'string'`),delete this.status.message)),this}updateName(t){return this._isSpanEnded()||(this.name=t),this}end(t){this._isSpanEnded()?Vt.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`):(this._ended=!0,this.endTime=this._getTime(t),this._duration=function(t,e){let n=e[0]-t[0],r=e[1]-t[1];return r<0&&(n-=1,r+=Cr),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(Vt.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&Vt.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this))}_getTime(t){if("number"==typeof t&&t<=Tr.now())return e=t+this._performanceOffset,Dr(Rr(Or()),Rr("number"==typeof e?e:Tr.now()));var e;if("number"==typeof t)return Rr(t);if(t instanceof Date)return Rr(t.getTime());if(xr(t))return t;if(this._startTimeProvided)return Rr(Date.now());const n=Tr.now()-this._performanceStartTime;return Dr(this.startTime,Rr(n))}isRecording(){return!1===this._ended}recordException(t,e){const n={};"string"==typeof t?n[Oe]=t:t&&(t.code?n[Pe]=t.code.toString():t.name&&(n[Pe]=t.name),t.message&&(n[Oe]=t.message),t.stack&&(n[xe]=t.stack)),n[Pe]||n[Oe]?this.addEvent("exception",n,e):Vt.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const t=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);Vt.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,t)}return this._ended}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_truncateToSize(t){const e=this._attributeValueLengthLimit;return e<=0?(Vt.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map(t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t):t}constructor(t){this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Mt.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1];const e=Date.now();var n;this._spanContext=t.spanContext,this._performanceStartTime=Tr.now(),this._performanceOffset=e-(this._performanceStartTime+Or()),this._startTimeProvided=null!=t.startTime,this._spanLimits=t.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=t.spanProcessor,this.name=t.name,this.parentSpanContext=t.parentSpanContext,this.kind=t.kind,this.links=t.links||[],this.startTime=this._getTime(null!=(n=t.startTime)?n:e),this.resource=t.resource,this.instrumentationScope=t.scope,null!=t.attributes&&this.setAttributes(t.attributes),this._spanProcessor.onStart(this,t.context)}}var oi;!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(oi||(oi={}));class ai{shouldSample(){return{decision:oi.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class ui{shouldSample(){return{decision:oi.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class ci{shouldSample(t,e,n,r,i,s){const o=re.getSpanContext(t);return o&&Ot(o)?o.isRemote?o.traceFlags&M.SAMPLED?this._remoteParentSampled.shouldSample(t,e,n,r,i,s):this._remoteParentNotSampled.shouldSample(t,e,n,r,i,s):o.traceFlags&M.SAMPLED?this._localParentSampled.shouldSample(t,e,n,r,i,s):this._localParentNotSampled.shouldSample(t,e,n,r,i,s):this._root.shouldSample(t,e,n,r,i,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}constructor(t){var e,n,r,i;this._root=t.root,this._root||(Er(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new ui),this._remoteParentSampled=null!=(e=t.remoteParentSampled)?e:new ui,this._remoteParentNotSampled=null!=(n=t.remoteParentNotSampled)?n:new ai,this._localParentSampled=null!=(r=t.localParentSampled)?r:new ui,this._localParentNotSampled=null!=(i=t.localParentNotSampled)?i:new ai}}class li{shouldSample(t,e){return{decision:Rt(e)&&this._accumulate(e)<this._upperBound?oi.RECORD_AND_SAMPLED:oi.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let e=0;for(let n=0;n<t.length/8;n++){const r=8*n;e=(e^parseInt(t.slice(r,r+8),16))>>>0}return e}constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(4294967295*this._ratio)}}function di(){return{sampler:hi(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:null!=void 0?undefined:1/0,attributeCountLimit:null!=void 0?undefined:128},spanLimits:{attributeValueLengthLimit:null!=void 0?undefined:1/0,attributeCountLimit:null!=void 0?undefined:128,linkCountLimit:null!=void 0?undefined:128,eventCountLimit:null!=void 0?undefined:128,attributePerEventCountLimit:null!=void 0?undefined:128,attributePerLinkCountLimit:null!=void 0?undefined:128}}}function hi(){const t=null!=void 0?undefined:"parentbased_always_on";switch(t){case"always_on":return new ui;case"always_off":return new ai;case"parentbased_always_on":return new ci({root:new ui});case"parentbased_always_off":return new ci({root:new ai});case"traceidratio":return new li(pi());case"parentbased_traceidratio":return new ci({root:new li(pi())});default:return Vt.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "parentbased_always_on".`),new ci({root:new ui})}}function pi(){return Vt.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1}const gi=1/0;class mi{forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(t,e){}onEnd(t){this._shutdownOnce.isCalled||0!==(t.spanContext().traceFlags&M.SAMPLED)&&this._addToBuffer(t)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(t){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&Vt.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(Vt.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()}_flushAll(){return new Promise((t,e)=>{const n=[];for(let t=0,e=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);t<e;t++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{t()}).catch(e)})}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((t,e)=>{const n=setTimeout(()=>{e(new Error("Timeout"))},this._exportTimeoutMillis);Bt.with(function(t){return t.setValue(fr,!0)}(Bt.active()),()=>{let r;this._finishedSpans.length<=this._maxExportBatchSize?(r=this._finishedSpans,this._finishedSpans=[]):r=this._finishedSpans.splice(0,this._maxExportBatchSize);const i=()=>this._exporter.export(r,r=>{var i;(clearTimeout(n),r.code===Nr.SUCCESS)?t():e(null!=(i=r.error)?i:new Error("BatchSpanProcessor: span export failed"))});let s=null;for(let t=0,e=r.length;t<e;t++){const e=r[t];e.resource.asyncAttributesPending&&e.resource.waitForAsyncAttributes&&(null!=s||(s=[]),s.push(e.resource.waitForAsyncAttributes()))}null===s?i():Promise.all(s).then(i,t=>{Er(t),e(t)})})})}_maybeStartTimer(){if(this._isExporting)return;const t=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{this._isExporting=!1,Er(t)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout(()=>t(),this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}constructor(t,e){this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0,this._exporter=t,this._maxExportBatchSize="number"==typeof(null==e?void 0:e.maxExportBatchSize)?e.maxExportBatchSize:null!=void 0?undefined:512,this._maxQueueSize="number"==typeof(null==e?void 0:e.maxQueueSize)?e.maxQueueSize:null!=void 0?undefined:2048,this._scheduledDelayMillis="number"==typeof(null==e?void 0:e.scheduledDelayMillis)?e.scheduledDelayMillis:null!=void 0?undefined:5e3,this._exportTimeoutMillis="number"==typeof(null==e?void 0:e.exportTimeoutMillis)?e.exportTimeoutMillis:null!=void 0?undefined:3e4,this._shutdownOnce=new Yr(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Vt.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}}class fi extends mi{onInit(t){!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush().catch(t=>{Er(t)})},this._pageHideListener=()=>{this.forceFlush().catch(t=>{Er(t)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}constructor(t,e){super(t,e),this.onInit(e)}}class _i{constructor(){this.generateTraceId=bi(16),this.generateSpanId=bi(8)}}const vi=Array(32);function bi(t){return function(){for(let e=0;e<2*t;e++)vi[e]=Math.floor(16*Math.random())+48,vi[e]>=58&&(vi[e]+=39);return String.fromCharCode.apply(null,vi.slice(0,2*t))}}class Si{startSpan(t,e={},n=Bt.active()){e.root&&(n=re.deleteSpan(n));const r=re.getSpan(n);if(function(t){return!0===t.getValue(fr)}(n)){Vt.debug("Instrumentation suppressed, returning Noop Span");return re.wrapSpanContext(_t)}const i=null==r?void 0:r.spanContext(),s=this._idGenerator.generateSpanId();let o,a,u;var c;i&&re.isSpanContextValid(i)?(a=i.traceId,u=i.traceState,o=i):a=this._idGenerator.generateTraceId();const l=null!=(c=e.kind)?c:It.INTERNAL;var d;const h=(null!=(d=e.links)?d:[]).map(t=>({context:t.context,attributes:_r(t.attributes)})),p=_r(e.attributes),g=this._sampler.shouldSample(n,a,t,l,p,h);var m;u=null!=(m=g.traceState)?m:u;const f={traceId:a,spanId:s,traceFlags:g.decision===Nt.RECORD_AND_SAMPLED?M.SAMPLED:M.NONE,traceState:u};if(g.decision===Nt.NOT_RECORD){Vt.debug("Recording is off, propagating context in a non-recording span");return re.wrapSpanContext(f)}const _=_r(Object.assign(p,g.attributes));return new si({resource:this._resource,scope:this.instrumentationScope,context:n,spanContext:f,name:t,kind:l,links:h,parentSpanContext:o,attributes:_,startTime:e.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(t,e,n,r){let i,s,o;if(arguments.length<2)return;2===arguments.length?o=e:3===arguments.length?(i=e,o=n):(i=e,s=n,o=r);const a=null!=s?s:Bt.active(),u=this.startSpan(t,i,a),c=re.setSpan(a,u);return Bt.with(c,o,void 0,u)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}constructor(t,e,n,r){const i=function(t){const e={sampler:hi()},n=di(),r=Object.assign({},n,e,t);return r.generalLimits=Object.assign({},n.generalLimits,t.generalLimits||{}),r.spanLimits=Object.assign({},n.spanLimits,t.spanLimits||{}),r}(e);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=e.idGenerator||new _i,this._resource=n,this._spanProcessor=r,this.instrumentationScope=t}}class yi{forceFlush(){const t=[];for(const e of this._spanProcessors)t.push(e.forceFlush());return new Promise(e=>{Promise.all(t).then(()=>{e()}).catch(t=>{Er(t||new Error("MultiSpanProcessor: forceFlush failed")),e()})})}onStart(t,e){for(const n of this._spanProcessors)n.onStart(t,e)}onEnd(t){for(const e of this._spanProcessors)e.onEnd(t)}shutdown(){const t=[];for(const e of this._spanProcessors)t.push(e.shutdown());return new Promise((e,n)=>{Promise.all(t).then(()=>{e()},n)})}constructor(t){this._spanProcessors=t}}var Ei;!function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"}(Ei||(Ei={}));class Ti{getTracer(t,e,n){const r=`${t}@${e||""}:${(null==n?void 0:n.schemaUrl)||""}`;return this._tracers.has(r)||this._tracers.set(r,new Si({name:t,version:e,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(r)}forceFlush(){const t=this._config.forceFlushTimeoutMillis,e=this._activeSpanProcessor._spanProcessors.map(e=>new Promise(n=>{let r;const i=setTimeout(()=>{n(new Error(`Span processor did not completed within timeout period of ${t} ms`)),r=Ei.timeout},t);e.forceFlush().then(()=>{clearTimeout(i),r!==Ei.timeout&&(r=Ei.resolved,n(r))}).catch(t=>{clearTimeout(i),r=Ei.error,n(t)})}));return new Promise((t,n)=>{Promise.all(e).then(e=>{const r=e.filter(t=>t!==Ei.resolved);r.length>0?n(r):t()}).catch(t=>n([t]))})}shutdown(){return this._activeSpanProcessor.shutdown()}constructor(t={}){var e;this._tracers=new Map;const n=function(...t){let e=t.shift();const n=new WeakMap;for(;t.length>0;)e=qr(e,t.shift(),0,n);return e}({},di(),function(t){var e,n,r,i;const s=Object.assign({},t.spanLimits);var o,a,u,c,l,d,h,p;return s.attributeCountLimit=null!=(c=null!=(u=null!=(a=null!=(o=null==(e=t.spanLimits)?void 0:e.attributeCountLimit)?o:null==(n=t.generalLimits)?void 0:n.attributeCountLimit)?a:void 0)?u:void 0)?c:128,s.attributeValueLengthLimit=null!=(p=null!=(h=null!=(d=null!=(l=null==(r=t.spanLimits)?void 0:r.attributeValueLengthLimit)?l:null==(i=t.generalLimits)?void 0:i.attributeValueLengthLimit)?d:void 0)?h:void 0)?p:gi,Object.assign({},t,{spanLimits:s})}(t));var r;this._resource=null!=(r=n.resource)?r:ni(),this._config=Object.assign({},n,{resource:this._resource});const i=[];(null==(e=t.spanProcessors)?void 0:e.length)&&i.push(...t.spanProcessors),this._activeSpanProcessor=new yi(i)}}class wi{_bindFunction(t=U,e){const n=this,r=function(...r){return n.with(t,()=>e.apply(this,r))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),r}active(){return this._currentContext}bind(t,e){return void 0===t&&(t=this.active()),"function"==typeof e?this._bindFunction(t,e):e}disable(){return this._currentContext=U,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=U),this}with(t,e,n,...r){const i=this._currentContext;this._currentContext=t||U;try{return e.call(n,...r)}finally{this._currentContext=i}}constructor(){this._enabled=!1,this._currentContext=U}}const Ai=N("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Li(t){return!0===t.getValue(Ai)}const Ci="baggage";function Ri(t){const e=t.split(";");if(e.length<=0)return;const n=e.shift();if(!n)return;const r=n.indexOf("=");if(r<=0)return;const i=decodeURIComponent(n.substring(0,r).trim()),s=decodeURIComponent(n.substring(r+1).trim());let o;var a;return e.length>0&&("string"!=typeof(a=e.join(";"))&&(P.error("Cannot create baggage metadata from unknown type: "+typeof a),a=""),o={__TYPE__:x,toString:function(){return a}}),{key:i,value:s,metadata:o}}class Oi{inject(t,e,n){const r=te.getBaggage(t);if(!r||Li(t))return;const i=function(t){return t.getAllEntries().map(([t,e])=>{let n=`${encodeURIComponent(t)}=${encodeURIComponent(e.value)}`;return void 0!==e.metadata&&(n+=";"+e.metadata.toString()),n})}(r).filter(t=>t.length<=4096).slice(0,180),s=function(t){return t.reduce((t,e)=>{const n=`${t}${""!==t?",":""}${e}`;return n.length>8192?t:n},"")}(i);s.length>0&&n.set(e,Ci,s)}extract(t,e,n){const r=n.get(e,Ci),i=Array.isArray(r)?r.join(","):r;if(!i)return t;const s={};if(0===i.length)return t;return i.split(",").forEach(t=>{const e=Ri(t);if(e){const t={value:e.value};e.metadata&&(t.metadata=e.metadata),s[e.key]=t}}),0===Object.entries(s).length?t:te.setBaggage(t,te.createBaggage(s))}fields(){return[Ci]}}class xi{inject(t,e,n){for(const r of this._propagators)try{r.inject(t,e,n)}catch(t){Vt.warn(`Failed to inject with ${r.constructor.name}. Err: ${t.message}`)}}extract(t,e,n){return this._propagators.reduce((t,r)=>{try{return r.extract(t,e,n)}catch(t){Vt.warn(`Failed to extract with ${r.constructor.name}. Err: ${t.message}`)}return t},t)}fields(){return this._fields.slice()}constructor(t={}){var e;this._propagators=null!=(e=t.propagators)?e:[],this._fields=Array.from(new Set(this._propagators.map(t=>"function"==typeof t.fields?t.fields():[]).reduce((t,e)=>t.concat(e),[])))}}const Pi="[_0-9a-z-*/]",Di=new RegExp(`^(?:${`[a-z]${Pi}{0,255}`}|${`[a-z0-9]${Pi}{0,240}@[a-z]${Pi}{0,13}`})$`),Ni=/^[ -~]{0,255}[!-~]$/,Ii=/,|=/;class Mi{set(t,e){const n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n}unset(t){const e=this._clone();return e._internalState.delete(t),e}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce((t,e)=>(t.push(e+"="+this.get(e)),t),[]).join(",")}_parse(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((t,e)=>{const n=e.trim(),r=n.indexOf("=");if(-1!==r){const i=n.slice(0,r),s=n.slice(r+1,e.length);(function(t){return Di.test(t)})(i)&&function(t){return Ni.test(t)&&!Ii.test(t)}(s)&&t.set(i,s)}return t},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const t=new Mi;return t._internalState=new Map(this._internalState),t}constructor(t){this._internalState=new Map,t&&this._parse(t)}}const ki="traceparent",Ui="tracestate",Fi=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class ji{inject(t,e,n){const r=re.getSpanContext(t);if(!r||Li(t)||!Ot(r))return;const i=`00-${r.traceId}-${r.spanId}-0${Number(r.traceFlags||M.NONE).toString(16)}`;n.set(e,ki,i),r.traceState&&n.set(e,Ui,r.traceState.serialize())}extract(t,e,n){const r=n.get(e,ki);if(!r)return t;const i=Array.isArray(r)?r[0]:r;if("string"!=typeof i)return t;const s=function(t){const e=Fi.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(i);if(!s)return t;s.isRemote=!0;const o=n.get(e,Ui);if(o){const t=Array.isArray(o)?o.join(","):o;s.traceState=new Mi("string"==typeof t?t:void 0)}return re.setSpanContext(t,s)}fields(){return[ki,Ui]}}class Bi extends Ti{register(t={}){var e;re.setGlobalTracerProvider(this),null!==(e=t.propagator)&&(void 0!==e?te.setGlobalPropagator(e):te.setGlobalPropagator(new xi({propagators:[new ji,new Oi]}))),function(t){if(null!==t){if(void 0===t){const t=new wi;return t.enable(),void Bt.setGlobalContextManager(t)}t.enable(),Bt.setGlobalContextManager(t)}}(t.contextManager)}constructor(t={}){super(t)}}var Vi;!function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(Vi||(Vi={}));function $i(t,e){return e in t}function zi(t,e,n,r=!0){if($i(n,e)&&"number"==typeof n[e]&&(!r||0!==n[e]))return t.addEvent(e,n[e])}function Hi(t,e,n=!1,r,i){void 0===r&&(r=0!==e[Vi.START_TIME]),n||(zi(t,Vi.FETCH_START,e,r),zi(t,Vi.DOMAIN_LOOKUP_START,e,r),zi(t,Vi.DOMAIN_LOOKUP_END,e,r),zi(t,Vi.CONNECT_START,e,r),zi(t,Vi.SECURE_CONNECTION_START,e,r),zi(t,Vi.CONNECT_END,e,r),zi(t,Vi.REQUEST_START,e,r),zi(t,Vi.RESPONSE_START,e,r),zi(t,Vi.RESPONSE_END,e,r));{const n=e[Vi.ENCODED_BODY_SIZE];void 0!==n&&t.setAttribute("http.response_content_length",n);const r=e[Vi.DECODED_BODY_SIZE];void 0!==r&&n!==r&&t.setAttribute("http.response_content_length_uncompressed",r)}}const qi="embrace_pending_";class Gi{storePendingSpans(t,e,n){try{if(this.clearStoredSpans(t),this._getPendingSpansKeys().length>=10)return void this._diag.warn("Not storing pending spans as the max number of items was reached");const r=`${qi}${t}_${Date.now()}`;this._storage.setItem(r,JSON.stringify([e,...n],(t,e)=>t.startsWith("_")?void 0:e))}catch(t){this._diag.error("Failed to store spans to storage:",t)}}clearStoredSpans(t){try{const e=`${qi}${t}_`;this._getPendingSpansKeys().forEach(t=>{t.startsWith(e)&&this._storage.removeItem(t)})}catch(t){this._diag.error("Failed to clear stored spans from storage:",t)}}startExpiredSpansCheck(){this._checkExpiredSpansInterval=setInterval(()=>{this.checkAndExportExpiredSpans()},3e5)}stopExpiredSpansCheck(){this._checkExpiredSpansInterval&&(clearInterval(this._checkExpiredSpansInterval),this._checkExpiredSpansInterval=void 0)}checkAndExportExpiredSpans(){try{const t=this._getPendingSpansKeys();if(0===t.length)return;const e=Date.now();t.forEach(t=>{const n=t.split("_"),r=parseInt(n[n.length-1],10);if(isNaN(r)&&(this._diag.error("Found invalid timestamp in stored span:",r),this._storage.removeItem(t)),e-r<=this._storedSpansExpireTimeoutMS)return;const i=this._storage.getItem(t);if(i){try{const t=[];for(const e of JSON.parse(i)){const n=this._noExportTracer.startSpan(e.name,{kind:e.kind,attributes:e.attributes,links:e.links,startTime:e.startTime});n.setStatus(e.status),n.end(e.endTime),t.push(n)}this._onExpiredSpansExport&&t.length>0&&this._onExpiredSpansExport(t)}catch(t){this._diag.error("Failed to process expired spans:",t)}this._storage.removeItem(t)}})}catch(t){this._diag.error("Failed to check and export expired spans:",t)}}_getPendingSpansKeys(){const t=[];for(let e=0;e<this._storage.length;e++){const n=this._storage.key(e);n&&n.startsWith(qi)&&t.push(n)}return t}destroy(){this.stopExpiredSpansCheck()}constructor({storage:t=window.localStorage,diag:e=Vt.createComponentLogger({namespace:"EmbraceSpanStorage"}),storedSpansExpireTimeoutMS:n=36e5,onExpiredSpansExport:r}={}){this._noExportTracer=(new Ti).getTracer("embrace-web-sdk-sessions"),this._storage=t,this._diag=e,this._storedSpansExpireTimeoutMS=n,this._onExpiredSpansExport=r,this.startExpiredSpansCheck()}}const Ki=globalThis;function Wi(){return Wi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wi.apply(this,arguments)}const Qi=()=>JSON.stringify(Ki._EmbraceFileBundleIDs||{});class Xi{static _logSeverityToSeverityNumber(t){switch(t){case"info":return ge.INFO;case"warning":return ge.WARN;default:return ge.ERROR}}logException(t,{handled:e=!0,attributes:n={},timestamp:r=this._perf.getNowMillis()}={}){t||(t=new Error("logException received an undefined error")),null!=n&&"object"==typeof n||(this._diag.warn("attributes must be a non-null object",n),n={}),e||this._spanSessionManager.incrSessionCountForKey("emb.unhandled_exceptions_count");const i=Xi._normalizeErrorData(t),s=this._limitManager.limitException(i.message,n);"dropped"!==s&&this._logger.emit({timestamp:r,severityNumber:ge.ERROR,severityText:"ERROR",body:s.message,attributes:Wi({},s.attributes,{[He]:on.SystemException,[Ye]:e?"HANDLED":"UNHANDLED",[Pe]:i.type,"exception.name":i.name,[Oe]:s.message,[xe]:i.stack,[rn]:Qi()})})}message(t,e,{attributes:n={},includeStacktrace:r=!0,stacktrace:i}={}){if(!t||"string"!=typeof t)return void this._diag.warn("Message must be a string");"error"===e&&this._spanSessionManager.incrSessionCountForKey("emb.error_log_count");let s="";"info"!==e&&(i?s=i:r&&(s=(new Error).stack||"")),this._logMessage({message:t.trim(),severity:e,timestamp:this._perf.getNowMillis(),attributes:n,stacktrace:s})}_logMessage({message:t,severity:e,timestamp:n,attributes:r={},stacktrace:i}){const s=this._limitManager.limitLog(t,e,r);"dropped"!==s&&this._logger.emit({timestamp:n,severityNumber:Xi._logSeverityToSeverityNumber(e),severityText:e.toUpperCase(),body:s.message,attributes:Wi({},s.attributes,{[He]:on.SystemLog},i?{[Je]:i,[rn]:Qi()}:{})})}static _normalizeErrorData(t){if(t instanceof Error)return{message:"string"==typeof t.message?t.message.trim():"",type:t.constructor.name,name:t.name,stack:t.stack||""};const e=(new Error).stack||"";if("string"==typeof t)return{message:t.trim(),type:"String",name:"String",stack:e};if(t&&"object"==typeof t){let n="";try{n=JSON.stringify(t)}catch(t){n="[unable to serialize error]"}return{message:n,type:t.constructor.name,name:t.constructor.name,stack:e}}return{message:String(t).trim(),type:typeof t,name:typeof t,stack:e}}constructor({diag:t,perf:e,spanSessionManager:n,limitManager:r,loggerProvider:i}){const s=null!=i?i:we;this._diag=null!=t?t:Vt.createComponentLogger({namespace:"EmbraceLogManager"}),this._perf=null!=e?e:new gr,this._logger=s.getLogger("embrace-web-sdk-logs"),this._spanSessionManager=n,this._limitManager=r}}const Ji="http.response.body.size",Yi="log.record.uid",Zi="session.id",ts="user.id",es="embrace_session_number",ns="embrace_tab",rs="embrace_tab_activity",is="2.2.0",ss="embrace-web-sdk",os="embrace_app_instance_id",as=(t,e)=>{let n=null;try{n=t.getItem(os)}catch(t){e.warn("Failed to retrieve app instance ID from session storage",t)}if(!n){e.debug("No existing app instance ID found in session storage, creating a new one"),n=pn();try{t.setItem(os,n)}catch(t){e.warn("Failed to persist app instance ID to session storage",t)}}return n};const us=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;function cs(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class ls{static FromAttributeList(t,e){const n=new ls({},e);return n._rawAttributes=ps(t),n._asyncAttributesPending=t.filter(([t,e])=>us(e)).length>0,n}get asyncAttributesPending(){return this._asyncAttributesPending}waitForAsyncAttributes(){return(t=function*(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){const[e,n]=this._rawAttributes[t];this._rawAttributes[t]=[e,us(n)?yield n:n]}this._asyncAttributesPending=!1}},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){cs(s,r,i,o,a,"next",t)}function a(t){cs(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}get attributes(){if(this.asyncAttributesPending&&Vt.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const t={};for(const[r,i]of this._rawAttributes){var e,n;if(us(i))Vt.debug(`Unsettled resource attribute ${r} skipped`);else if(null!=i)null!=(e=t)[n=r]||(e[n]=i)}return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}get schemaUrl(){return this._schemaUrl}merge(t){if(null==t)return this;const e=function(t,e){const n=null==t?void 0:t.schemaUrl,r=null==e?void 0:e.schemaUrl,i=void 0===n||""===n,s=void 0===r||""===r;if(i)return r;if(s)return n;if(n===r)return n;return void Vt.warn('Schema URL merge conflict: old resource has "%s", updating resource has "%s". Resulting resource will have undefined Schema URL.',n,r)}(this,t),n=e?{schemaUrl:e}:void 0;return ls.FromAttributeList([...t.getRawAttributes(),...this.getRawAttributes()],n)}constructor(t,e){var n;this._asyncAttributesPending=!1;const r=null!=(n=t.attributes)?n:{};this._rawAttributes=Object.entries(r).map(([t,e])=>(us(e)&&(this._asyncAttributesPending=!0),[t,e])),this._rawAttributes=ps(this._rawAttributes),this._schemaUrl=function(t){if("string"==typeof t||void 0===t)return t;return void Vt.warn("Schema URL must be string or undefined, got %s. Schema URL will be ignored.",t)}(null==e?void 0:e.schemaUrl)}}function ds(t,e){return ls.FromAttributeList(Object.entries(t),e)}function hs(){return ds({})}function ps(t){return t.map(([t,e])=>us(e)?[t,e.catch(e=>{Vt.debug("promise rejection for resource attribute: %s - %s",t,e)})]:[t,e])}function gs(){return gs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gs.apply(this,arguments)}class ms{_getPermanentAttributes(){const t=new Map;try{for(let e=0;e<this._storage.length;e++){const n=this._storage.key(e);if(null==n?void 0:n.startsWith(Qe)){const e=this._storage.getItem(n);e&&t.set(n,e)}}}catch(t){this._diag.warn("Error loading permanent session properties",t)}return Object.fromEntries(t.entries())}_getSessionNumber(){try{const t=this._storage.getItem(es);let e=t?parseInt(t,10):0;return e++,this._storage.setItem(es,e.toString()),e}catch(t){return this._diag.warn("Failed to retrieve session number from storage",t),1}}addBreadcrumb(t){if(!this._sessionSpan)return void this._diag.debug("trying to add breadcrumb to a session, but there is no session in progress. This is a no-op.");const e=this._limitManager.limitBreadcrumb(t);"dropped"!==e&&this._sessionSpan.addEvent("emb-breadcrumb",{message:e.name},this._perf.getNowMillis())}addProperty(t,e,n){if(!this._sessionSpan)return void this._diag.debug("trying to add properties to a session, but there is no session in progress. This is a no-op.");const r=this._limitManager.limitSessionProperty(t,e);if("dropped"===r)return;const i=Qe+r.key;if(this._sessionSpan.setAttribute(i,r.value),"permanent"===(null==n?void 0:n.lifespan))try{this._storage.setItem(i,e)}catch(t){this._diag.warn("Failed to set permanent session property",t)}}removeProperty(t){if(!this._sessionSpan)return void this._diag.debug("trying to remove a session property, but there is no session in progress. This is a no-op.");const e=Qe+this._limitManager.truncateString("session_property_key",t);this._sessionSpan.removeAttribute(e);try{this._storage.getItem(e)&&this._storage.removeItem(e)}catch(t){this._diag.warn("Error removing permanent session property",t)}}endSessionSpan(){this.endSessionSpanInternal("manual")}endSessionSpanInternal(t){if(this._sessionSpan){this._sessionSpan.setAttributes(this._endSessionSpanAttributes(t)),this._sessionSpan.end(),this._sessionSpan=null,this._activeSessionStartTime=null,this._activeSessionId=null,this._activeSessionCounts=null;for(const t of this._sessionEndedListeners)try{t()}catch(t){this._diag.warn("Error while executing session ended listener",t)}this._limitManager.reset()}else this._diag.debug("trying to end a session, but there is no session in progress. This is a no-op.")}_endSessionSpanAttributes(t){return gs({},this._getPermanentAttributes(),{[Xe]:t},this._activeSessionCounts,this._limitManager.getDiagnosticCounts(),{[We]:this._sdkStartupDuration})}currentSessionAsReadableSpan(t){if(!this._sessionSpan||!this._activeSessionStartTime)return this._diag.debug("trying to end a session, but there is no session in progress. This is a no-op."),null;const e=this._noExportTracer.startSpan("emb-session",{startTime:this._activeSessionStartTime,attributes:gs({},this._sessionSpan.attributes,this._endSessionSpanAttributes(t),{[nn]:!0})});return e.end(),e}getSessionId(){return this._activeSessionId}getSessionSpan(){return this._sessionSpan}getSessionStartTime(){return this._activeSessionStartTime}startSessionSpan(t){this._sessionSpan&&this.endSessionSpanInternal("manual"),this._activeSessionId=pn(),this._activeSessionStartTime=this._perf.getNowHRTime(),this._activeSessionCounts={};const e=gs({},this._getPermanentAttributes(),{[He]:on.Session,[qe]:"hidden"===this._visibilityDoc.visibilityState?an.Background:an.Foreground,[Zi]:this._activeSessionId,[Ge]:this._coldStart,[Ke]:this._getSessionNumber(),[en]:this._currentTab.experienceId,[tn]:this._currentTab.tabId});this._currentTab.parentTabId&&(e["emb.parent_tab_id"]=this._currentTab.parentTabId),(null==t?void 0:t.reason)&&(e["emb.session_start_type"]=t.reason),this._sessionSpan=new ys(this._tracer.startSpan("emb-session",{attributes:e})),this._coldStart=!1;for(const t of this._sessionStartedListeners)try{t()}catch(t){this._diag.warn("Error while executing session started listener",t)}}incrSessionCountForKey(t){this._sessionSpan&&this._activeSessionCounts?this._activeSessionCounts[t]=(this._activeSessionCounts[t]||0)+1:this._diag.debug("trying to increment a count for the active session, but there is no session in progress. This is a no-op.")}addSessionStartedListener(t){const e=this._sessionStartedListeners.push(t);return()=>{this._sessionStartedListeners.splice(e-1,1)}}addSessionEndedListener(t){const e=this._sessionEndedListeners.push(t);return()=>{this._sessionEndedListeners.splice(e-1,1)}}recordSDKStartupDuration(t){this._sdkStartupDuration=Math.ceil(t)}setTracerProvider(t){this._tracer=t.getTracer("embrace-web-sdk-sessions")}_initTab(){try{const t=this._sessionStorage.getItem(ns);if(t)return JSON.parse(t)}catch(t){this._diag.warn("Failed to retrieve current tab data",t)}const t=this._findParentFromLastActivity();var e;const n={experienceId:null!=(e=null==t?void 0:t.experienceId)?e:pn(),parentTabId:null==t?void 0:t.tabId,tabId:as(this._sessionStorage,this._diag)};try{this._sessionStorage.setItem(ns,JSON.stringify(n))}catch(t){this._diag.warn("Failed to store current tab data",t)}return n}_findParentFromLastActivity(){if(!this._referrer)return null;try{if(new URL(this._referrer).origin!==window.location.origin)return null}catch(t){return null}const t=this._getLastTabActivity();if(!t)return null;return Date.now()-t.lastActivityMs<=2e4?t:null}_getLastTabActivity(){try{const t=this._storage.getItem(rs);return t?JSON.parse(t):null}catch(t){return this._diag.warn("Failed to retrieve last tab activity",t),null}}_saveLastTabActivity(t){try{this._storage.setItem(rs,JSON.stringify(t))}catch(t){this._diag.warn("Failed to save last tab activity",t)}}_recordActivity(){const t={tabId:this._currentTab.tabId,experienceId:this._currentTab.experienceId,lastActivityMs:Date.now()};this._saveLastTabActivity(t)}_setupListeners(){const t=t=>{var e;if(1===t.button||t.ctrlKey||t.metaKey||t.shiftKey)return void this._recordActivity();(null==(e=t.target)?void 0:e.closest('a[target="_blank"], form[target="_blank"], a[rel*="noopener"], a[rel*="noreferrer"]'))&&this._recordActivity()},e={capture:!0,passive:!0};document.addEventListener("auxclick",t,e),document.addEventListener("click",t,e)}constructor({diag:t,perf:e,visibilityDoc:n=window.document,storage:r=window.localStorage,sessionStorage:i=window.sessionStorage,limitManager:s,referrer:o=document.referrer}){this._activeSessionId=null,this._activeSessionStartTime=null,this._sessionSpan=null,this._activeSessionCounts=null,this._coldStart=!0,this._sdkStartupDuration=0,this._sessionStartedListeners=[],this._sessionEndedListeners=[],this._diag=null!=t?t:Vt.createComponentLogger({namespace:"EmbraceSpanSessionManager"}),this._perf=null!=e?e:new gr,this._visibilityDoc=n,this._storage=r,this._sessionStorage=i,this._limitManager=s,this._referrer=o,this._tracer=re.getTracer("embrace-web-sdk-sessions"),this._noExportTracer=(new Ti).getTracer("embrace-web-sdk-sessions"),this._currentTab=this._initTab(),this._setupListeners()}}const fs={info:"info_log",warning:"warning_log",error:"error_log"};class _s{_dropIfMaxReached(t){return this._currentCount[t]>=this._maxAllowed[t]?(this._diag.warn(`disallowing ${t} because the maximum number of ${this._maxAllowed[t].toString()} has already been reached for this session`),this._incrDiagnosticCount(t,"drop"),!0):(this._currentCount[t]=(this._currentCount[t]||0)+1,!1)}truncateString(t,e){return e.length>this._maxLength[t]?(this._diag.warn(`truncating ${t} because it is longer than ${this._maxLength[t].toString()} characters: "${e}"`),this._incrDiagnosticCount(t,"truncate_string"),e.substring(0,this._maxLength[t])):e}_truncateAttributes(t,e,n,r){const i=Object.keys(e);i.length>this._maxAttributes[t]&&(this._diag.warn(`truncating ${t} attributes because there are more than ${this._maxAttributes[t].toString()} set`),this._incrDiagnosticCount(t,"truncate_attributes"));const s={};for(let a=0;a<Math.min(i.length,this._maxAttributes[t]);a++){var o;s[this.truncateString(n,i[a])]=this.truncateString(r,(null==(o=e[i[a]])?void 0:o.toString())||"")}return s}limitBreadcrumb(t){return this._dropIfMaxReached("breadcrumb")?"dropped":{name:this.truncateString("breadcrumb",t)}}limitException(t,e){return this._dropIfMaxReached("exception")?"dropped":{message:this.truncateString("exception",t),attributes:this._truncateAttributes("exception",e,"exception_attribute_key","exception_attribute_value")}}limitLog(t,e,n){const r=fs[e];return this._dropIfMaxReached(r)?"dropped":{message:this.truncateString(r,t),attributes:this._truncateAttributes(r,n,"log_attribute_key","log_attribute_value")}}limitSessionProperty(t,e){return this._dropIfMaxReached("session_property")?"dropped":{key:this.truncateString("session_property_key",t),value:this.truncateString("session_property_value",e)}}dropReadableSpan(t){const e=t.attributes[He]===on.Network?"network_request":"span";return this._dropIfMaxReached(e)}reset(){this._diagnosticCounts={},this._currentCount={exception:0,error_log:0,warning_log:0,info_log:0,breadcrumb:0,session_property:0,span:0,network_request:0}}_incrDiagnosticCount(t,e){const n=`emb.app.applied_limit.${t}.${e}.count`;this._diagnosticCounts[n]=(this._diagnosticCounts[n]||0)+1}getDiagnosticCounts(){return this._diagnosticCounts}constructor({diag:t,maxAllowed:e,maxLength:n,maxAttributes:r}){this._diagnosticCounts={},this._currentCount={exception:0,error_log:0,warning_log:0,info_log:0,breadcrumb:0,session_property:0,span:0,network_request:0},this._diag=null!=t?t:Vt.createComponentLogger({namespace:"EmbraceLimitManager"}),this._maxAllowed=e,this._maxLength=n,this._maxAttributes=r}}const vs={maxAllowed:{error_log:500,warning_log:200,info_log:100,exception:500,breadcrumb:100,session_property:100,span:1e3,network_request:1e4},maxLength:{error_log:128,warning_log:128,info_log:128,exception:1024,breadcrumb:256,session_property_key:128,session_property_value:256,log_attribute_key:128,log_attribute_value:256,exception_attribute_key:128,exception_attribute_value:256},maxAttributes:{error_log:50,warning_log:50,info_log:50,exception:50}};function bs(t){var e=function(t,e){if("object"!==Ss(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e);if("object"!==Ss(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Ss(e)?e:String(e)}function Ss(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}class ys{get attributes(){return this._span.attributes}addEvent(t,e,n){return this._span.addEvent(t,e,n),this}addLink(t){return this._span.addLink(t),this}addLinks(t){return this._span.addLinks(t),this}end(t){this._span.end(t)}isRecording(){return this._span.isRecording()}recordException(t,e){this._span.recordException(t,e)}setAttribute(t,e){return this._span.setAttribute(t,e),this}setAttributes(t){return this._span.setAttributes(t),this}removeAttribute(t){const e=this._span.attributes,{[t]:n}=e,r=function(t,e){if(null==t)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(e,[t].map(bs));return this._span.attributes=r,this}setStatus(t){return this._span.setStatus(t),this}spanContext(){return this._span.spanContext()}updateName(t){return this._span.updateName(t),this}fail(t={code:"failure"}){t.code&&this._span.setAttribute("emb.error_code",t.code.toUpperCase()),this._span.end(t.endTime)}constructor(t){this._span=t}}class Es{startSpan(t,e={},n){e.attributes=e.attributes?e.attributes:{},e.attributes[He]=on.Perf;const r=e.parentSpan?re.setSpan(Bt.active(),e.parentSpan):n;return new ys(this._tracer.startSpan(t,e,r))}getSpan(t){const e=re.getSpan(t);if(e)return new ys(e)}constructor({tracerProvider:t}={}){this.setSpan=re.setSpan;const e=null!=t?t:re;this._tracer=e.getTracer("embrace-web-sdk-traces")}}const Ts="embrace_user",ws="embrace_user_id",As="embrace_external_user_id";class Ls{getEmbraceUserId(){return this._embraceUserId||this._generateNewEmbraceUserId()}setEmbraceUserId(t){this._embraceUserId=t;try{this._storage.setItem(ws,t)}catch(t){this._diag.warn("Failed to persist user object for storage, keeping it in-memory only",t)}}clearEmbraceUserId(){this._embraceUserId=null;try{this._storage.removeItem(ws)}catch(t){this._diag.warn("Failed to remove embrace user in storage",t)}}_migrateOldLocalStorageKey(){try{const t=this._storage.getItem(Ts);if(t){const e=JSON.parse(t);(t=>"string"==typeof t[ce]&&32===t[ce].length)(e)?(this._diag.debug("Migrating old user data from storage"),this._storage.setItem(ws,e[ce]),this._storage.removeItem(Ts)):(this._diag.warn("Invalid user data found in storage, clearing old user data"),this._storage.removeItem(Ts))}}catch(t){this._diag.warn("Failed to get old user data from storage",t)}}_initialSetup(){try{const e=this._storage.getItem(ws);e?"string"==typeof(t=e)&&32===t.length?this._embraceUserId=e:(this._diag.warn("Invalid embrace user id, generating a new one"),this.clearEmbraceUserId()):this._diag.debug("No existing user found in storage, creating a new one")}catch(t){this._diag.warn("Failed to get embrace user id from storage, defaulting to a new one",t)}var t;this._embraceUserId||(this._embraceUserId=this._generateNewEmbraceUserId())}_generateNewEmbraceUserId(){const t=pn();return this.setEmbraceUserId(t),t}getUserId(){try{return this._storage.getItem(As)}catch(t){return this._diag.warn("Failed to retrieve user id from storage",t),null}}setUserId(t){try{this._storage.setItem(As,t)}catch(t){this._diag.warn("Failed to store user id",t)}}clearUserId(){try{this._storage.removeItem(As)}catch(t){this._diag.warn("Failed to clear user id",t)}}constructor({diag:t,storage:e=localStorage}={}){this._embraceUserId=null,this._diag=null!=t?t:Vt.createComponentLogger({namespace:"EmbraceUserManager"}),this._storage=e,this._migrateOldLocalStorageKey(),this._initialSetup()}}const Cs={samplingPct:100,networkSpansForwardingThreshold:0},Rs="embrace_remote_config";function Os(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function xs(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Os(s,r,i,o,a,"next",t)}function a(t){Os(s,r,i,o,a,"throw",t)}o(void 0)})}}function Ps(){return Ps=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ps.apply(this,arguments)}const Ds=t=>{const e={samplingPct:t.threshold};return void 0!==t.network_span_forwarding&&(e.networkSpansForwardingThreshold=t.network_span_forwarding.pct_enabled),e};class Ns{setConfig(t){this._sdkConfig=Ps({},this._sdkConfig,t)}getConfig(){return this._sdkConfig}refreshRemoteConfig(){return xs(function*(){if(this._remoteConfigURL)try{const t=yield this._fetchRemoteConfig(this._remoteConfigURL);if(!t)return void this._diag.debug("No changes in remote config, skipping update");const[e,n]=t;this._storage.setItem(Rs,JSON.stringify({config:e,etag:n})),this._sdkConfig=Ds(e),this._etag=n}catch(t){this._diag.warn(`Failed to refresh remote config: ${t instanceof Error?t.message:String(t)}`)}}).call(this)}_getRemoteConfigFromStorage(){try{const t=this._storage.getItem(Rs);return t?JSON.parse(t):null}catch(t){return this._diag.warn(`Failed to parse remote config from storage: ${t instanceof Error?t.message:String(t)}`),null}}_fetchRemoteConfig(t){return xs(function*(){const e=yield fetch(t,{headers:this._etag?{"If-None-Match":this._etag}:{}}),n=e.headers.get("etag");if(304===e.status)return null;if(!e.ok)return this._diag.warn(`Failed to fetch remote config from ${t}: ${e.statusText}`),null;return[yield e.json(),n]}).call(this)}constructor({appID:t,appVersion:e,deviceId:n,diag:r=Vt.createComponentLogger({namespace:"embrace-config-manager"}),storage:i=localStorage,defaultConfig:s={},embraceConfigURL:o}={}){this._remoteConfigURL=null,this._etag=null,t&&e&&n&&(this._remoteConfigURL=((t,{osVersion:e,appVersion:n,deviceId:r},i)=>`${i||`https://a-${t}.config.emb-api.com`}/v2/config?appId=${t}&osVersion=${e}&appVersion=${n}&deviceId=${r}`)(t,{appVersion:e,deviceId:n,osVersion:"1"},o)),this._diag=r,this._storage=i;const a=this._getRemoteConfigFromStorage();a&&(this._etag=a.etag),this._sdkConfig=Ps({},Cs,s,a?Ds(a.config):{})}}class Is{isSDKEnabled(){const t=this._dynamicConfigManager.getConfig();return fn(this._deviceId,t.samplingPct)}isNetworkSpanForwardingEnabled(){if(this._blockNetworkSpanForwarding)return!1;const t=this._dynamicConfigManager.getConfig();return fn(this._deviceId,t.networkSpansForwardingThreshold)}constructor({dynamicConfigManager:t,deviceId:e,blockNetworkSpanForwarding:n}){this._dynamicConfigManager=t,this._deviceId=e,this._blockNetworkSpanForwarding=n}}function Ms(){return Ms=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ms.apply(this,arguments)}let ks=class{get tracer(){return this._tracer}get meter(){return this._meter}get logger(){return this._logger}getModuleDefinitions(){var t;const e=null!=(t=this.init())?t:[];return Array.isArray(e)?e:[e]}getConfig(){return this._config}setConfig(t){this._config=Ms({enabled:!0},t)}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}_updateMetricInstruments(){}_runSpanCustomizationHook(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}constructor(t,e,n){this.instrumentationName=t,this.instrumentationVersion=e,this._config={},this.setConfig(n),this._diag=Vt.createComponentLogger({namespace:t}),this._tracer=re.getTracer(t,e),this._meter=Ht.getMeter(t,e),this._logger=we.getLogger(t,e),this._updateMetricInstruments()}};class Us extends ks{get sessionManager(){return this._sessionManager}get logManager(){return this._logManager}get perf(){return this._perf}init(){}setLogManager(t){this._logManager=t}setSessionManager(t){this._sessionManager=t}constructor({instrumentationName:t,instrumentationVersion:e,config:n,diag:r,perf:s}){super(t,e,n),r&&(this._diag=r),this._perf=null!=s?s:new gr,this._sessionManager=u.getSpanSessionManager(),this._logManager=i.getLogManager()}}const Fs=["mousedown"];class js extends Us{disable(){window.removeEventListener("visibilitychange",this._checkVisibilityChange),this._avoidEndingLimitedSessions&&mn({target:window,events:Fs,callback:this._onInteractionThrottled})}enable(){window.addEventListener("visibilitychange",this._checkVisibilityChange),this._avoidEndingLimitedSessions&&gn({target:window,events:Fs,callback:this._onInteractionThrottled})}constructor({diag:t,perf:e,visibilityWaitTimeMs:n=0,limitedSessionMaxDurationMs:r=0,backgroundSessions:i=!1,maxPendingSpanCount:s=5,visibilityDoc:o=window.document}={},a){super({instrumentationName:"SpanSessionVisibilityInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._currentVisibilityState=o.visibilityState,this._checkVisibilityTimeout=null,this._interactionSinceLastVisibilityChange=!1,this._avoidEndingLimitedSessions=r>0,this._embraceSpanProcessor=a,this._checkVisibilityChange=()=>n<=0?(this._currentVisibilityState=o.visibilityState,void this._onVisibilityChange()):(this._checkVisibilityTimeout&&clearTimeout(this._checkVisibilityTimeout),"visible"===o.visibilityState&&this._currentVisibilityState!=o.visibilityState?(this._currentVisibilityState=o.visibilityState,void this._onVisibilityChange()):(this._diag.debug(`Visibility changed to ${o.visibilityState}. Will wait ${(n/1e3).toString()}s, and check if visibility changed`),void(this._checkVisibilityTimeout=setTimeout(()=>{this._currentVisibilityState!=o.visibilityState?(this._currentVisibilityState=o.visibilityState,this._onVisibilityChange()):this._diag.debug(`Visibility was not changed after timeout happened: ${o.visibilityState}`)},n)))),this._onVisibilityChange=()=>{this._diag.debug(`Visibility change detected: ${o.visibilityState}`);const t=this.sessionManager.getSessionStartTime();if(this._avoidEndingLimitedSessions&&null!==t&&this.perf.millisSinceHRTime(t)<r&&!this._interactionSinceLastVisibilityChange&&!!this._embraceSpanProcessor&&this._embraceSpanProcessor.getPendingSpansCount()<s){this._diag.debug("Not ending the session since it is considered limited"),this.sessionManager.addBreadcrumb(`Tab visibility changed to ${o.visibilityState}`);const t=this.sessionManager.getSessionId();if(t){const e=this.sessionManager.currentSessionAsReadableSpan("state_changed");e&&this._embraceSpanProcessor.storePendingSpans(t,e)}}else{const t=this.sessionManager.getSessionId();this._embraceSpanProcessor&&t&&this._embraceSpanProcessor.clearStoredSpans(t),this.sessionManager.endSessionSpanInternal("state_changed"),"hidden"===o.visibilityState&&i?(this._diag.debug("Starting a session since document visibility switched to hidden and `backgroundSessions` is enabled"),this.sessionManager.startSessionSpan({reason:"hidden"})):"visible"===o.visibilityState&&(this._diag.debug("Starting a session since document visibility switched to visible"),this.sessionManager.startSessionSpan({reason:"visible"}))}this._interactionSinceLastVisibilityChange=!1},this._onInteractionThrottled=mr(()=>{this._interactionSinceLastVisibilityChange=!0},1e3),this._config.enabled&&this.enable()}}const Bs=["keydown","mousedown","mousemove","scroll"];class Vs extends Us{constructor({diag:t}={}){super({instrumentationName:"SpanSessionBrowserActivityInstrumentation",instrumentationVersion:"1.0.0",diag:t,config:{}}),this.disable=()=>{mn({target:window,events:Bs,callback:this._onActivityThrottled}),this._activityTimeout&&clearTimeout(this._activityTimeout),this._activityTimeout=null},this.enable=()=>{gn({target:window,events:Bs,callback:this._onActivityThrottled})},this._onInactivity=()=>{this._diag.debug("Inactivity detected"),this._activityTimeout&&clearTimeout(this._activityTimeout),this._activityTimeout=null,this.sessionManager.endSessionSpanInternal("inactivity")},this._onActivity=()=>{this._diag.debug("Activity detected"),this._activityTimeout&&clearTimeout(this._activityTimeout),this.sessionManager.getSessionId()||this.sessionManager.startSessionSpan({reason:"activity"}),this._activityTimeout=setTimeout(this._onInactivity,18e5)},this._activityTimeout=null,this._onActivityThrottled=mr(this._onActivity,3e4),this._config.enabled&&this.enable()}}class $s extends Us{disable(){this.sessionManager.endSessionSpanInternal("unknown")}enable(){this.sessionManager.startSessionSpan({reason:"init"})}constructor({diag:t}={}){super({instrumentationName:"SpanSessionOnLoadInstrumentation",instrumentationVersion:"1.0.0",diag:t,config:{}}),this._config.enabled&&this.enable()}}const zs=144e5;class Hs extends Us{constructor({diag:t,perf:e}={}){super({instrumentationName:"SpanSessionTimeoutInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this.disable=()=>{this._sessionTimeout&&clearTimeout(this._sessionTimeout),this._sessionTimeout=null},this.enable=()=>{this._checkTimeout()},this._onTimeout=()=>{this._diag.debug("Timeout detected"),this._sessionTimeout&&clearTimeout(this._sessionTimeout),this.sessionManager.endSessionSpanInternal("timer"),this.sessionManager.startSessionSpan({reason:"timer"}),this._sessionTimeout=setTimeout(this._checkTimeout,zs)},this._checkTimeout=()=>{const t=this.sessionManager.getSessionStartTime();if(t){const e=this.perf.millisSinceHRTime(t),n=zs-e;return n<=0?void this._onTimeout():(this._sessionTimeout&&clearTimeout(this._sessionTimeout),void(this._sessionTimeout=setTimeout(this._checkTimeout,n)))}this._sessionTimeout&&clearTimeout(this._sessionTimeout),this._sessionTimeout=setTimeout(this._checkTimeout,zs)},this._sessionTimeout=null,this._config.enabled&&this.enable()}}class qs extends Us{disable(){window.removeEventListener("error",this._onErrorHandler),window.removeEventListener("unhandledrejection",this._onUnhandledRejectionHandler)}enable(){window.addEventListener("error",this._onErrorHandler),window.addEventListener("unhandledrejection",this._onUnhandledRejectionHandler)}constructor({diag:t,perf:e}={}){super({instrumentationName:"GlobalExceptionInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._onErrorHandler=t=>{this.logManager.logException(t.error||t.message,{handled:!1,timestamp:this.perf.epochMillisFromOriginOffset(t.timeStamp)})},this._onUnhandledRejectionHandler=t=>{let e;t.reason&&t.reason instanceof Error?e=t.reason:(e=new Error("string"==typeof t.reason?t.reason:"Unhandled Rejected Promise"),e.stack=""),this.logManager.logException(e,{handled:!1,timestamp:this.perf.epochMillisFromOriginOffset(t.timeStamp)})},this._config.enabled&&this.enable()}}const Gs=(t,e)=>{const n=t.nodeName.toLowerCase(),r=e.substring(0,30),i=e.length>30?"...":"";return`<${n}${t.className?` class="${t.className}"`:""}>${r}${i}</${n}>`};class Ks extends Us{disable(){document.removeEventListener("click",this._onClickHandler)}enable(){document.addEventListener("click",this._onClickHandler)}constructor({diag:t,perf:e,shouldTrack:n,innerTextForElement:r}={}){super({instrumentationName:"ClicksInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._onClickHandler=t=>{const e=t.target;if(e instanceof HTMLElement&&!e.hasAttribute("disabled")&&(!n||n(e)))try{const n=this.sessionManager.getSessionSpan();n&&n.addEvent("click",{"emb.type":"ux.tap","view.name":Gs(e,r?r(e):e.innerText),"tap.coords":`${t.x.toString()},${t.y.toString()}`},this.perf.epochMillisFromOriginOffset(t.timeStamp))}catch(t){this._diag.error("failed to create new user interaction span event",t)}},this._config.enabled&&this.enable()}}function Ws(){return Ws=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ws.apply(this,arguments)}class Qs{u(t){if(t.hadRecentInput)return;const e=this.i[0],n=this.i.at(-1);this.o&&e&&n&&t.startTime-n.startTime<1e3&&t.startTime-e.startTime<5e3?(this.o+=t.value,this.i.push(t)):(this.o=t.value,this.i=[t]),null==this.t||this.t.call(this,t)}constructor(){this.o=0,this.i=[]}}const Xs=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},Js=t=>{if("loading"===document.readyState)return"loading";{const e=Xs();if(e){if(t<e.domInteractive)return"loading";if(0===e.domContentLoadedEventStart||t<e.domContentLoadedEventStart)return"dom-interactive";if(0===e.domComplete||t<e.domComplete)return"dom-content-loaded"}}return"complete"},Ys=t=>{const e=t.nodeName;return 1===t.nodeType?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Zs=t=>{let e="";try{for(;9!==(null==t?void 0:t.nodeType);){const n=t,r=n.id?"#"+n.id:[Ys(n),...Array.from(n.classList).sort()].join(".");if(e.length+r.length>99)return e||r;if(e=e?r+">"+e:r,n.id)break;t=n.parentNode}}catch(e){}return e},to=new WeakMap;function eo(t,e){return to.get(t)||to.set(t,new e),to.get(t)}let no=-1;const ro=()=>no,io=t=>{addEventListener("pageshow",e=>{e.persisted&&(no=e.timeStamp,t(e))},!0)},so=(t,e,n,r)=>{let i,s;return o=>{e.value>=0&&(o||r)&&(s=e.value-(null!=i?i:0),(s||void 0===i)&&(i=e.value,e.delta=s,e.rating=((t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good")(e.value,n),t(e)))}},oo=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},ao=()=>{const t=Xs();var e;return null!=(e=null==t?void 0:t.activationStart)?e:0},uo=(t,e=-1)=>{const n=Xs();let r="navigate";return ro()>=0?r="back-forward-cache":n&&(document.prerendering||ao()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},co=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(t=>{Promise.resolve().then(()=>{e(t.getEntries())})});return r.observe(Ws({type:t,buffered:!0},n)),r}}catch(e){}},lo=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let ho=-1;const po=new Set,go=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,mo=t=>{if("hidden"===document.visibilityState){if("visibilitychange"===t.type)for(const t of po)t();isFinite(ho)||(ho="visibilitychange"===t.type?t.timeStamp:0,removeEventListener("prerenderingchange",mo,!0))}},fo=()=>{if(ho<0){var t;const e=ao(),n=document.prerendering||null==(t=globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0])?void 0:t.startTime;ho=null!=n?n:go(),addEventListener("visibilitychange",mo,!0),addEventListener("prerenderingchange",mo,!0),io(()=>{setTimeout(()=>{ho=go()})})}return{get firstHiddenTime(){return ho},onHidden(t){po.add(t)}}},_o=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},vo=[1800,3e3],bo=(t,e={})=>{_o(()=>{const n=fo();let r,i=uo("FCP");const s=co("paint",t=>{for(const e of t)"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<n.firstHiddenTime&&(i.value=Math.max(e.startTime-ao(),0),i.entries.push(e),r(!0)))});s&&(r=so(t,i,vo,e.reportAllChanges),io(n=>{i=uo("FCP"),r=so(t,i,vo,e.reportAllChanges),oo(()=>{i.value=performance.now()-n.timeStamp,r(!0)})}))})},So=[.1,.25],yo=t=>t.find(t=>{var e;return 1===(null==(e=t.node)?void 0:e.nodeType)})||t[0];let Eo=0,To=1/0,wo=0;const Ao=t=>{for(const e of t)e.interactionId&&(To=Math.min(To,e.interactionId),wo=Math.max(wo,e.interactionId),Eo=wo?(wo-To)/7+1:0)};let Lo;const Co=()=>{var t;return Lo?Eo:null!=(t=performance.interactionCount)?t:0};let Ro=0;class Oo{v(){Ro=Co(),this.l.length=0,this.h.clear()}M(){const t=Math.min(this.l.length-1,Math.floor((Co()-Ro)/50));return this.l[t]}u(t){if(null==this.m||this.m.call(this,t),!t.interactionId&&"first-input"!==t.entryType)return;const e=this.l.at(-1);let n=this.h.get(t.interactionId);if(n||this.l.length<10||t.duration>e.T){if(n?t.duration>n.T?(n.entries=[t],n.T=t.duration):t.duration===n.T&&t.startTime===n.entries[0].startTime&&n.entries.push(t):(n={id:t.interactionId,entries:[t],T:t.duration},this.h.set(n.id,n),this.l.push(n)),this.l.sort((t,e)=>e.T-t.T),this.l.length>10){const t=this.l.splice(10);for(const e of t)this.h.delete(e.id)}null==this.p||this.p.call(this,n)}}constructor(){this.l=[],this.h=new Map}}const xo=t=>{const e=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?t():(t=lo(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e(()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})}))},Po=[200,500];class Do{u(t){null==this.m||this.m.call(this,t)}}const No=[2500,4e3],Io=[800,1800],Mo=t=>{document.prerendering?_o(()=>Mo(t)):"complete"!==document.readyState?addEventListener("load",()=>Mo(t),!0):setTimeout(t)},ko=["CLS","INP","LCP"],Uo=["CLS","INP","LCP","FCP","TTFB"],Fo={CLS:(t,e={})=>{const n=eo(e=Object.assign({},e),Qs),r=new WeakMap;n.t=t=>{var n;if(null==t||null==(n=t.sources)?void 0:n.length){const n=yo(t.sources),s=null==n?void 0:n.node;if(s){var i;const t=null!=(i=null==e.generateTarget?void 0:e.generateTarget.call(e,s))?i:Zs(s);r.set(n,t)}}},((t,e={})=>{const n=fo();bo(lo(()=>{let r,i=uo("CLS",0);const s=eo(e,Qs),o=t=>{for(const e of t)s.u(e);s.o>i.value&&(i.value=s.o,i.entries=s.i,r())},a=co("layout-shift",o);a&&(r=so(t,i,So,e.reportAllChanges),n.onHidden(()=>{o(a.takeRecords()),r(!0)}),io(()=>{s.o=0,i=uo("CLS",0),r=so(t,i,So,e.reportAllChanges),oo(()=>r())}),setTimeout(r))}))})(e=>{const n=(t=>{let e={};if(t.entries.length){var n;const i=t.entries.reduce((t,e)=>t.value>e.value?t:e);if(null==i||null==(n=i.sources)?void 0:n.length){const t=yo(i.sources);t&&(e={largestShiftTarget:r.get(t),largestShiftTime:i.startTime,largestShiftValue:i.value,largestShiftSource:t,largestShiftEntry:i,loadState:Js(i.startTime)})}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},FCP:(t,e={})=>{bo(e=>{const n=(t=>{let e={timeToFirstByte:0,firstByteToFCP:t.value,loadState:Js(ro())};if(t.entries.length){const n=Xs(),r=t.entries.at(-1);if(n){const i=n.activationStart||0,s=Math.max(0,n.responseStart-i);e={timeToFirstByte:s,firstByteToFCP:t.value-s,loadState:Js(t.entries[0].startTime),navigationEntry:n,fcpEntry:r}}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},LCP:(t,e={})=>{const n=eo(e=Object.assign({},e),Do),r=new WeakMap;n.m=t=>{const n=t.element;if(n){var i;const s=null!=(i=null==e.generateTarget?void 0:e.generateTarget.call(e,n))?i:Zs(n);r.set(t,s)}},((t,e={})=>{_o(()=>{const n=fo();let r,i=uo("LCP");const s=eo(e,Do),o=t=>{e.reportAllChanges||(t=t.slice(-1));for(const e of t)s.u(e),e.startTime<n.firstHiddenTime&&(i.value=Math.max(e.startTime-ao(),0),i.entries=[e],r())},a=co("largest-contentful-paint",o);if(a){r=so(t,i,No,e.reportAllChanges);const n=lo(()=>{o(a.takeRecords()),a.disconnect(),r(!0)}),s=t=>{t.isTrusted&&(xo(n),removeEventListener(t.type,s,{capture:!0}))};for(const t of["keydown","click","visibilitychange"])addEventListener(t,s,{capture:!0});io(n=>{i=uo("LCP"),r=so(t,i,No,e.reportAllChanges),oo(()=>{i.value=performance.now()-n.timeStamp,r(!0)})})}})})(e=>{const n=(t=>{let e={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:t.value};if(t.entries.length){const n=Xs();if(n){const i=n.activationStart||0,s=t.entries.at(-1),o=s.url&&performance.getEntriesByType("resource").filter(t=>t.name===s.url)[0],a=Math.max(0,n.responseStart-i),u=Math.max(a,o?(o.requestStart||o.startTime)-i:0),c=Math.min(t.value,Math.max(u,o?o.responseEnd-i:0));e={target:r.get(s),timeToFirstByte:a,resourceLoadDelay:u-a,resourceLoadDuration:c-u,elementRenderDelay:t.value-c,navigationEntry:n,lcpEntry:s},s.url&&(e.url=s.url),o&&(e.lcpResourceEntry=o)}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},INP:(t,e={})=>{const n=eo(e=Object.assign({},e),Oo);let r=[],i=[],s=0;const o=new WeakMap,a=new WeakMap;let u=!1;const c=()=>{u||(xo(l),u=!0)},l=()=>{const t=n.l.map(t=>o.get(t.entries[0])),e=i.length-50;i=i.filter((n,r)=>r>=e||t.includes(n));const a=new Set;for(const t of i){const e=d(t.startTime,t.processingEnd);for(const t of e)a.add(t)}const c=r.length-1-50;r=r.filter((t,e)=>t.startTime>s&&e>c||a.has(t)),u=!1};n.m=t=>{const e=t.startTime+t.duration;let n;s=Math.max(s,t.processingEnd);for(let r=i.length-1;r>=0;r--){const s=i[r];if(Math.abs(e-s.renderTime)<=8){n=s,n.startTime=Math.min(t.startTime,n.startTime),n.processingStart=Math.min(t.processingStart,n.processingStart),n.processingEnd=Math.max(t.processingEnd,n.processingEnd),n.entries.push(t);break}}n||(n={startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,renderTime:e,entries:[t]},i.push(n)),(t.interactionId||"first-input"===t.entryType)&&o.set(t,n),c()},n.p=t=>{if(!a.get(t)){const r=t.entries[0].target;if(r){var n;const i=null!=(n=null==e.generateTarget?void 0:e.generateTarget.call(e,r))?n:Zs(r);a.set(t,i)}}};const d=(t,e)=>{const n=[];for(const i of r)if(!(i.startTime+i.duration<t)){if(i.startTime>e)break;n.push(i)}return n},h=t=>{const e=t.entries[0],r=o.get(e),i=e.processingStart,s=Math.max(e.startTime+e.duration,i),u=Math.min(r.processingEnd,s),c=r.entries.sort((t,e)=>t.processingStart-e.processingStart),l=d(e.startTime,u),h=n.h.get(e.interactionId),p={interactionTarget:a.get(h),interactionType:e.name.startsWith("key")?"keyboard":"pointer",interactionTime:e.startTime,nextPaintTime:s,processedEventEntries:c,longAnimationFrameEntries:l,inputDelay:i-e.startTime,processingDuration:u-i,presentationDelay:s-u,loadState:Js(e.startTime),longestScript:void 0,totalScriptDuration:void 0,totalStyleAndLayoutDuration:void 0,totalPaintDuration:void 0,totalUnattributedDuration:void 0};return(t=>{var e;if(!(null==(e=t.longAnimationFrameEntries)?void 0:e.length))return;const n=t.interactionTime,r=t.inputDelay,i=t.processingDuration;let s,o,a=0,u=0,c=0,l=0;for(const e of t.longAnimationFrameEntries){u=u+e.startTime+e.duration-e.styleAndLayoutStart;for(const t of e.scripts){const e=t.startTime+t.duration;if(e<n)continue;const c=e-Math.max(n,t.startTime),d=t.duration?c/t.duration*t.forcedStyleAndLayoutDuration:0;a+=c-d,u+=d,c>l&&(o=t.startTime<n+r?"input-delay":t.startTime>=n+r+i?"presentation-delay":"processing-duration",s=t,l=c)}}const d=t.longAnimationFrameEntries.at(-1),h=d?d.startTime+d.duration:0;h>=n+r+i&&(c=t.nextPaintTime-h),s&&o&&(t.longestScript={entry:s,subpart:o,intersectingDuration:l}),t.totalScriptDuration=a,t.totalStyleAndLayoutDuration=u,t.totalPaintDuration=c,t.totalUnattributedDuration=t.nextPaintTime-n-a-u-c})(p),Object.assign(t,{attribution:p})};co("long-animation-frame",t=>{r=r.concat(t),c()}),((t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=fo();_o(()=>{"interactionCount"in performance||Lo||(Lo=co("event",Ao,{type:"event",buffered:!0,durationThreshold:0}));let r,i=uo("INP");var s;const o=eo(e,Oo),a=t=>{xo(()=>{for(const e of t)o.u(e);const e=o.M();e&&e.T!==i.value&&(i.value=e.T,i.entries=e.entries,r())})},u=co("event",a,{durationThreshold:null!=(s=e.durationThreshold)?s:40});r=so(t,i,Po,e.reportAllChanges),u&&(u.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{a(u.takeRecords()),r(!0)}),io(()=>{o.v(),i=uo("INP"),r=so(t,i,Po,e.reportAllChanges)}))})})(e=>{const n=h(e);t(n)},e)},TTFB:(t,e={})=>{((t,e={})=>{let n=uo("TTFB"),r=so(t,n,Io,e.reportAllChanges);Mo(()=>{const i=Xs();i&&(n.value=Math.max(i.responseStart-ao(),0),n.entries=[i],r(!0),io(()=>{n=uo("TTFB",0),r=so(t,n,Io,e.reportAllChanges),r(!0)}))})})(e=>{const n=(t=>{let e={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(t.entries.length){const n=t.entries[0],r=n.activationStart||0,i=Math.max((n.workerStart||n.fetchStart)-r,0),s=Math.max(n.domainLookupStart-r,0),o=Math.max(n.connectStart-r,0),a=Math.max(n.connectEnd-r,0);e={waitingDuration:i,cacheDuration:s-i,dnsDuration:o-s,connectionDuration:a-o,requestDuration:t.value-a,navigationEntry:n}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},FID:void 0};function jo(){return jo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jo.apply(this,arguments)}class Bo extends Us{disable(){}enable(){this._metricsToTrack.forEach(t=>{var e;null==(e=this._listeners[t])||e.call(this._listeners,e=>{const n=this.sessionManager.getSessionSpan();if(!n)return;const r=this._getTimeForMetric(e),i=jo({[He]:on.WebVital,[$e]:this._getAttributedURLForMetric(e),"emb.web_vital.navigation_type":e.navigationType,"emb.web_vital.name":e.name,"emb.web_vital.rating":e.rating,"emb.web_vital.id":e.id,"emb.web_vital.delta":e.delta,"emb.web_vital.value":e.value},((t,e)=>{const n={},r=[];if("CLS"===t){const t=e.attribution;r.push({key:"largestShiftTarget",value:t.largestShiftTarget},{key:"largestShiftValue",value:t.largestShiftValue})}else if("INP"===t){const t=e.attribution;r.push({key:"interactionTarget",value:t.interactionTarget},{key:"interactionType",value:t.interactionType},{key:"nextPaintTime",value:t.nextPaintTime},{key:"inputDelay",value:t.inputDelay},{key:"processingDuration",value:t.processingDuration},{key:"presentationDelay",value:t.presentationDelay},{key:"totalScriptDuration",value:t.totalScriptDuration},{key:"totalStyleAndLayoutDuration",value:t.totalStyleAndLayoutDuration},{key:"totalPaintDuration",value:t.totalPaintDuration},{key:"totalUnattributedDuration",value:t.totalUnattributedDuration},{key:"loadState",value:t.loadState})}else if("LCP"===t){const t=e.attribution;r.push({key:"target",value:t.target},{key:"url",value:t.url},{key:"timeToFirstByte",value:t.timeToFirstByte},{key:"resourceLoadDelay",value:t.resourceLoadDelay},{key:"resourceLoadDuration",value:t.resourceLoadDuration},{key:"elementRenderDelay",value:t.elementRenderDelay})}return r.forEach(t=>{void 0!==t.value&&(n[`emb.web_vital.attribution.${t.key}`]=t.value)}),n})(t,e));n.addEvent(`emb-web-vitals-report-${t}`,i,r)})}),this._urlAttribution&&(null==this._listeners.INP||this._listeners.INP.call(this._listeners,()=>{this._attributedURL.INP=this._urlDocument.URL},{reportAllChanges:!0}),null==this._listeners.LCP||this._listeners.LCP.call(this._listeners,()=>{this._attributedURL.LCP=this._urlDocument.URL},{reportAllChanges:!0}),null==this._listeners.CLS||this._listeners.CLS.call(this._listeners,t=>{const e=t;this._largestShiftTargetForCLS!==e.attribution.largestShiftTarget&&(this._largestShiftTargetForCLS=e.attribution.largestShiftTarget,this._attributedURL.CLS=this._urlDocument.URL)},{reportAllChanges:!0}))}_getTimeForMetric(t){return"CLS"===t.name&&t.attribution.largestShiftTime?this.perf.epochMillisFromOriginOffset(t.attribution.largestShiftTime):"INP"===t.name&&t.attribution.interactionTime?this.perf.epochMillisFromOriginOffset(t.attribution.interactionTime):this.perf.getNowMillis()}_getAttributedURLForMetric(t){return"INP"===t.name&&this._attributedURL.INP?this._attributedURL.INP:"LCP"===t.name&&this._attributedURL.LCP?this._attributedURL.LCP:"CLS"===t.name&&this._attributedURL.CLS&&t.attribution.largestShiftTarget===this._largestShiftTargetForCLS?this._attributedURL.CLS:this._urlDocument.URL}constructor({diag:t,perf:e,trackingLevel:n="core",listeners:r=Fo,urlDocument:i=window.document,urlAttribution:s=!0}={}){super({instrumentationName:"WebVitalsInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._attributedURL={INP:void 0,LCP:void 0,CLS:void 0,FCP:void 0,TTFB:void 0},this._listeners=r,this._urlDocument=i,this._metricsToTrack="core"===n?[...ko]:[...Uo],this._urlAttribution=s,this._config.enabled&&this.enable()}}function Vo(t){var e;const n=t.tracerProvider||re.getTracerProvider(),r=t.meterProvider||Ht.getMeterProvider(),i=t.loggerProvider||we.getLoggerProvider();var s;const o=null!=(s=null==(e=t.instrumentations)?void 0:e.flat())?s:[];return function(t,e,n,r){for(let i=0,s=t.length;i<s;i++){const s=t[i];e&&s.setTracerProvider(e),n&&s.setMeterProvider(n),r&&s.setLoggerProvider&&s.setLoggerProvider(r),s.getConfig().enabled||s.enable()}}(o,n,r,i),()=>{!function(t){t.forEach(t=>t.disable())}(o)}}let $o=console.error.bind(console);function zo(t,e,n){const r=!!t[e]&&Object.prototype.propertyIsEnumerable.call(t,e);Object.defineProperty(t,e,{configurable:!0,enumerable:r,writable:!0,value:n})}const Ho=(t,e,n)=>{if(!t||!t[e])return void $o("no original function "+String(e)+" to wrap");if(!n)return $o("no wrapper function"),void $o((new Error).stack);const r=t[e];if("function"!=typeof r||"function"!=typeof n)return void $o("original object and wrapper must be functions");const i=n(r,e);return zo(i,"__original",r),zo(i,"__unwrap",()=>{t[e]===i&&zo(t,e,r)}),zo(i,"__wrapped",!0),zo(t,e,i),i},qo=(t,e,n)=>{if(!t)return $o("must provide one or more modules to patch"),void $o((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach(t=>{e.forEach(e=>{Ho(t,e,n)})}):$o("must provide one or more functions to wrap on modules")},Go=(t,e)=>{if(!t||!t[e])return $o("no function to unwrap."),void $o((new Error).stack);const n=t[e];n.__unwrap?n.__unwrap():$o("no original to unwrap to -- has "+String(e)+" already been unwrapped?")},Ko=(t,e)=>{if(!t)return $o("must provide one or more modules to patch"),void $o((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach(t=>{e.forEach(e=>{Go(t,e)})}):$o("must provide one or more functions to unwrap on modules")};function Wo(){return Wo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wo.apply(this,arguments)}class Qo{get meter(){return this._meter}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){var t;const e=null!=(t=this.init())?t:[];return Array.isArray(e)?e:[e]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(t){this._config=Wo({enabled:!0},t)}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}constructor(t,e,n){this._config={},this._wrap=Ho,this._unwrap=Go,this._massWrap=qo,this._massUnwrap=Ko,this.instrumentationName=t,this.instrumentationVersion=e,this.setConfig(n),this._diag=Vt.createComponentLogger({namespace:t}),this._tracer=re.getTracer(t,e),this._meter=Ht.getMeter(t,e),this._logger=we.getLogger(t,e),this._updateMetricInstruments()}}class Xo extends Qo{constructor(t,e,n){super(t,e,n),this._config.enabled&&this.enable()}}function Jo(t,e,n){let r,i;try{i=t()}catch(t){r=t}finally{return e(r,i),i}}function Yo(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped}var Zo,ta;function ea(t,e){let n=Zo.OLD;const r=null==e?void 0:e.split(",").map(t=>t.trim()).filter(t=>""!==t);for(const e of null!=r?r:[]){if(e.toLowerCase()===t+"/dup"){n=Zo.DUPLICATE;break}e.toLowerCase()===t&&(n=Zo.STABLE)}return n}!function(t){t[t.STABLE=1]="STABLE",t[t.OLD=2]="OLD",t[t.DUPLICATE=3]="DUPLICATE"}(Zo||(Zo={})),function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(ta||(ta={}));let na;function ra(t,e,n,r=!0){if(!(i=n,s=e,!(s in i)||"number"!=typeof n[e]||r&&0===n[e]))return t.addEvent(e,n[e]);var i,s}function ia(t,e,n=!1,r,i){if(void 0===r&&(r=0!==e[ta.START_TIME]),n||(ra(t,ta.FETCH_START,e,r),ra(t,ta.DOMAIN_LOOKUP_START,e,r),ra(t,ta.DOMAIN_LOOKUP_END,e,r),ra(t,ta.CONNECT_START,e,r),ra(t,ta.SECURE_CONNECTION_START,e,r),ra(t,ta.CONNECT_END,e,r),ra(t,ta.REQUEST_START,e,r),ra(t,ta.RESPONSE_START,e,r),ra(t,ta.RESPONSE_END,e,r)),!i){const n=e[ta.ENCODED_BODY_SIZE];void 0!==n&&t.setAttribute("http.response_content_length",n);const r=e[ta.DECODED_BODY_SIZE];void 0!==r&&n!==r&&t.setAttribute("http.response_content_length_uncompressed",r)}}function sa(){return"undefined"!=typeof location?location.origin:void 0}function oa(t,e,n,r,i=new WeakSet,s){const o=aa(t),a=function(t,e,n,r,i,s){const o=Nn(e),a=Nn(n);let u=r.filter(e=>{const n=Nn(Dn(e[ta.FETCH_START])),r=Nn(Dn(e[ta.RESPONSE_END]));return e.initiatorType.toLowerCase()===s&&e.name===t&&n>=o&&r<=a});u.length>0&&(u=u.filter(t=>!i.has(t)));return u}(t=o.toString(),e,n,r,i,s);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const u=function(t){return t.slice().sort((t,e)=>{const n=t[ta.FETCH_START],r=e[ta.FETCH_START];return n>r?1:n<r?-1:0})}(a);if(o.origin!==sa()&&u.length>1){let t=u[0],e=function(t,e,n){const r=Nn(n),i=Nn(Dn(e));let s,o=t[1];const a=t.length;for(let e=1;e<a;e++){const n=t[e],a=Nn(Dn(n[ta.FETCH_START])),u=r-Nn(Dn(n[ta.RESPONSE_END]));a>=i&&(!s||u<s)&&(s=u,o=n)}return o}(u,t[ta.RESPONSE_END],n);const r=t[ta.RESPONSE_END];return e[ta.FETCH_START]<r&&(e=t,t=void 0),{corsPreFlightRequest:t,mainRequest:e}}return{mainRequest:a[0]}}function aa(t){if("function"==typeof URL)return new URL(t,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);const e=(na||(na=document.createElement("a")),na);return e.href=t,e}var ua;!function(t){t.COMPONENT="component",t.HTTP_STATUS_TEXT="http.status_text"}(ua||(ua={}));function ca(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}const la=Vt.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});function da(...t){if(t[0]instanceof URL||"string"==typeof t[0]){const e=t[1];if(!(null==e?void 0:e.body))return Promise.resolve();if(e.body instanceof ReadableStream){const{body:t,length:n}=function(t){if(!t.pipeThrough)return la.warn("Platform has ReadableStream but not pipeThrough!"),{body:t,length:Promise.resolve(void 0)};let e,n=0;const r=new Promise(t=>{e=t}),i=new TransformStream({start(){},transform(t,e){return(r=function*(){const r=yield t;n+=r.byteLength,e.enqueue(t)},function(){var t=this,e=arguments;return new Promise(function(n,i){var s=r.apply(t,e);function o(t){ca(s,n,i,o,a,"next",t)}function a(t){ca(s,n,i,o,a,"throw",t)}o(void 0)})})();var r},flush(){e(n)}});return{body:t.pipeThrough(i),length:r}}(e.body);return e.body=t,n}return Promise.resolve(function(t){if(e=t,"undefined"!=typeof Document&&e instanceof Document)return(new XMLSerializer).serializeToString(document).length;var e;if("string"==typeof t)return pa(t);if(t instanceof Blob)return t.size;if(t instanceof FormData)return function(t){let e=0;for(const[n,r]of t.entries())e+=n.length,r instanceof Blob?e+=r.size:e+=r.length;return e}(t);if(t instanceof URLSearchParams)return pa(t.toString());if(void 0!==t.byteLength)return t.byteLength;return void la.warn("unknown body type")}(e.body))}{const e=t[0];return(null==e?void 0:e.body)?e.clone().text().then(t=>pa(t)):Promise.resolve()}}const ha=new TextEncoder;function pa(t){return ha.encode(t).byteLength}function ga(t){const e=function(){void 0===fa&&(fa=ma);return fa}(),n=t.toUpperCase();return n in e?n:"_OTHER"}const ma={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let fa;const _a={"https:":"443","http:":"80"};const va="0.204.0";var ba;const Sa="object"==typeof process&&"node"===(null==(ba=process.release)?void 0:ba.name);class ya extends Xo{init(){}_addChildSpan(t,e){const n=this.tracer.startSpan("CORS Preflight",{startTime:e[ta.FETCH_START]},re.setSpan(Bt.active(),t)),r=!(this._semconvStability&Zo.OLD);ia(n,e,this.getConfig().ignoreNetworkEvents,void 0,r),n.end(e[ta.RESPONSE_END])}_addFinalSpanAttributes(t,e){const n=aa(e.url);if(this._semconvStability&Zo.OLD&&(t.setAttribute("http.status_code",e.status),null!=e.statusText&&t.setAttribute(ua.HTTP_STATUS_TEXT,e.statusText),t.setAttribute("http.host",n.host),t.setAttribute("http.scheme",n.protocol.replace(":","")),"undefined"!=typeof navigator&&t.setAttribute("http.user_agent",navigator.userAgent)),this._semconvStability&Zo.STABLE){t.setAttribute(Ie,e.status),t.setAttribute(Me,n.hostname);const r=function(t){const e=Number(t.port||_a[t.protocol]);return e&&!isNaN(e)?e:void 0}(n);r&&t.setAttribute(ke,r)}}_addHeaders(t,e){if(!function(t,e){let n=e||[];return("string"==typeof n||n instanceof RegExp)&&(n=[n]),aa(t).origin===sa()||n.some(e=>cr(t,e))}(e,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return te.inject(Bt.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(t instanceof Request)te.inject(Bt.active(),t.headers,{set:(t,e,n)=>t.set(e,"string"==typeof n?n:String(n))});else if(t.headers instanceof Headers)te.inject(Bt.active(),t.headers,{set:(t,e,n)=>t.set(e,"string"==typeof n?n:String(n))});else if(t.headers instanceof Map)te.inject(Bt.active(),t.headers,{set:(t,e,n)=>t.set(e,"string"==typeof n?n:String(n))});else{const e={};te.inject(Bt.active(),e),t.headers=Object.assign({},e,t.headers||{})}}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(t,e={}){if(lr(t,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let n="";const r={};if(this._semconvStability&Zo.OLD){const i=(e.method||"GET").toUpperCase();n=`HTTP ${i}`,r[ua.COMPONENT]=this.moduleName,r["http.method"]=i,r["http.url"]=t}if(this._semconvStability&Zo.STABLE){const i=e.method,s=ga(e.method||"GET");n||(n=s),r[De]=s,s!==i&&(r[Ne]=i),r[$e]=t}return this.tracer.startSpan(n,{kind:It.CLIENT,attributes:r})}_findResourceAndAddNetworkEvents(t,e,n){let r=e.entries;if(!r.length){if(!performance.getEntriesByType)return;r=performance.getEntriesByType("resource")}const i=oa(e.spanUrl,e.startTime,n,r,this._usedResources,"fetch");if(i.mainRequest){const e=i.mainRequest;this._markResourceAsUsed(e);const n=i.corsPreFlightRequest;n&&(this._addChildSpan(t,n),this._markResourceAsUsed(n));const r=!(this._semconvStability&Zo.OLD);ia(t,e,this.getConfig().ignoreNetworkEvents,void 0,r)}}_markResourceAsUsed(t){this._usedResources.add(t)}_endSpan(t,e,n){const r=On(Date.now()),i=Pn();this._addFinalSpanAttributes(t,n),this._semconvStability&Zo.STABLE&&n.status>=400&&(t.setStatus({code:Mt.ERROR}),t.setAttribute(Re,String(n.status))),setTimeout(()=>{var n;null==(n=e.observer)||n.disconnect(),this._findResourceAndAddNetworkEvents(t,e,i),this._tasksCount--,this._clearResources(),t.end(r)},300)}_patchConstructor(){return t=>{const e=this;return function(...n){const r=this,i=aa(n[0]instanceof Request?n[0].url:String(n[0])).href,s=n[0]instanceof Request?n[0]:n[1]||{},o=e._createSpan(i,s);if(!o)return t.apply(this,n);const a=e._prepareSpanData(i);function u(t,n){e._applyAttributesAfterFetch(t,s,n),e._endSpan(t,a,{status:n.status||0,statusText:n.message,url:i})}function c(t,n){e._applyAttributesAfterFetch(t,s,n),n.status>=200&&n.status<400?e._endSpan(t,a,n):e._endSpan(t,a,{status:n.status,statusText:n.statusText,url:i})}function l(t,e,n){try{const e=n.clone().body;if(e){const r=e.getReader(),i=()=>{r.read().then(({done:e})=>{e?c(t,n):i()},e=>{u(t,e)})};i()}else c(t,n)}finally{e(n)}}function d(t,e,n){try{u(t,n)}finally{e(n)}}return e.getConfig().measureRequestSize&&da(...n).then(t=>{t&&(e._semconvStability&Zo.OLD&&o.setAttribute("http.request_content_length_uncompressed",t),e._semconvStability&Zo.STABLE&&o.setAttribute("http.request.body.size",t))}).catch(t=>{e._diag.warn("getFetchBodyLength",t)}),new Promise((n,a)=>Bt.with(re.setSpan(Bt.active(),o),()=>(e._addHeaders(s,i),e._callRequestHook(o,s),e._tasksCount++,t.apply(r,s instanceof Request?[s]:[i,s]).then(l.bind(r,o,n),d.bind(r,o,a)))))}}}_applyAttributesAfterFetch(t,e,n){const r=this.getConfig().applyCustomAttributesOnSpan;r&&Jo(()=>r(t,e,n),t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)})}_callRequestHook(t,e){const n=this.getConfig().requestHook;n&&Jo(()=>n(t,e),t=>{t&&this._diag.error("requestHook",t)})}_prepareSpanData(t){const e=Pn(),n=[];if("function"!=typeof PerformanceObserver)return{entries:n,startTime:e,spanUrl:t};const r=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{"fetch"===e.initiatorType&&e.name===t&&n.push(e)})});return r.observe({entryTypes:["resource"]}),{entries:n,observer:r,startTime:e,spanUrl:t}}enable(){Sa?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):(Yo(fetch)&&(this._unwrap(Tn,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(Tn,"fetch",this._patchConstructor()))}disable(){Sa||(this._unwrap(Tn,"fetch"),this._usedResources=new WeakSet)}constructor(t={}){super("@opentelemetry/instrumentation-fetch",va,t),this.component="fetch",this.version=va,this.moduleName=this.component,this._usedResources=new WeakSet,this._tasksCount=0,this._semconvStability=ea("http",null==t?void 0:t.semconvStabilityOptIn)}}function Ea(){return Ea=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ea.apply(this,arguments)}class Ta extends ya{enable(){this._omitIfAlreadyPatched&&Yo(fetch)?this._diag.debug("fetch is already passed and `omitIfAlreadyPatched` is true, skipping enabling this instrumentation"):super.enable()}constructor(t={}){var{omitIfAlreadyPatched:e}=t,n=function(t,e){if(null==t)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,["omitIfAlreadyPatched"]);super(Ea({},n,{enabled:!1})),this._omitIfAlreadyPatched=e,n.enabled&&this.enable()}}var wa;!function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(wa||(wa={}));let Aa;function La(t,e,n,r=!0){if(!(i=n,s=e,!(s in i)||"number"!=typeof n[e]||r&&0===n[e]))return t.addEvent(e,n[e]);var i,s}function Ca(t,e,n=!1,r,i){if(void 0===r&&(r=0!==e[wa.START_TIME]),n||(La(t,wa.FETCH_START,e,r),La(t,wa.DOMAIN_LOOKUP_START,e,r),La(t,wa.DOMAIN_LOOKUP_END,e,r),La(t,wa.CONNECT_START,e,r),La(t,wa.SECURE_CONNECTION_START,e,r),La(t,wa.CONNECT_END,e,r),La(t,wa.REQUEST_START,e,r),La(t,wa.RESPONSE_START,e,r),La(t,wa.RESPONSE_END,e,r)),!i){const n=e[wa.ENCODED_BODY_SIZE];void 0!==n&&t.setAttribute("http.response_content_length",n);const r=e[wa.DECODED_BODY_SIZE];void 0!==r&&n!==r&&t.setAttribute("http.response_content_length_uncompressed",r)}}function Ra(){return"undefined"!=typeof location?location.origin:void 0}function Oa(t,e,n,r,i=new WeakSet,s){const o=xa(t),a=function(t,e,n,r,i){const s=Nn(e),o=Nn(n);let a=r.filter(e=>{const n=Nn(Dn(e[wa.FETCH_START])),r=Nn(Dn(e[wa.RESPONSE_END]));return"xmlhttprequest"===e.initiatorType.toLowerCase()&&e.name===t&&n>=s&&r<=o});a.length>0&&(a=a.filter(t=>!i.has(t)));return a}(t=o.toString(),e,n,r,i);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const u=function(t){return t.slice().sort((t,e)=>{const n=t[wa.FETCH_START],r=e[wa.FETCH_START];return n>r?1:n<r?-1:0})}(a);if(o.origin!==Ra()&&u.length>1){let t=u[0],e=function(t,e,n){const r=Nn(n),i=Nn(Dn(e));let s,o=t[1];const a=t.length;for(let e=1;e<a;e++){const n=t[e],a=Nn(Dn(n[wa.FETCH_START])),u=r-Nn(Dn(n[wa.RESPONSE_END]));a>=i&&(!s||u<s)&&(s=u,o=n)}return o}(u,t[wa.RESPONSE_END],n);const r=t[wa.RESPONSE_END];return e[wa.FETCH_START]<r&&(e=t,t=void 0),{corsPreFlightRequest:t,mainRequest:e}}return{mainRequest:a[0]}}function xa(t){if("function"==typeof URL)return new URL(t,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);const e=(Aa||(Aa=document.createElement("a")),Aa);return e.href=t,e}var Pa;!function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"}(Pa||(Pa={}));const Da=Vt.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-xml-http-request/utils"});function Na(t){return e=t,"undefined"!=typeof Document&&e instanceof Document?(new XMLSerializer).serializeToString(document).length:"string"==typeof t?Ma(t):t instanceof Blob?t.size:t instanceof FormData?function(t){let e=0;for(const[n,r]of t.entries())e+=n.length,r instanceof Blob?e+=r.size:e+=r.length;return e}(t):t instanceof URLSearchParams?Ma(t.toString()):void 0!==t.byteLength?t.byteLength:void Da.warn("unknown body type");var e}const Ia=new TextEncoder;function Ma(t){return Ia.encode(t).byteLength}const ka={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let Ua;function Fa(){return void 0===Ua&&(Ua=ka),Ua}const ja={"https:":"443","http:":"80"};const Ba="0.204.0";var Va;!function(t){t.HTTP_STATUS_TEXT="http.status_text"}(Va||(Va={}));class $a extends Xo{init(){}_addHeaders(t,e){if(!function(t,e){let n=e||[];return("string"==typeof n||n instanceof RegExp)&&(n=[n]),xa(t).origin===Ra()||n.some(e=>cr(t,e))}(xa(e).href,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return te.inject(Bt.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}const n={};te.inject(Bt.active(),n),Object.keys(n).forEach(e=>{t.setRequestHeader(e,String(n[e]))})}_addChildSpan(t,e){Bt.with(re.setSpan(Bt.active(),t),()=>{const t=this.tracer.startSpan("CORS Preflight",{startTime:e[wa.FETCH_START]}),n=!(this._semconvStability&Zo.OLD);Ca(t,e,this.getConfig().ignoreNetworkEvents,void 0,n),t.end(e[wa.RESPONSE_END])})}_addFinalSpanAttributes(t,e,n){if(this._semconvStability&Zo.OLD){if(void 0!==e.status&&t.setAttribute("http.status_code",e.status),void 0!==e.statusText&&t.setAttribute(Va.HTTP_STATUS_TEXT,e.statusText),"string"==typeof n){const e=xa(n);t.setAttribute("http.host",e.host),t.setAttribute("http.scheme",e.protocol.replace(":",""))}t.setAttribute("http.user_agent",navigator.userAgent)}this._semconvStability&Zo.STABLE&&e.status&&t.setAttribute(Ie,e.status)}_applyAttributesAfterXHR(t,e){const n=this.getConfig().applyCustomAttributesOnSpan;"function"==typeof n&&Jo(()=>n(t,e),t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)})}_addResourceObserver(t,e){const n=this._xhrMem.get(t);n&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(n.createdResources={observer:new PerformanceObserver(t=>{const r=t.getEntries(),i=xa(e);r.forEach(t=>{"xmlhttprequest"===t.initiatorType&&t.name===i.href&&n.createdResources&&n.createdResources.entries.push(t)})}),entries:[]},n.createdResources.observer.observe({entryTypes:["resource"]}))}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(wn.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)}_findResourceAndAddNetworkEvents(t,e,n,r,i){if(!(n&&r&&i&&t.createdResources))return;let s=t.createdResources.entries;s&&s.length||(s=wn.getEntriesByType("resource"));const o=Oa(xa(n).href,r,i,s,this._usedResources);if(o.mainRequest){const t=o.mainRequest;this._markResourceAsUsed(t);const n=o.corsPreFlightRequest;n&&(this._addChildSpan(e,n),this._markResourceAsUsed(n));const r=!(this._semconvStability&Zo.OLD);Ca(e,t,this.getConfig().ignoreNetworkEvents,void 0,r)}}_cleanPreviousSpanInformation(t){const e=this._xhrMem.get(t);if(e){const n=e.callbackToRemoveEvents;n&&n(),this._xhrMem.delete(t)}}_createSpan(t,e,n){if(lr(e,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let r="";const i=xa(e),s={};if(this._semconvStability&Zo.OLD&&(r=n.toUpperCase(),s["http.method"]=n,s["http.url"]=i.toString()),this._semconvStability&Zo.STABLE){const t=n,e=function(t){const e=Fa(),n=t.toUpperCase();return n in e?n:"_OTHER"}(n);r||(r=e),s[De]=e,e!==t&&(s[Ne]=t),s[$e]=i.toString(),s[Me]=i.hostname;const o=function(t){const e=Number(t.port||ja[t.protocol]);return e&&!isNaN(e)?e:void 0}(i);o&&(s[ke]=o)}const o=this.tracer.startSpan(r,{kind:It.CLIENT,attributes:s});return o.addEvent(Pa.METHOD_OPEN),this._cleanPreviousSpanInformation(t),this._xhrMem.set(t,{span:o,spanUrl:e}),o}_markResourceAsUsed(t){this._usedResources.add(t)}_patchOpen(){return t=>{const e=this;return function(...n){const r=n[0],i=n[1];return e._createSpan(this,i,r),t.apply(this,n)}}}_patchSend(){const t=this;function e(e,n,r,i){const s=t._xhrMem.get(n);if(!s)return;if(s.status=n.status,s.statusText=n.statusText,t._xhrMem.delete(n),s.span){const e=s.span;t._applyAttributesAfterXHR(e,n),t._semconvStability&Zo.STABLE&&(r?i&&(e.setStatus({code:Mt.ERROR,message:i}),e.setAttribute(Re,i)):s.status&&s.status>=400&&(e.setStatus({code:Mt.ERROR}),e.setAttribute(Re,String(s.status))))}const o=Pn(),a=Date.now();setTimeout(()=>{!function(e,n,r,i){const s=n.callbackToRemoveEvents;"function"==typeof s&&s();const{span:o,spanUrl:a,sendStartTime:u}=n;o&&(t._findResourceAndAddNetworkEvents(n,o,a,u,r),o.addEvent(e,i),t._addFinalSpanAttributes(o,n,a),o.end(i),t._tasksCount--),t._clearResources()}(e,s,o,a)},300)}function n(){e(Pa.EVENT_ERROR,this,!0,"error")}function r(){e(Pa.EVENT_ABORT,this,!1)}function i(){e(Pa.EVENT_TIMEOUT,this,!0,"timeout")}function s(){this.status<299?e(Pa.EVENT_LOAD,this,!1):e(Pa.EVENT_ERROR,this,!1)}return e=>function(...o){const a=t._xhrMem.get(this);if(!a)return e.apply(this,o);const u=a.span,c=a.spanUrl;if(u&&c){if(t.getConfig().measureRequestSize&&(null==o?void 0:o[0])){const e=Na(o[0]);void 0!==e&&(t._semconvStability&Zo.OLD&&u.setAttribute("http.request_content_length_uncompressed",e),t._semconvStability&Zo.STABLE&&u.setAttribute("http.request.body.size",e))}Bt.with(re.setSpan(Bt.active(),u),()=>{t._tasksCount++,a.sendStartTime=Pn(),u.addEvent(Pa.METHOD_SEND),this.addEventListener("abort",r),this.addEventListener("error",n),this.addEventListener("load",s),this.addEventListener("timeout",i),a.callbackToRemoveEvents=()=>{!function(e){e.removeEventListener("abort",r),e.removeEventListener("error",n),e.removeEventListener("load",s),e.removeEventListener("timeout",i);const o=t._xhrMem.get(e);o&&(o.callbackToRemoveEvents=void 0)}(this),a.createdResources&&a.createdResources.observer.disconnect()},t._addHeaders(this,c),t._addResourceObserver(this,c)})}return e.apply(this,o)}}enable(){this._diag.debug("applying patch to",this.moduleName,this.version),Yo(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),Yo(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())}disable(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}constructor(t={}){super("@opentelemetry/instrumentation-xml-http-request",Ba,t),this.component="xml-http-request",this.version=Ba,this.moduleName=this.component,this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet,this._semconvStability=ea("http",null==t?void 0:t.semconvStabilityOptIn)}}function za(){return za=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},za.apply(this,arguments)}class Ha extends $a{enable(){this._omitIfAlreadyPatched&&(Yo(XMLHttpRequest.prototype.open)||Yo(XMLHttpRequest.prototype.send))?this._diag.debug("XMLHttpRequest is already passed and `omitIfAlreadyPatched` is true, skipping enabling this instrumentation"):super.enable()}constructor(t={}){var{omitIfAlreadyPatched:e}=t,n=function(t,e){if(null==t)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,["omitIfAlreadyPatched"]);super(za({},n,{enabled:!1})),this._omitIfAlreadyPatched=e,n.enabled&&this.enable()}}const qa=/\(.*?\)/g;class Ga extends Us{constructor({diag:t,shouldCleanupPathOptionsFromRouteName:e=!0}){super({instrumentationName:"NavigationInstrumentation",instrumentationVersion:"1.0.0",diag:t,config:{}}),this._shouldCleanupPathOptionsFromRouteName=!0,this._currentRoute=null,this._currentRouteSpan=null,this._instrumentationType=null,this._removeSessionStartedFn=null,this._removeSessionEndedFn=null,this.setInstrumentationType=t=>{this._instrumentationType=t},this.setCurrentRoute=t=>{var e;this._config.enabled&&t.url!==(null==(e=this._currentRoute)?void 0:e.url)&&(this._endRouteSpan(),this._startRouteSpan(t),this._currentRoute=t)},this._setupSessionListeners=()=>{this._removeSessionStartedFn||(this._removeSessionStartedFn=this.sessionManager.addSessionStartedListener(()=>{this._currentRoute&&!this._currentRouteSpan&&(this._diag.debug("Session started, starting route span."),this._startRouteSpan(this._currentRoute))})),this._removeSessionEndedFn||(this._removeSessionEndedFn=this.sessionManager.addSessionEndedListener(()=>{this._currentRouteSpan&&(this._diag.debug("Session ended, ending route span."),this._endRouteSpan())}))},this._cleanUpSessionListeners=()=>{this._removeSessionStartedFn&&(this._removeSessionStartedFn(),this._removeSessionStartedFn=null),this._removeSessionEndedFn&&(this._removeSessionEndedFn(),this._removeSessionEndedFn=null)},this._startRouteSpan=t=>{this._diag.debug(`Starting route span for url: ${t.url}`),this._setupSessionListeners();const e=this._shouldCleanupPathOptionsFromRouteName?t.path.replace(qa,""):t.path;return this._currentRouteSpan=this.tracer.startSpan(e,{attributes:{[He]:on.View,[sn]:e}}),this._instrumentationType&&this._currentRouteSpan.setAttribute("emb.instrumentation",this._instrumentationType),this._currentRouteSpan},this._endRouteSpan=()=>{this._currentRouteSpan&&this._currentRoute&&(this._diag.debug(`Ending route span for url: ${this._currentRoute.url}`),this._currentRouteSpan.end(),this._currentRouteSpan=null)},this.enable=()=>{this._diag.debug("NavigationInstrumentation enabled, listening for navigation events.")},this.disable=()=>{this._cleanUpSessionListeners(),this.setConfig({enabled:!1}),this._diag.debug("NavigationInstrumentation disabled, stopped listening for navigation events.")},this._shouldCleanupPathOptionsFromRouteName=e,this._config.enabled&&this.enable()}}let Ka;var Wa=function(t){return t.DOCUMENT_LOAD="documentLoad",t.DOCUMENT_FETCH="documentFetch",t.RESOURCE_FETCH="resourceFetch",t}({}),Qa=function(t){return t.FIRST_PAINT="firstPaint",t.FIRST_CONTENTFUL_PAINT="firstContentfulPaint",t}({});const Xa={"first-paint":Qa.FIRST_PAINT,"first-contentful-paint":Qa.FIRST_CONTENTFUL_PAINT};class Ja extends Us{init(){this._diag.debug("Initializing document load instrumentation")}_addResourcesSpans(t){performance.getEntriesByType("resource").forEach(e=>{this._initResourceSpan(e,t)})}_collectPerformance(){const t=Array.from(document.getElementsByTagName("meta")).find(t=>t.getAttribute("name")===Bn),e=(()=>{const t={},e=window.performance.getEntriesByType("navigation")[0];return Object.values(Vi).forEach(n=>{if($i(e,n)){const r=e[n];"number"==typeof r&&(t[n]=r)}}),t})(),n=t&&t.content||"";Bt.with(te.extract(U,{traceparent:n}),()=>{var t;const n=this._startSpan(Wa.DOCUMENT_LOAD,Vi.FETCH_START,e);var r;n&&(Bt.with(re.setSpan(Bt.active(),n),()=>{const t=this._startSpan(Wa.DOCUMENT_FETCH,Vi.FETCH_START,e);t&&(t.setAttribute($e,location.href),Bt.with(re.setSpan(Bt.active(),t),()=>{var n;Hi(t,e,this.getConfig().ignoreNetworkEvents),this._addCustomAttributesOnSpan(t,null==(n=this.getConfig().applyCustomAttributesOnSpan)?void 0:n.documentFetch),this._endSpan(t,Vi.RESPONSE_END,e)}))}),n.setAttribute(He,on.DocumentLoad),n.setAttribute($e,location.href),n.setAttribute(ze,navigator.userAgent),this._addResourcesSpans(n),this.getConfig().ignoreNetworkEvents||(zi(n,Vi.FETCH_START,e),zi(n,Vi.UNLOAD_EVENT_START,e),zi(n,Vi.UNLOAD_EVENT_END,e),zi(n,Vi.DOM_INTERACTIVE,e),zi(n,Vi.DOM_CONTENT_LOADED_EVENT_START,e),zi(n,Vi.DOM_CONTENT_LOADED_EVENT_END,e),zi(n,Vi.DOM_COMPLETE,e),zi(n,Vi.LOAD_EVENT_START,e),zi(n,Vi.LOAD_EVENT_END,e)),this.getConfig().ignorePerformancePaintEvents||(r=n,window.performance.getEntriesByType("paint").forEach(({name:t,startTime:e})=>{$i(Xa,t)&&r.addEvent(Xa[t],e)})),this._addCustomAttributesOnSpan(n,null==(t=this.getConfig().applyCustomAttributesOnSpan)?void 0:t.documentLoad),this._endSpan(n,Vi.LOAD_EVENT_END,e))})}_endSpan(t,e,n){t&&($i(n,e)&&"number"==typeof n[e]?t.end(n[e]):t.end())}_initResourceSpan(t,e){const n=this._startSpan(Wa.RESOURCE_FETCH,Vi.FETCH_START,t,e);var r;n&&(n.setAttribute(He,on.ResourceFetch),n.setAttribute($e,t.name),Hi(n,t,this.getConfig().ignoreNetworkEvents),t.deliveryType&&n.setAttribute("delivery_type",t.deliveryType),n.setAttribute("entry_type",t.entryType),n.setAttribute("initiator_type",t.initiatorType),t.renderBlockingStatus&&n.setAttribute("render_blocking_status",t.renderBlockingStatus),n.setAttribute(Ie,t.responseStatus),n.setAttribute(Ji,t.encodedBodySize),n.setAttribute("http.response.size",t.transferSize),n.setAttribute("decoded_body_size",t.decodedBodySize),this._addCustomAttributesOnResourceSpan(n,t,null==(r=this.getConfig().applyCustomAttributesOnSpan)?void 0:r.resourceFetch),this._endSpan(n,Vi.RESPONSE_END,t))}_startSpan(t,e,n,r){if($i(n,e)&&"number"==typeof n[e]){return this.tracer.startSpan(t,{startTime:n[e]},r?re.setSpan(Bt.active(),r):void 0)}}_waitForPageLoad(){"complete"===window.document.readyState?this._onDocumentLoaded():window.addEventListener("load",this._onDocumentLoaded)}_addCustomAttributesOnSpan(t,e){e&&Jo(()=>{e(t)},t=>{t&&this._diag.error("addCustomAttributesOnSpan",t)})}_addCustomAttributesOnResourceSpan(t,e,n){n&&Jo(()=>{n(t,e)},t=>{t&&this._diag.error("addCustomAttributesOnResourceSpan",t)})}enable(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()}disable(){window.removeEventListener("load",this._onDocumentLoaded)}constructor({diag:t,perf:e,enabled:n,applyCustomAttributesOnSpan:r,ignorePerformancePaintEvents:i=!1,ignoreNetworkEvents:s=!1}={}){super({instrumentationName:"DocumentLoadInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{enabled:n,applyCustomAttributesOnSpan:r,ignorePerformancePaintEvents:i,ignoreNetworkEvents:s}}),this._onDocumentLoaded=()=>{window.setTimeout(()=>{this._collectPerformance()},0)},this._config.enabled&&this.enable()}}class Ya{set severityText(t){this._isLogRecordReadonly()||(this._severityText=t)}get severityText(){return this._severityText}set severityNumber(t){this._isLogRecordReadonly()||(this._severityNumber=t)}get severityNumber(){return this._severityNumber}set body(t){this._isLogRecordReadonly()||(this._body=t)}get body(){return this._body}get eventName(){return this._eventName}set eventName(t){this._isLogRecordReadonly()||(this._eventName=t)}get droppedAttributesCount(){return this.totalAttributesCount-Object.keys(this.attributes).length}setAttribute(t,e){return this._isLogRecordReadonly()||null===e?this:0===t.length?(Vt.warn(`Invalid attribute key: ${t}`),this):bn(e)||"object"==typeof e&&!Array.isArray(e)&&Object.keys(e).length>0?(this.totalAttributesCount+=1,Object.keys(this.attributes).length>=this._logRecordLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(1===this.droppedAttributesCount&&Vt.warn("Dropping extra attributes."),this):(bn(e)?this.attributes[t]=this._truncateToSize(e):this.attributes[t]=e,this)):(Vt.warn(`Invalid attribute value set for key: ${t}`),this)}setAttributes(t){for(const[e,n]of Object.entries(t))this.setAttribute(e,n);return this}setBody(t){return this.body=t,this}setEventName(t){return this.eventName=t,this}setSeverityNumber(t){return this.severityNumber=t,this}setSeverityText(t){return this.severityText=t,this}_makeReadonly(){this._isReadonly=!0}_truncateToSize(t){const e=this._logRecordLimits.attributeValueLengthLimit;return e<=0?(Vt.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map(t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t):t}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_isLogRecordReadonly(){return this._isReadonly&&Vt.warn("Can not execute the operation on emitted log record"),this._isReadonly}constructor(t,e,n){this.attributes={},this.totalAttributesCount=0,this._isReadonly=!1;const{timestamp:r,observedTimestamp:i,eventName:s,severityNumber:o,severityText:a,body:u,attributes:c={},context:l}=n,d=Date.now();if(this.hrTime=Dn(null!=r?r:d),this.hrTimeObserved=Dn(null!=i?i:d),l){const t=re.getSpanContext(l);t&&Ot(t)&&(this.spanContext=t)}this.severityNumber=o,this.severityText=a,this.body=u,this.resource=t.resource,this.instrumentationScope=e,this._logRecordLimits=t.logRecordLimits,this._eventName=s,this.setAttributes(c)}}function Za(){return Za=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Za.apply(this,arguments)}class tu{emit(t){const e=t.context||Bt.active(),n=new Ya(this._sharedState,this.instrumentationScope,Za({context:e},t));this._sharedState.activeProcessor.onEmit(n,e),n._makeReadonly()}constructor(t,e){this.instrumentationScope=t,this._sharedState=e}}class eu{forceFlush(){return Promise.resolve()}onEmit(t,e){}shutdown(){return Promise.resolve()}}function nu(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function ru(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){nu(s,r,i,o,a,"next",t)}function a(t){nu(s,r,i,o,a,"throw",t)}o(void 0)})}}class iu{forceFlush(){return ru(function*(){const t=this.forceFlushTimeoutMillis;yield Promise.all(this.processors.map(e=>ur(e.forceFlush(),t)))}).call(this)}onEmit(t,e){this.processors.forEach(n=>n.onEmit(t,e))}shutdown(){return ru(function*(){yield Promise.all(this.processors.map(t=>t.shutdown()))}).call(this)}constructor(t,e){this.processors=t,this.forceFlushTimeoutMillis=e}}class su{constructor(t,e,n,r){this.loggers=new Map,this.registeredLogRecordProcessors=[],this.resource=t,this.forceFlushTimeoutMillis=e,this.logRecordLimits=n,this.processors=r,r.length>0?(this.registeredLogRecordProcessors=r,this.activeProcessor=new iu(this.registeredLogRecordProcessors,this.forceFlushTimeoutMillis)):this.activeProcessor=new eu}}class ou{getLogger(t,e,n){if(this._shutdownOnce.isCalled)return Vt.warn("A shutdown LoggerProvider cannot provide a Logger"),fe;t||Vt.warn("Logger requested without instrumentation scope name.");const r=t||"unknown",i=`${r}@${e||""}:${(null==n?void 0:n.schemaUrl)||""}`;return this._sharedState.loggers.has(i)||this._sharedState.loggers.set(i,new tu({name:r,version:e,schemaUrl:null==n?void 0:n.schemaUrl},this._sharedState)),this._sharedState.loggers.get(i)}forceFlush(){return this._shutdownOnce.isCalled?(Vt.warn("invalid attempt to force flush after LoggerProvider shutdown"),this._shutdownOnce.promise):this._sharedState.activeProcessor.forceFlush()}shutdown(){return this._shutdownOnce.isCalled?(Vt.warn("shutdown may only be called once per LoggerProvider"),this._shutdownOnce.promise):this._shutdownOnce.call()}_shutdown(){return this._sharedState.activeProcessor.shutdown()}constructor(t={}){const e=function(...t){let e=t.shift();const n=new WeakMap;for(;t.length>0;)e=er(e,t.shift(),0,n);return e}({},{forceFlushTimeoutMillis:3e4,logRecordLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},includeTraceContext:!0},t);var n;const r=null!=(n=t.resource)?n:ds({[Ue]:"unknown_service",[Fe]:Ln[Fe],[Be]:Ln[Be],[Ve]:Ln[Ve]});var i,s,o,a,u,c,l,d;this._sharedState=new su(r,e.forceFlushTimeoutMillis,(s=e.logRecordLimits,{attributeCountLimit:null!=(u=null!=(a=null!=(o=s.attributeCountLimit)?o:void 0)?a:void 0)?u:128,attributeValueLengthLimit:null!=(d=null!=(l=null!=(c=s.attributeValueLengthLimit)?c:void 0)?l:void 0)?d:1/0}),null!=(i=null==t?void 0:t.processors)?i:[]),this._shutdownOnce=new hr(this._shutdown,this)}}function au(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class uu{onEmit(t){this._shutdownOnce.isCalled||this._addToBuffer(t)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}shutdown(){return this._shutdownOnce.call()}_shutdown(){return(t=function*(){this.onShutdown(),yield this._flushAll(),yield this._exporter.shutdown()},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){au(s,r,i,o,a,"next",t)}function a(t){au(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}_addToBuffer(t){this._finishedLogRecords.length>=this._maxQueueSize||(this._finishedLogRecords.push(t),this._maybeStartTimer())}_flushAll(){return new Promise((t,e)=>{const n=[],r=Math.ceil(this._finishedLogRecords.length/this._maxExportBatchSize);for(let t=0;t<r;t++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{t()}).catch(e)})}_flushOneBatch(){return this._clearTimer(),0===this._finishedLogRecords.length?Promise.resolve():new Promise((t,e)=>{ur(this._export(this._finishedLogRecords.splice(0,this._maxExportBatchSize)),this._exportTimeoutMillis).then(()=>t()).catch(e)})}_maybeStartTimer(){void 0===this._timer&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedLogRecords.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{En(t)})},this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}_export(t){const e=()=>pr._export(this._exporter,t).then(t=>{var e;t.code!==In.SUCCESS&&En(null!=(e=t.error)?e:new Error(`BatchLogRecordProcessor: log record export failed (status ${t})`))}).catch(En),n=t.map(t=>t.resource).filter(t=>t.asyncAttributesPending);return 0===n.length?e():Promise.all(n.map(t=>null==t.waitForAsyncAttributes?void 0:t.waitForAsyncAttributes.call(t))).then(e,En)}constructor(t,e){var n,r,i,s,o,a,u,c;this._finishedLogRecords=[],this._exporter=t,this._maxExportBatchSize=null!=(r=null!=(n=null==e?void 0:e.maxExportBatchSize)?n:void 0)?r:512,this._maxQueueSize=null!=(s=null!=(i=null==e?void 0:e.maxQueueSize)?i:void 0)?s:2048,this._scheduledDelayMillis=null!=(a=null!=(o=null==e?void 0:e.scheduledDelayMillis)?o:void 0)?a:5e3,this._exportTimeoutMillis=null!=(c=null!=(u=null==e?void 0:e.exportTimeoutMillis)?u:void 0)?c:3e4,this._shutdownOnce=new hr(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Vt.warn("BatchLogRecordProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}}class cu extends uu{onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}_onInit(t){!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush()},this._pageHideListener=()=>{this.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}constructor(t,e){super(t,e),this._onInit(e)}}function lu(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function du(t){const e=new Uint8Array(t.length/2);let n=0;for(let r=0;r<t.length;r+=2){const i=lu(t.charCodeAt(r)),s=lu(t.charCodeAt(r+1));e[n++]=i<<4|s}return e}function hu(t){const e=BigInt(1e9);return BigInt(t[0])*e+BigInt(t[1])}function pu(t){const e=hu(t);return n=e,{low:Number(BigInt.asUintN(32,n)),high:Number(BigInt.asUintN(32,n>>BigInt(32)))};var n}const gu="undefined"!=typeof BigInt?function(t){return hu(t).toString()}:Nn;function mu(t){return t}function fu(t){if(void 0!==t)return du(t)}const _u={encodeHrTime:pu,encodeSpanContext:du,encodeOptionalSpanContext:fu};function vu(t){if(void 0===t)return _u;var e;const n=null==(e=t.useLongBits)||e;var r;const i=null!=(r=t.useHex)&&r;return{encodeHrTime:n?pu:gu,encodeSpanContext:i?mu:du,encodeOptionalSpanContext:i?mu:fu}}function bu(t){const e={attributes:yu(t.attributes),droppedAttributesCount:0},n=t.schemaUrl;return n&&""!==n&&(e.schemaUrl=n),e}function Su(t){return{name:t.name,version:t.version}}function yu(t){return Object.keys(t).map(e=>Eu(e,t[e]))}function Eu(t,e){return{key:t,value:Tu(e)}}function Tu(t){const e=typeof t;return"string"===e?{stringValue:t}:"number"===e?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:"boolean"===e?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(Tu)}}:"object"===e&&null!=t?{kvlistValue:{values:Object.entries(t).map(([t,e])=>Eu(t,e))}}:{}}function wu(t,e){const n=function(t){const e=new Map;for(const n of t){const{resource:t,instrumentationScope:{name:r,version:i="",schemaUrl:s=""}}=n;let o=e.get(t);o||(o=new Map,e.set(t,o));const a=`${r}@${i}:${s}`;let u=o.get(a);u||(u=[],o.set(a,u)),u.push(n)}return e}(t);return Array.from(n,([t,n])=>{const r=bu(t);return{resource:r,scopeLogs:Array.from(n,([,t])=>({scope:Su(t[0].instrumentationScope),logRecords:t.map(t=>function(t,e){var n,r,i;return{timeUnixNano:e.encodeHrTime(t.hrTime),observedTimeUnixNano:e.encodeHrTime(t.hrTimeObserved),severityNumber:t.severityNumber,severityText:t.severityText,body:Tu(t.body),eventName:t.eventName,attributes:Au(t.attributes),droppedAttributesCount:t.droppedAttributesCount,flags:null==(n=t.spanContext)?void 0:n.traceFlags,traceId:e.encodeOptionalSpanContext(null==(r=t.spanContext)?void 0:r.traceId),spanId:e.encodeOptionalSpanContext(null==(i=t.spanContext)?void 0:i.spanId)}}(t,e)),schemaUrl:t[0].instrumentationScope.schemaUrl})),schemaUrl:r.schemaUrl}})}function Au(t){return Object.keys(t).map(e=>Eu(e,t[e]))}function Lu(t,e){var n,r,i;const s=t.spanContext(),o=t.status,a=(null==(n=t.parentSpanContext)?void 0:n.spanId)?e.encodeSpanContext(null==(r=t.parentSpanContext)?void 0:r.spanId):void 0;return{traceId:e.encodeSpanContext(s.traceId),spanId:e.encodeSpanContext(s.spanId),parentSpanId:a,traceState:null==(i=s.traceState)?void 0:i.serialize(),name:t.name,kind:null==t.kind?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:yu(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(t=>function(t,e){return{attributes:t.attributes?yu(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e)),droppedEventsCount:t.droppedEventsCount,status:{code:o.code,message:o.message},links:t.links.map(t=>function(t,e){var n;return{attributes:t.attributes?yu(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:null==(n=t.context.traceState)?void 0:n.serialize(),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e)),droppedLinksCount:t.droppedLinksCount}}function Cu(t,e){const n=function(t){const e=new Map;for(const n of t){let t=e.get(n.resource);t||(t=new Map,e.set(n.resource,t));const r=`${n.instrumentationScope.name}@${n.instrumentationScope.version||""}:${n.instrumentationScope.schemaUrl||""}`;let i=t.get(r);i||(i=[],t.set(r,i)),i.push(n)}return e}(t),r=[],i=n.entries();let s=i.next();for(;!s.done;){const[t,n]=s.value,o=[],a=n.values();let u=a.next();for(;!u.done;){const t=u.value;if(t.length>0){const n=t.map(t=>Lu(t,e));o.push({scope:Su(t[0].instrumentationScope),spans:n,schemaUrl:t[0].instrumentationScope.schemaUrl})}u=a.next()}const c=bu(t),l={resource:c,scopeSpans:o,schemaUrl:c.schemaUrl};r.push(l),s=i.next()}return r}const Ru={serializeRequest:t=>{const e={resourceLogs:wu(t,vu({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}},Ou={serializeRequest:t=>{const e={resourceSpans:Cu(t,vu({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};class xu{export(t,e){this._delegate.export(t,e)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}constructor(t){this._delegate=t}}class Pu extends xu{constructor(t){super(sc(t,Ru))}}const Du=(t,e)=>Vu(t,e)+"/v2/logs";function Nu(){return Nu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Nu.apply(this,arguments)}class Iu extends Pu{constructor({appID:t,userID:e,embraceDataURL:n}){super(Nu({},$u,{headers:Bu(t,e),url:Du(t,n)}))}}function Mu(){return Mu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mu.apply(this,arguments)}class ku extends xu{constructor(t){super(sc(Mu({},t,{compression:"gzip"}),Ou))}}const Uu=(t,e)=>Vu(t,e)+"/v2/spans";function Fu(){return Fu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fu.apply(this,arguments)}class ju extends ku{constructor({appID:t,userID:e,embraceDataURL:n}){super(Fu({},$u,{headers:Bu(t,e),url:Uu(t,n)}))}}const Bu=(t,e)=>({"X-EM-AID":t,"X-EM-DID":e}),Vu=(t,e)=>e||`https://a-${t}.data.emb-api.com`,$u={compression:"gzip",keepalive:!0,concurrencyLimit:5,timeoutMillis:3e4};class zu extends Error{constructor(t,e,n){super(t),this.name="OTLPExporterError",this.data=n,this.code=e}}function Hu(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class qu{pushPromise(t){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(t);const e=()=>{const e=this._sendingPromises.indexOf(t);this._sendingPromises.splice(e,1)};t.then(e,e)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}awaitAll(){return(t=function*(){yield Promise.all(this._sendingPromises)},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Hu(s,r,i,o,a,"next",t)}function a(t){Hu(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}constructor(t){this._sendingPromises=[],this._concurrencyLimit=t}}function Gu(t){return new qu(t.concurrencyLimit)}function Ku(){return{handleResponse(t){null!=t&&function(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}(t)&&null!=t.partialSuccess&&0!==Object.keys(t.partialSuccess).length&&Vt.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}}}function Wu(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class Qu{export(t,e){if(this._diagLogger.debug("items to be sent",t),this._promiseQueue.hasReachedLimit())return void e({code:In.FAILED,error:new Error("Concurrent export limit reached")});const n=this._serializer.serializeRequest(t);null!=n?this._promiseQueue.pushPromise(this._transport.send(n,this._timeout).then(t=>{if("success"!==t.status)"failure"===t.status&&t.error?e({code:In.FAILED,error:t.error}):"retryable"===t.status?e({code:In.FAILED,error:new zu("Export failed with retryable status")}):e({code:In.FAILED,error:new zu("Export failed with unknown error")});else{if(null!=t.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(t.data))}catch(e){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",e,t.data)}e({code:In.SUCCESS})}},t=>e({code:In.FAILED,error:t}))):e({code:In.FAILED,error:new Error("Nothing to send")})}forceFlush(){return this._promiseQueue.awaitAll()}shutdown(){return(t=function*(){this._diagLogger.debug("shutdown started"),yield this.forceFlush(),this._transport.shutdown()},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Wu(s,r,i,o,a,"next",t)}function a(t){Wu(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}constructor(t,e,n,r,i){this._transport=t,this._serializer=e,this._responseHandler=n,this._promiseQueue=r,this._timeout=i,this._diagLogger=Vt.createComponentLogger({namespace:"OTLPExportDelegate"})}}function Xu(t,e,n){return r={transport:n,serializer:e,promiseHandler:Gu(t)},i={timeout:t.timeoutMillis},new Qu(r.transport,r.serializer,Ku(),r.promiseHandler,i.timeout);var r,i}function Ju(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Yu(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Ju(s,r,i,o,a,"next",t)}function a(t){Ju(s,r,i,o,a,"throw",t)}o(void 0)})}}function Zu(){return Zu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Zu.apply(this,arguments)}class tc{static _compressRequest(t){return Yu(function*(){const e=new CompressionStream("gzip"),n=e.writable.getWriter();n.write(t),n.close();const r=[],i=e.readable.getReader();let s=!1;for(;!s;){const t=yield i.read();t.value&&r.push(t.value),s=t.done}const o=new Uint8Array(r.reduce((t,e)=>t+e.length,0));let a=0;for(const t of r)o.set(t,a),a+=t.length;return o})()}send(t,e){return this._asyncSend(t,e)}shutdown(){}_asyncSend(t,e){return Yu(function*(){let n=t;const r=Zu({"Content-Type":"application/json"},this._config.headers);"gzip"===this._config.compression&&(n=yield tc._compressRequest(t),r["Content-Encoding"]="gzip",r["Content-Length"]=n.length.toString());try{return(yield fetch(this._config.url,{method:"POST",keepalive:!0,headers:r,body:n,signal:AbortSignal.timeout(e)})).ok?{status:"success"}:{status:"failure",error:new Error("Fetch request failed")}}catch(t){return{status:"failure",error:new Error("Fetch request errored")}}}).call(this)}constructor(t){this._config=t}}const ec=t=>new tc(t);function nc(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}const rc=()=>40*Math.random()-20;class ic{send(t,e){return(n=function*(){const n=this._perf.getNowMillis()+e;let r=yield this._transport.send(t,e),i=5,s=1e3;for(;"retryable"===r.status&&i>0;){i--;const e=Math.max(Math.min(s,5e3)+rc(),0);var o;s*=1.5;const a=null!=(o=r.retryInMillis)?o:e,u=n-this._perf.getNowMillis();if(a>u)return r;r=yield this._retry(t,u,a)}return r},function(){var t=this,e=arguments;return new Promise(function(r,i){var s=n.apply(t,e);function o(t){nc(s,r,i,o,a,"next",t)}function a(t){nc(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var n}shutdown(){this._transport.shutdown()}_retry(t,e,n){return new Promise((r,i)=>{setTimeout(()=>{this._transport.send(t,e).then(r,i)},n)})}constructor(t,e=new gr){this._transport=t,this._perf=e}}const sc=(t,e)=>{return Xu(t,e,(n={transport:ec(t)},new ic(n.transport,null!=(r=n.perf)?r:new gr)));var n,r};class oc{get diag(){return this._diag}get processorName(){return this._processorName}constructor({diag:t,processorName:e}){this._processorName=e,this._diag=null!=t?t:Vt.createComponentLogger({namespace:e})}}function ac(){return ac=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ac.apply(this,arguments)}class uc extends oc{forceFlush(){return this.diag.debug("forceFlush called for EmbraceSessionBatchedSpanProcessor. This is a no op"),Promise.resolve(void 0)}onEnd(t){if(this._shutdownOnce.isCalled)this.diag.debug("span ended after processor shutdown. Ignoring span.");else if((t=>t.attributes[He]===on.Session)(t))this.diag.debug("session span ended. Exporting all pending spans."),this._exportSpans([t,...this._pendingSpans]),this._pendingSpans=[];else{if(this.diag.debug("non-session span ended. Adding to pending spans queue."),this._limitManager.dropReadableSpan(t))return;this._pendingSpans.push(t)}}_exportSpans(t){pr._export(this._exporter,t).then(t=>{var e;t.code===In.FAILED&&this.diag.error(`spans failed to export: ${(null==(e=t.error)?void 0:e.message)||"unknown error"}`)}).catch(t=>{let e="unknown error";t&&t instanceof Error?e=t.message:"string"==typeof t&&(e=t),this.diag.error(`spans failed to export: ${e}`)})}onStart(){}getPendingSpansCount(){return this._pendingSpans.length}storePendingSpans(t,e){this._spanStorage.storePendingSpans(t,e,this._pendingSpans)}clearStoredSpans(t){this._spanStorage.clearStoredSpans(t)}shutdown(){return this._shutdownOnce.call()}constructor(t){var{exporter:e,limitManager:n,storage:r=window.localStorage,storedSpansExpireTimeoutMS:i}=t,s=function(t,e){if(null==t)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,["exporter","limitManager","storage","storedSpansExpireTimeoutMS"]);super(ac({},s,{processorName:"EmbraceSessionBatchedSpanProcessor"})),this._pendingSpans=[],this._shutdown=()=>(this._spanStorage.destroy(),this._exporter.shutdown()),this._exporter=e,this._shutdownOnce=new hr(this._shutdown,this),this._limitManager=n,this._spanStorage=new Gi({storage:r,diag:s.diag,onExpiredSpansExport:t=>{this._exportSpans(t)},storedSpansExpireTimeoutMS:i})}}class cc{forceFlush(){return Promise.resolve(void 0)}onEmit(t){t.setAttributes({[Yi]:pn(),[Zi]:this._spanSessionManager.getSessionId()})}shutdown(){return Promise.resolve(void 0)}constructor({spanSessionManager:t}){this._spanSessionManager=t}}const lc=/.+:\/\/.+/;class dc{forceFlush(){return Promise.resolve(void 0)}onEnd(t){var e,n,r,i,s,o,a,u,c;(t=>{if((t.attributes[De]||t.attributes[Ae])&&("number"==typeof t.attributes[Ie]||"number"==typeof t.attributes[Ce])){var e;const n=null!=(e=t.attributes[$e])?e:t.attributes[Le];return!(!n||"string"!=typeof n||!lc.exec(n))}return!1})(t)&&(t.attributes[He]=on.Network,null!=(e=t.attributes)[n=$e]||(e[n]=t.attributes[Le]),null!=(r=t.attributes)[i=Ie]||(r[i]=t.attributes[Ce]),null!=(s=t.attributes)[o=De]||(s[o]=t.attributes[Ae]),null!=(a=t.attributes)[u=Ji]||(a[u]=t.attributes["http.response_content_length"]),null!=(c=t.attributes)["http.request.body.size"]||(c["http.request.body.size"]=t.attributes["http.request_content_length"]))}onStart(){}shutdown(){return Promise.resolve(void 0)}}class hc{forceFlush(){return Promise.resolve(void 0)}onEmit(t){t.attributes[He]||t.setAttribute(He,on.SystemLog),t.setAttribute($e,this._urlDocument.URL)}shutdown(){return Promise.resolve(void 0)}constructor({urlDocument:t=window.document}={}){this._urlDocument=t}}class pc{forceFlush(){return Promise.resolve(void 0)}onEmit(t){this._userManager.getUserId()&&t.setAttributes({[ts]:this._userManager.getUserId()})}shutdown(){return Promise.resolve(void 0)}constructor({userManager:t}){this._userManager=t}}class gc{forceFlush(){return Promise.resolve(void 0)}onEnd(t){const e=this._userManager.getUserId();e&&(t.attributes[ts]=e)}onStart(){}shutdown(){return Promise.resolve(void 0)}constructor({userManager:t}){this._userManager=t}}class mc{forceFlush(){return Promise.resolve(void 0)}onEmit(t){this._attributeScrubbers.forEach(e=>{const n=t.attributes[e.key];n&&"string"==typeof n&&t.setAttribute(e.key,e.scrub(n))})}shutdown(){return Promise.resolve(void 0)}constructor({attributeScrubbers:t}){this._attributeScrubbers=t}}class fc{forceFlush(){return Promise.resolve(void 0)}onEnd(t){this._attributeScrubbers.forEach(e=>{const n=t.attributes[e.key];n&&"string"==typeof n&&(t.attributes[e.key]=e.scrub(n))})}onStart(){}shutdown(){return Promise.resolve(void 0)}constructor({attributeScrubbers:t}){this._attributeScrubbers=t}}function _c(){return _c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_c.apply(this,arguments)}const vc=(t={},{logManager:e,spanSessionManager:n,embraceSpanProcessor:r}={})=>{var i,s,o,a,u,c;const l=[new $s(t["session-on-load"]),new js(t["session-visibility"],r),new Vs(t["session-activity"]),new Hs(t["session-timeout"])];(null==(i=t.omit)?void 0:i.has("exception"))||l.push(new qs(t.exception)),(null==(s=t.omit)?void 0:s.has("click"))||l.push(new Ks(t.click)),(null==(o=t.omit)?void 0:o.has("web-vital"))||l.push(new Bo(t["web-vital"])),(null==(a=t.omit)?void 0:a.has("document-load"))||l.push(new Ja(t["document-load"])),(null==(u=t.omit)?void 0:u.has("@opentelemetry/instrumentation-fetch"))||l.push(new Ta(_c({},t.network,t["@opentelemetry/instrumentation-fetch"]))),(null==(c=t.omit)?void 0:c.has("@opentelemetry/instrumentation-xml-http-request"))||l.push(new Ha(_c({},t.network,t["@opentelemetry/instrumentation-xml-http-request"])));for(const t of l)t instanceof Us&&(n&&t.setSessionManager(n),e&&t.setLogManager(e));return l};function bc(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Sc(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){bc(s,r,i,o,a,"next",t)}function a(t){bc(s,r,i,o,a,"throw",t)}o(void 0)})}}class yc{forceFlush(){return Sc(function*(){})()}onStart(t,e){var n;const r=null==(n=this._sessionIdProvider)?void 0:n.getSessionId();r&&t.setAttribute("session.id",r)}onEnd(t){}shutdown(){return Sc(function*(){})()}constructor(t){this._sessionIdProvider=t}}const Ec=new class{constructor({diagLogger:t=Vt.createComponentLogger({namespace:"embrace-registry"})}={}){this._sdk=null,this.register=t=>{null!==this._sdk&&this._diag.warn("previously registered sdk will be overwritten"),this._sdk=t},this.clear=()=>{null===this._sdk&&this._diag.warn("sdk already cleared, this is a no-op"),this._sdk=null},this.registered=()=>this._sdk,this._diag=t}},Tc=/\/\/(.+):(.+)@(.+)\//,wc=["AWSAccessKeyId","Signature","sig","`X-Goog-Signature","password","auth","pw","token"],Ac=({value:t,queryParamRegex:e,scrubPath:n,scrubQuery:r})=>{let i=t;return n&&(i=i.replace(Tc,"//REDACTED:REDACTED@$3/")),r&&(i=i.replaceAll(e,"$1$2=REDACTED")),i},Lc=t=>{const e=[...wc,...t||[]],n=new RegExp(`(^|&|\\?)(${e.join("|")})=[^&]+`,"g");return[{key:$e,scrub:t=>Ac({value:t,queryParamRegex:n,scrubPath:!0,scrubQuery:!0})},{key:Le,scrub:t=>Ac({value:t,queryParamRegex:n,scrubPath:!0,scrubQuery:!0})},{key:"url.path",scrub:t=>Ac({value:t,queryParamRegex:n,scrubPath:!0,scrubQuery:!1})},{key:"url.query",scrub:t=>Ac({value:t,queryParamRegex:n,scrubPath:!1,scrubQuery:!0})}]};class Cc extends zn{inject(t,e,n){super.inject(t,e,n);const r=re.getSpan(t);if(r){const t=st.get(e,"traceparent");t&&r.setAttribute("emb.w3c_traceparent",t)}}}function Rc(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}const Oc=({registerGlobally:t})=>{const e=new Ls;return t&&pe.setGlobalUserManager(e),e},xc=({limitManager:t,registerGlobally:e})=>{const n=new ms({limitManager:t});return e&&u.setGlobalSessionManager(n),n},Pc=({resource:t,spanSessionManager:e,userManager:n,spanExporters:r,spanProcessors:i=[],propagator:s=null,contextManager:o=null,attributeScrubbers:a,registerGlobally:u,embraceSpanProcessor:c})=>{const l=[...i,(d=e,new yc(d)),new dc,new gc({userManager:n}),new fc({attributeScrubbers:a})];var d;null==r||r.forEach(t=>{l.push(new fi(t))}),c&&l.push(c);const h=new Bi({resource:t,spanProcessors:l,spanLimits:{attributeCountLimit:2*vs.maxAllowed.session_property,attributePerEventCountLimit:20,eventCountLimit:2*vs.maxAllowed.breadcrumb,attributeValueLengthLimit:1024}}),p=new Es({tracerProvider:u?void 0:h});return u&&(ue.setGlobalTraceManager(p),h.register({contextManager:o||new wi,propagator:s})),{tracerProvider:h,embraceTraceManager:p}},Dc=({resource:t,userManager:e,logExporters:n,logProcessors:r,spanSessionManager:s,limitManager:o,attributeScrubbers:a,registerGlobally:u,embraceLogProcessor:c})=>{const l=[...r,new cc({spanSessionManager:s}),new hc,new pc({userManager:e}),new mc({attributeScrubbers:a})];null==n||n.forEach(t=>{l.push(new cu(t))}),c&&l.push(c);const d=new ou({resource:t,processors:l}),h=new Xi({spanSessionManager:s,limitManager:o,loggerProvider:u?void 0:d});return u&&(we.setGlobalLoggerProvider(d),i.setGlobalLogManager(h)),{loggerProvider:d,embraceLogManager:h}};return t.getNavigationInstrumentation=(t={})=>(Ka||(Ka=new Ga(t)),Ka),t.initSDK=({appID:e,appVersion:n,resource:r=hs(),spanExporters:i=[],logExporters:s=[],spanProcessors:o=[],propagator:a=null,defaultInstrumentationConfig:u,instrumentations:c=[],contextManager:l=null,logProcessors:d=[],attributeScrubbers:h=[],enableDefaultAttributeScrubbing:p=!0,additionalQueryParamsToScrub:g=[],logLevel:m=t.DiagLogLevel.ERROR,embraceDataURL:f,embraceConfigURL:_,diagLogger:v=Vt.createComponentLogger({namespace:"embrace-sdk"}),dynamicSDKConfigManager:b,dynamicSDKConfig:S,registerGlobally:y=!0,blockNetworkSpanForwarding:E=!1}={appID:""})=>{try{const t=new gr,w=t.getNowMillis();if(y){const t=Ec.registered();if(null!==t)return v.warn("SDK has already been successfully initialized, skipping this invocation of initSDK"),t}Vt.setLogger(new j,{logLevel:m});const A=r.merge((({diagLogger:t,appVersion:e,pageSessionStorage:n})=>{const r=null!=e?e:"EmbIOAppVersionX.X.X".trim();return ds({[Ue]:ss,[Be]:ss,app_version:r,app_framework:1,sdk_version:is,[Ve]:is,sdk_simple_version:1,sdk_platform:"web",[Fe]:"webjs",[Ze]:as(n,t),[ze]:window.navigator.userAgent,screen_resolution:`${window.screen.width}x${window.screen.height}`})})({diagLogger:v,appVersion:n,pageSessionStorage:window.sessionStorage})),L=!!e&&(t=>{if(void 0===t)throw new Error("appID is required when using Embrace exporter");if(5!==t.length)throw new Error("appID should be 5 characters long");return!0})(e);if(!L&&!s.length&&!i.length)throw new Error("when the embrace appID is omitted then at least one logExporter or spanExporter must be set");const C=Oc({registerGlobally:y}),R=C.getEmbraceUserId();if(L&&!R)throw new Error("userID is required when using Embrace exporter");const O=null!=b?b:new Ns({appID:e,appVersion:n,embraceConfigURL:_,defaultConfig:S,deviceId:R});O.refreshRemoteConfig();const x=new Is({dynamicConfigManager:O,deviceId:R,blockNetworkSpanForwarding:E});if(!x.isSDKEnabled())return v.debug("SDK is disabled, skipping initialization."),!1;const P=(({diag:t,featureManager:e,registerGlobally:n,propagator:r,defaultInstrumentationConfig:i})=>{var s;if(!e.isNetworkSpanForwardingEnabled())return!1;const o=[];return n||o.push("Network span forwarding cannot be used when `registerGlobally` is set to false. Turning off network span forwarding."),r&&o.push("Network span forwarding cannot be used alongside a custom `propagator`. Turning off network span forwarding."),(null==i||null==(s=i.omit)?void 0:s.has("@opentelemetry/instrumentation-xml-http-request"))&&i.omit.has("@opentelemetry/instrumentation-fetch")&&o.push("Network span forwarding cannot be used when both '@opentelemetry/instrumentation-xml-http-request' and '@opentelemetry/instrumentation-fetch' are omitted. Turning off network span forwarding."),o.forEach(e=>{t.warn(e)}),0===o.length})({featureManager:x,diag:v,registerGlobally:y,defaultInstrumentationConfig:u,propagator:a}),D=new _s(vs),N=[...p?Lc(g):[],...h],I=xc({limitManager:D,registerGlobally:y});let M,k;var T;if(L)M=new uc({exporter:new ju({appID:e,embraceDataURL:f,userID:R}),limitManager:D,storedSpansExpireTimeoutMS:null==u||null==(T=u["session-visibility"])?void 0:T.storedSpansExpireTimeoutMS}),k=new cu(new Iu({appID:e,embraceDataURL:f,userID:R}));const{tracerProvider:U,embraceTraceManager:F}=Pc({resource:A,spanSessionManager:I,userManager:C,spanExporters:i,spanProcessors:o,propagator:P?new Cc:a,contextManager:l,attributeScrubbers:N,registerGlobally:y,embraceSpanProcessor:M});I.setTracerProvider(U);const{loggerProvider:B,embraceLogManager:V}=Dc({resource:A,userManager:C,logExporters:s,logProcessors:d,spanSessionManager:I,limitManager:D,attributeScrubbers:N,registerGlobally:y,embraceLogProcessor:k});Vo(y?{instrumentations:[vc(u,{embraceSpanProcessor:M}),...c]}:{tracerProvider:U,loggerProvider:B,instrumentations:[vc(u,{logManager:V,spanSessionManager:I,embraceSpanProcessor:M}),...c]}),v.info("successfully initialized the SDK");const $={setDynamicConfig:t=>{O.setConfig(t)},flush:()=>{return(t=function*(){yield U.forceFlush(),yield B.forceFlush()},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Rc(s,r,i,o,a,"next",t)}function a(t){Rc(s,r,i,o,a,"throw",t)}o(void 0)})})();var t},log:V,trace:F,session:I,user:C};return y&&Ec.register($),I.recordSDKStartupDuration(t.getNowMillis()-w),$}catch(t){const e=t instanceof Error?t.message:"Unknown error.";return v.error(`failed to initialize the SDK: ${e}`),!1}},t.log=i,t.session=u,t.trace=ue,t.user=pe,t}({});window.EmbraceWebSdk=EmbraceWebSdk;
//# sourceMappingURL=bundle.js.map
