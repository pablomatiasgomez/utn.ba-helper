/**
 * Skipped minification because the original files appears to be already minified.
 * Original file: /npm/@embrace-io/web-sdk@2.0.1/build/iife/bundle.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var EmbraceWebSdk=function(t){"use strict";const e=new class{logException(t,e){}message(t,e,n){}};class n{getDelegate(){var t;return null!=(t=this._delegate)?t:e}setDelegate(t){this._delegate=t}logException(t,e){this.getDelegate().logException(t,e)}message(t,e,n){this.getDelegate().message(t,e,n)}}class r{static getInstance(){return r._instance||(r._instance=new r({proxyLogManager:new n})),r._instance}setGlobalLogManager(t){this._proxyLogManager.setDelegate(t)}logException(t,e){this.getLogManager().logException(t,e)}message(t,e,n){this.getLogManager().message(t,e,n)}constructor({proxyLogManager:t}){this.getLogManager=()=>this._proxyLogManager,this._proxyLogManager=t}}const i=r.getInstance();const s=new class{addBreadcrumb(t){}addProperty(t,e,n){}removeProperty(t){}endSessionSpan(){}endSessionSpanInternal(){}getSessionSpan(){return null}getSessionStartTime(){return null}startSessionSpan(){}addSessionStartedListener(t){return()=>{}}addSessionEndedListener(t){return()=>{}}constructor(){this.getSessionId=()=>null}};class o{getDelegate(){var t;return null!=(t=this._delegate)?t:s}setDelegate(t){this._delegate=t}addBreadcrumb(t){this.getDelegate().addBreadcrumb(t)}addProperty(t,e,n){this.getDelegate().addProperty(t,e,n)}removeProperty(t){this.getDelegate().removeProperty(t)}endSessionSpan(){this.getDelegate().endSessionSpan()}endSessionSpanInternal(t){this.getDelegate().endSessionSpanInternal(t)}getSessionId(){return this.getDelegate().getSessionId()}getSessionSpan(){return this.getDelegate().getSessionSpan()}getSessionStartTime(){return this.getDelegate().getSessionStartTime()}startSessionSpan(t){this.getDelegate().startSessionSpan(t)}addSessionStartedListener(t){return this.getDelegate().addSessionStartedListener(t)}addSessionEndedListener(t){return this.getDelegate().addSessionEndedListener(t)}}class a{static getInstance(){return a._instance||(a._instance=new a({proxySpanSessionManager:new o})),a._instance}setGlobalSessionManager(t){this._proxySpanSessionManager.setDelegate(t)}addBreadcrumb(t){this.getSpanSessionManager().addBreadcrumb(t)}addProperty(t,e,n){this.getSpanSessionManager().addProperty(t,e,n)}removeProperty(t){this.getSpanSessionManager().removeProperty(t)}endSessionSpan(){this.getSpanSessionManager().endSessionSpan()}endSessionSpanInternal(t){this.getSpanSessionManager().endSessionSpanInternal(t)}getSessionId(){return this.getSpanSessionManager().getSessionId()}getSessionSpan(){return this.getSpanSessionManager().getSessionSpan()}getSessionStartTime(){return this.getSpanSessionManager().getSessionStartTime()}startSessionSpan(t){this.getSpanSessionManager().startSessionSpan(t)}addSessionStartedListener(t){return this.getSpanSessionManager().addSessionStartedListener(t)}addSessionEndedListener(t){return this.getSpanSessionManager().addSessionEndedListener(t)}constructor({proxySpanSessionManager:t}){this.getSpanSessionManager=()=>this._proxySpanSessionManager,this._proxySpanSessionManager=t}}const u=a.getInstance();var c="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},l="1.9.0",h=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var d=function(t){var e=new Set([t]),n=new Set,r=t.match(h);if(!r)return function(){return!1};var i=+r[1],s=+r[2],o=+r[3];if(null!=r[4])return function(e){return e===t};function a(t){return n.add(t),!1}function u(t){return e.add(t),!0}return function(t){if(e.has(t))return!0;if(n.has(t))return!1;var r=t.match(h);if(!r)return a(t);var c=+r[1],l=+r[2],d=+r[3];return null!=r[4]||i!==c?a(t):0===i?s===l&&o<=d?u(t):a(t):s<=l?u(t):a(t)}}(l),p=l.split(".")[0],g=Symbol.for("opentelemetry.js.api."+p),m=c;function f(t,e,n,r){var i;void 0===r&&(r=!1);var s=m[g]=null!==(i=m[g])&&void 0!==i?i:{version:l};if(!r&&s[t]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return n.error(o.stack||o.message),!1}if(s.version!==l){o=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+l);return n.error(o.stack||o.message),!1}return s[t]=e,n.debug("@opentelemetry/api: Registered a global for "+t+" v"+l+"."),!0}function _(t){var e,n,r=null===(e=m[g])||void 0===e?void 0:e.version;if(r&&d(r))return null===(n=m[g])||void 0===n?void 0:n[t]}function v(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+l+".");var n=m[g];n&&delete n[t]}var b,S=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},y=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},T=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return E("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return E("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return E("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return E("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return E("verbose",this._namespace,t)},t}();function E(t,e,n){var r=_("diag");if(r)return n.unshift(e),r[t].apply(r,y([],S(n),!1))}t.DiagLogLevel=void 0,(b=t.DiagLogLevel||(t.DiagLogLevel={}))[b.NONE=0]="NONE",b[b.ERROR=30]="ERROR",b[b.WARN=50]="WARN",b[b.INFO=60]="INFO",b[b.DEBUG=70]="DEBUG",b[b.VERBOSE=80]="VERBOSE",b[b.ALL=9999]="ALL";var w=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},L=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},C=function(){function e(){function e(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_("diag");if(r)return r[t].apply(r,L([],w(e),!1))}}var n=this;n.setLogger=function(e,r){var i,s,o;if(void 0===r&&(r={logLevel:t.DiagLogLevel.INFO}),e===n){var a=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error(null!==(i=a.stack)&&void 0!==i?i:a.message),!1}"number"==typeof r&&(r={logLevel:r});var u=_("diag"),c=function(e,n){function r(t,r){var i=n[t];return"function"==typeof i&&e>=r?i.bind(n):function(){}}return e<t.DiagLogLevel.NONE?e=t.DiagLogLevel.NONE:e>t.DiagLogLevel.ALL&&(e=t.DiagLogLevel.ALL),n=n||{},{error:r("error",t.DiagLogLevel.ERROR),warn:r("warn",t.DiagLogLevel.WARN),info:r("info",t.DiagLogLevel.INFO),debug:r("debug",t.DiagLogLevel.DEBUG),verbose:r("verbose",t.DiagLogLevel.VERBOSE)}}(null!==(s=r.logLevel)&&void 0!==s?s:t.DiagLogLevel.INFO,e);if(u&&!r.suppressOverrideMessage){var l=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+l),c.warn("Current logger will overwrite one already registered from "+l)}return f("diag",c,n,!0)},n.disable=function(){v("diag",n)},n.createComponentLogger=function(t){return new T(t)},n.verbose=e("verbose"),n.debug=e("debug"),n.info=e("info"),n.warn=e("warn"),n.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),R=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},A=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},x=function(){function t(t){this._entries=t?new Map(t):new Map}return t.prototype.getEntry=function(t){var e=this._entries.get(t);if(e)return Object.assign({},e)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(t){var e=R(t,2);return[e[0],e[1]]})},t.prototype.setEntry=function(e,n){var r=new t(this._entries);return r._entries.set(e,n),r},t.prototype.removeEntry=function(e){var n=new t(this._entries);return n._entries.delete(e),n},t.prototype.removeEntries=function(){for(var e,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var s=new t(this._entries);try{for(var o=A(r),a=o.next();!a.done;a=o.next()){var u=a.value;s._entries.delete(u)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}(),P=Symbol("BaggageEntryMetadata"),O=C.instance();function D(t){return void 0===t&&(t={}),new x(new Map(Object.entries(t)))}function M(t){return Symbol.for(t)}var N,I,k=function t(e){var n=this;n._currentContext=e?new Map(e):new Map,n.getValue=function(t){return n._currentContext.get(t)},n.setValue=function(e,r){var i=new t(n._currentContext);return i._currentContext.set(e,r),i},n.deleteValue=function(e){var r=new t(n._currentContext);return r._currentContext.delete(e),r}},U=new k,F=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],j=function(){function t(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(console){var r=console[t];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,e)}}}for(var e=0;e<F.length;e++)this[F[e].n]=t(F[e].c)},B=(N=function(t,e){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},N(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}N(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),H=function(){function t(){}return t.prototype.createGauge=function(t,e){return Z},t.prototype.createHistogram=function(t,e){return tt},t.prototype.createCounter=function(t,e){return Y},t.prototype.createUpDownCounter=function(t,e){return et},t.prototype.createObservableGauge=function(t,e){return rt},t.prototype.createObservableCounter=function(t,e){return nt},t.prototype.createObservableUpDownCounter=function(t,e){return it},t.prototype.addBatchObservableCallback=function(t,e){},t.prototype.removeBatchObservableCallback=function(t){},t}(),V=function(){},$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.add=function(t,e){},e}(V),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.add=function(t,e){},e}(V),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.record=function(t,e){},e}(V),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.record=function(t,e){},e}(V),W=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.removeCallback=function(t){},t}(),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e}(W),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e}(W),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e}(W),J=new H,Y=new $,Z=new q,tt=new G,et=new z,nt=new Q,rt=new K,it=new X,st={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},ot={set:function(t,e,n){null!=t&&(t[e]=n)}},at=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},ut=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},ct=function(){function t(){}return t.prototype.active=function(){return U},t.prototype.with=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return e.call.apply(e,ut([n],at(r),!1))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),lt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o},ht=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},dt="context",pt=new ct,gt=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return f(dt,t,C.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,n){for(var r,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(r=this._getContextManager()).with.apply(r,ht([t,e,n],lt(i),!1))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return _(dt)||pt},t.prototype.disable=function(){this._getContextManager().disable(),v(dt,C.instance())},t}();!function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"}(I||(I={}));var mt="0000000000000000",ft="00000000000000000000000000000000",_t={traceId:ft,spanId:mt,traceFlags:I.NONE},vt=function(){function t(t){void 0===t&&(t=_t),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.addLink=function(t){return this},t.prototype.addLinks=function(t){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),bt=M("OpenTelemetry Context Key SPAN");function St(t){return t.getValue(bt)||void 0}function yt(){return St(gt.getInstance().active())}function Tt(t,e){return t.setValue(bt,e)}function Et(t){return t.deleteValue(bt)}function wt(t,e){return Tt(t,new vt(e))}function Lt(t){var e;return null===(e=St(t))||void 0===e?void 0:e.spanContext()}var Ct=/^([0-9a-f]{32})$/i,Rt=/^[0-9a-f]{16}$/i;function At(t){return Ct.test(t)&&t!==ft}function xt(t){return At(t.traceId)&&(e=t.spanId,Rt.test(e)&&e!==mt);var e}function Pt(t){return new vt(t)}var Ot=gt.getInstance(),Dt=function(){function t(){}return t.prototype.startSpan=function(t,e,n){if(void 0===n&&(n=Ot.active()),Boolean(null==e?void 0:e.root))return new vt;var r,i=n&&Lt(n);return"object"==typeof(r=i)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&xt(i)?new vt(i):new vt},t.prototype.startActiveSpan=function(t,e,n,r){var i,s,o;if(!(arguments.length<2)){2===arguments.length?o=e:3===arguments.length?(i=e,o=n):(i=e,s=n,o=r);var a=null!=s?s:Ot.active(),u=this.startSpan(t,i,a),c=Tt(a,u);return Ot.with(c,o,void 0,u)}},t}();var Mt,Nt,It,kt=new Dt,Ut=function(){function t(t,e,n,r){this._provider=t,this.name=e,this.version=n,this.options=r}return t.prototype.startSpan=function(t,e,n){return this._getTracer().startSpan(t,e,n)},t.prototype.startActiveSpan=function(t,e,n,r){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):kt},t}(),Ft=new(function(){function t(){}return t.prototype.getTracer=function(t,e,n){return new Dt},t}()),jt=function(){function t(){}return t.prototype.getTracer=function(t,e,n){var r;return null!==(r=this.getDelegateTracer(t,e,n))&&void 0!==r?r:new Ut(this,t,e,n)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Ft},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(t,e,n)},t}();!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Mt||(Mt={})),function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}(Nt||(Nt={})),function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(It||(It={}));var Bt=gt.getInstance(),Ht=C.instance(),Vt=new(function(){function t(){}return t.prototype.getMeter=function(t,e,n){return J},t}()),$t="metrics",zt=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return f($t,t,C.instance())},t.prototype.getMeterProvider=function(){return _($t)||Vt},t.prototype.getMeter=function(t,e,n){return this.getMeterProvider().getMeter(t,e,n)},t.prototype.disable=function(){v($t,C.instance())},t}().getInstance(),qt=function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}(),Gt=M("OpenTelemetry Baggage Key");function Wt(t){return t.getValue(Gt)||void 0}function Qt(){return Wt(gt.getInstance().active())}function Kt(t,e){return t.setValue(Gt,e)}function Xt(t){return t.deleteValue(Gt)}var Jt="propagation",Yt=new qt,Zt=function(){function t(){this.createBaggage=D,this.getBaggage=Wt,this.getActiveBaggage=Qt,this.setBaggage=Kt,this.deleteBaggage=Xt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return f(Jt,t,C.instance())},t.prototype.inject=function(t,e,n){return void 0===n&&(n=ot),this._getGlobalPropagator().inject(t,e,n)},t.prototype.extract=function(t,e,n){return void 0===n&&(n=st),this._getGlobalPropagator().extract(t,e,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){v(Jt,C.instance())},t.prototype._getGlobalPropagator=function(){return _(Jt)||Yt},t}(),te=Zt.getInstance(),ee="trace",ne=function(){function t(){this._proxyTracerProvider=new jt,this.wrapSpanContext=Pt,this.isSpanContextValid=xt,this.deleteSpan=Et,this.getSpan=St,this.getActiveSpan=yt,this.getSpanContext=Lt,this.setSpan=Tt,this.setSpanContext=wt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=f(ee,this._proxyTracerProvider,C.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return _(ee)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){v(ee,C.instance()),this._proxyTracerProvider=new jt},t}(),re=ne.getInstance();class ie{fail(t){}spanContext(){return this._spanContext}setAttribute(t,e){return this}setAttributes(t){return this}removeAttribute(t){return this}addEvent(t,e,n){return this}addLink(t){return this}addLinks(t){return this}setStatus(t){return this}updateName(t){return this}end(t){}isRecording(){return!1}recordException(t,e){}constructor(t=_t){this.attributes={},this._spanContext=t}}const se=new class{startSpan(t,e){return new ie}setSpan(t,e){return U}getSpan(t){}};class oe{getDelegate(){var t;return null!=(t=this._delegate)?t:se}setDelegate(t){this._delegate=t}startSpan(t,e,n){return this.getDelegate().startSpan(t,e,n)}setSpan(t,e){return this.getDelegate().setSpan(t,e)}getSpan(t){return this.getDelegate().getSpan(t)}}class ae{static getInstance(){return ae._instance||(ae._instance=new ae({proxyTraceManager:new oe})),ae._instance}setGlobalTraceManager(t){this._proxyTraceManager.setDelegate(t)}startSpan(t,e,n){return this.getTraceManager().startSpan(t,e,n)}setSpan(t,e){return this.getTraceManager().setSpan(t,e)}getSpan(t){return this.getTraceManager().getSpan(t)}constructor({proxyTraceManager:t}){this.getTraceManager=()=>this._proxyTraceManager,this._proxyTraceManager=t}}const ue=ae.getInstance(),ce="enduser.pseudo.id";const le=new class{getEmbraceUserId(){return""}getUserId(){return null}setUserId(){}clearUserId(){}};class he{getDelegate(){var t;return null!=(t=this._delegate)?t:le}setDelegate(t){this._delegate=t}getEmbraceUserId(){return this.getDelegate().getEmbraceUserId()}getUserId(){return this.getDelegate().getUserId()}setUserId(t){this.getDelegate().setUserId(t)}clearUserId(){this.getDelegate().clearUserId()}}class de{static getInstance(){return de._instance||(de._instance=new de({proxyUserManager:new he})),de._instance}getUserManager(){return this._proxyUserManager}setGlobalUserManager(t){this._proxyUserManager.setDelegate(t)}getEmbraceUserId(){return this.getUserManager().getEmbraceUserId()}getUserId(){return this.getUserManager().getUserId()}setUserId(t){this.getUserManager().setUserId(t)}clearUserId(){this.getUserManager().clearUserId()}constructor({proxyUserManager:t}){this._proxyUserManager=t}}const pe=de.getInstance();var ge;!function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TRACE=1]="TRACE",t[t.TRACE2=2]="TRACE2",t[t.TRACE3=3]="TRACE3",t[t.TRACE4=4]="TRACE4",t[t.DEBUG=5]="DEBUG",t[t.DEBUG2=6]="DEBUG2",t[t.DEBUG3=7]="DEBUG3",t[t.DEBUG4=8]="DEBUG4",t[t.INFO=9]="INFO",t[t.INFO2=10]="INFO2",t[t.INFO3=11]="INFO3",t[t.INFO4=12]="INFO4",t[t.WARN=13]="WARN",t[t.WARN2=14]="WARN2",t[t.WARN3=15]="WARN3",t[t.WARN4=16]="WARN4",t[t.ERROR=17]="ERROR",t[t.ERROR2=18]="ERROR2",t[t.ERROR3=19]="ERROR3",t[t.ERROR4=20]="ERROR4",t[t.FATAL=21]="FATAL",t[t.FATAL2=22]="FATAL2",t[t.FATAL3=23]="FATAL3",t[t.FATAL4=24]="FATAL4"}(ge||(ge={}));class me{emit(t){}}const fe=new me;const _e=new class{getLogger(t,e,n){return new me}};class ve{emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;const t=this._provider.getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):fe}constructor(t,e,n,r){this._provider=t,this.name=e,this.version=n,this.options=r}}class be{getLogger(t,e,n){var r;return null!==(r=this.getDelegateLogger(t,e,n))&&void 0!==r?r:new ve(this,t,e,n)}getDelegate(){var t;return null!==(t=this._delegate)&&void 0!==t?t:_e}setDelegate(t){this._delegate=t}getDelegateLogger(t,e,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getLogger(t,e,n)}}const Se="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},ye=Symbol.for("io.opentelemetry.js.api.logs"),Te=Se;class Ee{static getInstance(){return this._instance||(this._instance=new Ee),this._instance}setGlobalLoggerProvider(t){return Te[ye]?this.getLoggerProvider():(Te[ye]=(e=1,n=t,r=_e,t=>t===e?n:r),this._proxyLoggerProvider.setDelegate(t),t);var e,n,r}getLoggerProvider(){var t,e;return null!==(e=null===(t=Te[ye])||void 0===t?void 0:t.call(Te,1))&&void 0!==e?e:this._proxyLoggerProvider}getLogger(t,e,n){return this.getLoggerProvider().getLogger(t,e,n)}disable(){delete Te[ye],this._proxyLoggerProvider=new be}constructor(){this._proxyLoggerProvider=new be}}const we=Ee.getInstance(),Le="http.method",Ce="http.url",Re="http.status_code",Ae="error.type",xe="exception.message",Pe="exception.stacktrace",Oe="exception.type",De="http.request.method",Me="http.request.method_original",Ne="http.response.status_code",Ie="server.address",ke="server.port",Ue="service.name",Fe="telemetry.sdk.language",je="telemetry.sdk.name",Be="telemetry.sdk.version",He="url.full",Ve="user_agent.original",$e="emb.type",ze="emb.state",qe="emb.cold_start",Ge="emb.session_number",We="emb.sdk_startup_duration",Qe="emb.properties.",Ke="emb.session_end_type",Xe="emb.stacktrace.js",Je="emb.exception_handling",Ye="emb.app_instance_id",Ze="emb.js_file_bundle_ids",tn="view.name";var en=function(t){return t.Session="ux.session",t.View="ux.view",t.Network="perf.network_request",t.Perf="perf",t.SystemLog="sys.log",t.SystemException="sys.exception",t.WebVital="ux.web_vital",t.ResourceFetch="ux.resource_fetch",t.DocumentLoad="ux.document_load",t}({}),nn=function(t){return t.Foreground="foreground",t.Background="background",t}({});const rn=[];for(let t=0;t<256;++t)rn.push((t+256).toString(16).slice(1));let sn;const on=new Uint8Array(16);var an={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function un(t,e,n){if(an.randomUUID&&!t)return an.randomUUID();var r,i;const s=null!=(i=null!=(r=(t=t||{}).random)?r:null==t.rng?void 0:t.rng.call(t))?i:function(){if(!sn){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");sn=crypto.getRandomValues.bind(crypto)}return sn(on)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=15&s[6]|64,s[8]=63&s[8]|128,function(t,e=0){return(rn[t[e+0]]+rn[t[e+1]]+rn[t[e+2]]+rn[t[e+3]]+"-"+rn[t[e+4]]+rn[t[e+5]]+"-"+rn[t[e+6]]+rn[t[e+7]]+"-"+rn[t[e+8]]+rn[t[e+9]]+"-"+rn[t[e+10]]+rn[t[e+11]]+rn[t[e+12]]+rn[t[e+13]]+rn[t[e+14]]+rn[t[e+15]]).toLowerCase()}(s)}const cn=()=>un().replace(/-/g,"").toUpperCase(),ln=({target:t,events:e,callback:n})=>{e.forEach(e=>{t.addEventListener(e,n)})},hn=({target:t,events:e,callback:n})=>{e.forEach(e=>{t.removeEventListener(e,n)})},dn=t=>{const e=t.slice(-6),n=Math.pow(16,6)-1;return parseInt(e,16)/n*100},pn=M("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function gn(t){return t.setValue(pn,!0)}function mn(t){return!0===t.getValue(pn)}const fn="baggage";function _n(t){const e=t.split(";");if(e.length<=0)return;const n=e.shift();if(!n)return;const r=n.indexOf("=");if(r<=0)return;const i=decodeURIComponent(n.substring(0,r).trim()),s=decodeURIComponent(n.substring(r+1).trim());let o;var a;return e.length>0&&("string"!=typeof(a=e.join(";"))&&(O.error("Cannot create baggage metadata from unknown type: "+typeof a),a=""),o={__TYPE__:P,toString:function(){return a}}),{key:i,value:s,metadata:o}}class vn{inject(t,e,n){const r=te.getBaggage(t);if(!r||mn(t))return;const i=function(t){return t.getAllEntries().map(([t,e])=>{let n=`${encodeURIComponent(t)}=${encodeURIComponent(e.value)}`;return void 0!==e.metadata&&(n+=";"+e.metadata.toString()),n})}(r).filter(t=>t.length<=4096).slice(0,180),s=function(t){return t.reduce((t,e)=>{const n=`${t}${""!==t?",":""}${e}`;return n.length>8192?t:n},"")}(i);s.length>0&&n.set(e,fn,s)}extract(t,e,n){const r=n.get(e,fn),i=Array.isArray(r)?r.join(","):r;if(!i)return t;const s={};if(0===i.length)return t;return i.split(",").forEach(t=>{const e=_n(t);if(e){const t={value:e.value};e.metadata&&(t.metadata=e.metadata),s[e.key]=t}}),0===Object.entries(s).length?t:te.setBaggage(t,te.createBaggage(s))}fields(){return[fn]}}function bn(t){const e={};if("object"!=typeof t||null==t)return e;for(const[n,r]of Object.entries(t))Sn(n)?yn(r)?Array.isArray(r)?e[n]=r.slice():e[n]=r:Ht.warn(`Invalid attribute value set for key: ${n}`):Ht.warn(`Invalid attribute key: ${n}`);return e}function Sn(t){return"string"==typeof t&&t.length>0}function yn(t){return null==t||(Array.isArray(t)?function(t){let e;for(const n of t)if(null!=n){if(!e){if(Tn(n)){e=typeof n;continue}return!1}if(typeof n!==e)return!1}return!0}(t):Tn(t))}function Tn(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}let En=t=>{Ht.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){const e={};let n=t;for(;null!==n;)Object.getOwnPropertyNames(n).forEach(t=>{if(e[t])return;const r=n[t];r&&(e[t]=String(r))}),n=Object.getPrototypeOf(n);return e}(t))}(t))};function wn(t){try{En(t)}catch(t){}}const Ln="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Cn=performance,Rn="process.runtime.name",An={[je]:"opentelemetry",[Rn]:"browser",[Fe]:"webjs",[Be]:"2.0.1"};const xn=Math.pow(10,6),Pn=Math.pow(10,9);function On(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*xn)]}function Dn(){let t=Cn.timeOrigin;if("number"!=typeof t){const e=Cn;t=e.timing&&e.timing.fetchStart}return t}function Mn(t){return Fn(On(Dn()),On("number"==typeof t?t:Cn.now()))}function Nn(t){if(kn(t))return t;if("number"==typeof t)return t<Dn()?Mn(t):On(t);if(t instanceof Date)return On(t.getTime());throw TypeError("Invalid input type")}function In(t){return t[0]*Pn+t[1]}function kn(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function Un(t){return kn(t)||"number"==typeof t||t instanceof Date}function Fn(t,e){const n=[t[0]+e[0],t[1]+e[1]];return n[1]>=Pn&&(n[1]-=Pn,n[0]+=1),n}var jn;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(jn||(jn={}));class Bn{inject(t,e,n){for(const r of this._propagators)try{r.inject(t,e,n)}catch(t){Ht.warn(`Failed to inject with ${r.constructor.name}. Err: ${t.message}`)}}extract(t,e,n){return this._propagators.reduce((t,r)=>{try{return r.extract(t,e,n)}catch(t){Ht.warn(`Failed to extract with ${r.constructor.name}. Err: ${t.message}`)}return t},t)}fields(){return this._fields.slice()}constructor(t={}){var e;this._propagators=null!=(e=t.propagators)?e:[],this._fields=Array.from(new Set(this._propagators.map(t=>"function"==typeof t.fields?t.fields():[]).reduce((t,e)=>t.concat(e),[])))}}const Hn="[_0-9a-z-*/]",Vn=new RegExp(`^(?:${`[a-z]${Hn}{0,255}`}|${`[a-z0-9]${Hn}{0,240}@[a-z]${Hn}{0,13}`})$`),$n=/^[ -~]{0,255}[!-~]$/,zn=/,|=/;class qn{set(t,e){const n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n}unset(t){const e=this._clone();return e._internalState.delete(t),e}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce((t,e)=>(t.push(e+"="+this.get(e)),t),[]).join(",")}_parse(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((t,e)=>{const n=e.trim(),r=n.indexOf("=");if(-1!==r){const i=n.slice(0,r),s=n.slice(r+1,e.length);(function(t){return Vn.test(t)})(i)&&function(t){return $n.test(t)&&!zn.test(t)}(s)&&t.set(i,s)}return t},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const t=new qn;return t._internalState=new Map(this._internalState),t}constructor(t){this._internalState=new Map,t&&this._parse(t)}}const Gn="traceparent",Wn="tracestate",Qn=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class Kn{inject(t,e,n){const r=re.getSpanContext(t);if(!r||mn(t)||!xt(r))return;const i=`00-${r.traceId}-${r.spanId}-0${Number(r.traceFlags||I.NONE).toString(16)}`;n.set(e,Gn,i),r.traceState&&n.set(e,Wn,r.traceState.serialize())}extract(t,e,n){const r=n.get(e,Gn);if(!r)return t;const i=Array.isArray(r)?r[0]:r;if("string"!=typeof i)return t;const s=function(t){const e=Qn.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(i);if(!s)return t;s.isRemote=!0;const o=n.get(e,Wn);if(o){const t=Array.isArray(o)?o.join(","):o;s.traceState=new qn("string"==typeof t?t:void 0)}return re.setSpanContext(t,s)}fields(){return[Gn,Wn]}}const Xn="[object Null]",Jn="[object Undefined]",Yn=Function.prototype.toString,Zn=Yn.call(Object),tr=Object.getPrototypeOf,er=Object.prototype,nr=er.hasOwnProperty,rr=Symbol?Symbol.toStringTag:void 0,ir=er.toString;function sr(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||"[object Object]"!==function(t){if(null==t)return void 0===t?Jn:Xn;return rr&&rr in Object(t)?function(t){const e=nr.call(t,rr),n=t[rr];let r=!1;try{t[rr]=void 0,r=!0}catch(t){}const i=ir.call(t);r&&(e?t[rr]=n:delete t[rr]);return i}(t):function(t){return ir.call(t)}(t)}(t))return!1;const e=tr(t);if(null===e)return!0;const n=nr.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Yn.call(n)===Zn}function or(...t){let e=t.shift();const n=new WeakMap;for(;t.length>0;)e=ur(e,t.shift(),0,n);return e}function ar(t){return lr(t)?t.slice():t}function ur(t,e,n=0,r){let i;if(!(n>20)){if(n++,pr(t)||pr(e)||hr(e))i=ar(e);else if(lr(t)){if(i=t.slice(),lr(e))for(let t=0,n=e.length;t<n;t++)i.push(ar(e[t]));else if(dr(e)){const t=Object.keys(e);for(let n=0,r=t.length;n<r;n++){const r=t[n];i[r]=ar(e[r])}}}else if(dr(t))if(dr(e)){if(!function(t,e){if(!sr(t)||!sr(e))return!1;return!0}(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let o=0,a=s.length;o<a;o++){const a=s[o],u=e[a];if(pr(u))void 0===u?delete i[a]:i[a]=u;else{const s=i[a],o=u;if(cr(t,a,r)||cr(e,a,r))delete i[a];else{if(dr(s)&&dr(o)){const n=r.get(s)||[],i=r.get(o)||[];n.push({obj:t,key:a}),i.push({obj:e,key:a}),r.set(s,n),r.set(o,i)}i[a]=ur(i[a],u,n,r)}}}}else i=e;return i}}function cr(t,e,n){const r=n.get(t[e])||[];for(let n=0,i=r.length;n<i;n++){const i=r[n];if(i.key===e&&i.obj===t)return!0}return!1}function lr(t){return Array.isArray(t)}function hr(t){return"function"==typeof t}function dr(t){return!pr(t)&&!lr(t)&&!hr(t)&&"object"==typeof t}function pr(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}class gr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,gr.prototype)}}function mr(t,e){let n;const r=new Promise(function(t,r){n=setTimeout(function(){r(new gr("Operation timed out."))},e)});return Promise.race([t,r]).then(t=>(clearTimeout(n),t),t=>{throw clearTimeout(n),t})}function fr(t,e){return"string"==typeof e?t===e:!!t.match(e)}function _r(t,e){if(!e)return!1;for(const n of e)if(fr(t,n))return!0;return!1}class vr{get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}constructor(){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}}class br{get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then(t=>this._deferred.resolve(t),t=>this._deferred.reject(t))}catch(t){this._deferred.reject(t)}}return this._deferred.promise}constructor(t,e){this._isCalled=!1,this._deferred=new vr,this._callback=t,this._that=e}}const Sr={_export:function(t,e){return new Promise(n=>{Bt.with(gn(Bt.active()),()=>{t.export(e,t=>{n(t)})})})}};class yr{constructor(t=window.performance){this.epochMillisFromOriginOffset=t=>this._clock.timeOrigin+t,this.getNowHRTime=()=>On(this.getNowMillis()),this.getNowMillis=()=>this.epochMillisFromOriginOffset(this._clock.now()),this.millisSinceHRTime=t=>this.getNowMillis()-function(t){return 1e3*t[0]+t[1]/1e6}(t),this._clock=t}}const Tr=(t,e=1e3)=>{let n=!1;return(...r)=>{n||(t(...r),setTimeout(()=>{n=!1},e),n=!0)}},Er=globalThis;function wr(){return wr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wr.apply(this,arguments)}const Lr=()=>JSON.stringify(Er._EmbraceFileBundleIDs||{});class Cr{static _logSeverityToSeverityNumber(t){switch(t){case"info":return ge.INFO;case"warning":return ge.WARN;default:return ge.ERROR}}logException(t,{handled:e=!0,attributes:n={},timestamp:r=this._perf.getNowMillis()}={}){t||(t=new Error("logException received an undefined error")),null!=n&&"object"==typeof n||(this._diag.warn("attributes must be a non-null object",n),n={}),e||this._spanSessionManager.incrSessionCountForKey("emb.unhandled_exceptions_count");const i=Cr._normalizeErrorData(t),s=this._limitManager.limitException(i.message,n);"dropped"!==s&&this._logger.emit({timestamp:r,severityNumber:ge.ERROR,severityText:"ERROR",body:s.message,attributes:wr({},s.attributes,{[$e]:en.SystemException,[Je]:e?"HANDLED":"UNHANDLED",[Oe]:i.type,"exception.name":i.name,[xe]:s.message,[Pe]:i.stack,[Ze]:Lr()})})}message(t,e,{attributes:n={},includeStacktrace:r=!0,stacktrace:i}={}){if(!t||"string"!=typeof t)return void this._diag.warn("Message must be a string");"error"===e&&this._spanSessionManager.incrSessionCountForKey("emb.error_log_count");let s="";"info"!==e&&(i?s=i:r&&(s=(new Error).stack||"")),this._logMessage({message:t.trim(),severity:e,timestamp:this._perf.getNowMillis(),attributes:n,stacktrace:s})}_logMessage({message:t,severity:e,timestamp:n,attributes:r={},stacktrace:i}){const s=this._limitManager.limitLog(t,e,r);"dropped"!==s&&this._logger.emit({timestamp:n,severityNumber:Cr._logSeverityToSeverityNumber(e),severityText:e.toUpperCase(),body:s.message,attributes:wr({},s.attributes,{[$e]:en.SystemLog},i?{[Xe]:i,[Ze]:Lr()}:{})})}static _normalizeErrorData(t){if(t instanceof Error)return{message:"string"==typeof t.message?t.message.trim():"",type:t.constructor.name,name:t.name,stack:t.stack||""};const e=(new Error).stack||"";if("string"==typeof t)return{message:t.trim(),type:"String",name:"String",stack:e};if(t&&"object"==typeof t){let n="";try{n=JSON.stringify(t)}catch(t){n="[unable to serialize error]"}return{message:n,type:t.constructor.name,name:t.constructor.name,stack:e}}return{message:String(t).trim(),type:typeof t,name:typeof t,stack:e}}constructor({diag:t,perf:e,spanSessionManager:n,limitManager:r,loggerProvider:i}){const s=null!=i?i:we;this._diag=null!=t?t:Ht.createComponentLogger({namespace:"EmbraceLogManager"}),this._perf=null!=e?e:new yr,this._logger=s.getLogger("embrace-web-sdk-logs"),this._spanSessionManager=n,this._limitManager=r}}const Rr="http.response.body.size",Ar="log.record.uid",xr="session.id",Pr="user.id",Or="embrace_session_number";function Dr(){return Dr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dr.apply(this,arguments)}class Mr{_getPermanentAttributes(){const t=new Map;try{for(let e=0;e<this._storage.length;e++){const n=this._storage.key(e);if(null==n?void 0:n.startsWith(Qe)){const e=this._storage.getItem(n);e&&t.set(n,e)}}}catch(t){this._diag.warn("Error loading permanent session properties",t)}return Object.fromEntries(t.entries())}_getSessionNumber(){try{const t=this._storage.getItem(Or);let e=t?parseInt(t,10):0;return e++,this._storage.setItem(Or,e.toString()),e}catch(t){return this._diag.warn("Failed to retrieve session number from storage",t),1}}addBreadcrumb(t){if(!this._sessionSpan)return void this._diag.debug("trying to add breadcrumb to a session, but there is no session in progress. This is a no-op.");const e=this._limitManager.limitBreadcrumb(t);"dropped"!==e&&this._sessionSpan.addEvent("emb-breadcrumb",{message:e.name},this._perf.getNowMillis())}addProperty(t,e,n){if(!this._sessionSpan)return void this._diag.debug("trying to add properties to a session, but there is no session in progress. This is a no-op.");const r=this._limitManager.limitSessionProperty(t,e);if("dropped"===r)return;const i=Qe+r.key;if(this._sessionSpan.setAttribute(i,r.value),"permanent"===(null==n?void 0:n.lifespan))try{this._storage.setItem(i,e)}catch(t){this._diag.warn("Failed to set permanent session property",t)}}removeProperty(t){if(!this._sessionSpan)return void this._diag.debug("trying to remove a session property, but there is no session in progress. This is a no-op.");const e=Qe+this._limitManager.truncateString("session_property_key",t);this._sessionSpan.removeAttribute(e);try{this._storage.getItem(e)&&this._storage.removeItem(e)}catch(t){this._diag.warn("Error removing permanent session property",t)}}endSessionSpan(){this.endSessionSpanInternal("manual")}endSessionSpanInternal(t){if(this._sessionSpan){this._sessionSpan.setAttributes(Dr({},this._getPermanentAttributes(),{[Ke]:t},this._activeSessionCounts,this._limitManager.getDiagnosticCounts(),{[We]:this._sdkStartupDuration})),this._sessionSpan.end(),this._sessionSpan=null,this._activeSessionStartTime=null,this._activeSessionId=null,this._activeSessionCounts=null;for(const t of this._sessionEndedListeners)try{t()}catch(t){this._diag.warn("Error while executing session ended listener",t)}this._limitManager.reset()}else this._diag.debug("trying to end a session, but there is no session in progress. This is a no-op.")}getSessionId(){return this._activeSessionId}getSessionSpan(){return this._sessionSpan}getSessionStartTime(){return this._activeSessionStartTime}startSessionSpan(t){this._sessionSpan&&this.endSessionSpanInternal("manual"),this._activeSessionId=cn(),this._activeSessionStartTime=this._perf.getNowHRTime(),this._activeSessionCounts={};const e=Dr({},this._getPermanentAttributes(),{[$e]:en.Session,[ze]:"hidden"===this._visibilityDoc.visibilityState?nn.Background:nn.Foreground,[xr]:this._activeSessionId,[qe]:this._coldStart,[Ge]:this._getSessionNumber()});(null==t?void 0:t.reason)&&(e["emb.session_start_type"]=t.reason),this._sessionSpan=new jr(this._tracer.startSpan("emb-session",{attributes:e})),this._coldStart=!1;for(const t of this._sessionStartedListeners)try{t()}catch(t){this._diag.warn("Error while executing session started listener",t)}}incrSessionCountForKey(t){this._sessionSpan&&this._activeSessionCounts?this._activeSessionCounts[t]=(this._activeSessionCounts[t]||0)+1:this._diag.debug("trying to increment a count for the active session, but there is no session in progress. This is a no-op.")}addSessionStartedListener(t){const e=this._sessionStartedListeners.push(t);return()=>{this._sessionStartedListeners.splice(e-1,1)}}addSessionEndedListener(t){const e=this._sessionEndedListeners.push(t);return()=>{this._sessionEndedListeners.splice(e-1,1)}}recordSDKStartupDuration(t){this._sdkStartupDuration=Math.ceil(t)}setTracerProvider(t){this._tracer=t.getTracer("embrace-web-sdk-sessions")}constructor({diag:t,perf:e,visibilityDoc:n=window.document,storage:r=window.localStorage,limitManager:i}){this._activeSessionId=null,this._activeSessionStartTime=null,this._sessionSpan=null,this._activeSessionCounts=null,this._coldStart=!0,this._sdkStartupDuration=0,this._sessionStartedListeners=[],this._sessionEndedListeners=[],this._diag=null!=t?t:Ht.createComponentLogger({namespace:"EmbraceSpanSessionManager"}),this._perf=null!=e?e:new yr,this._visibilityDoc=n,this._storage=r,this._limitManager=i,this._tracer=re.getTracer("embrace-web-sdk-sessions")}}const Nr={info:"info_log",warning:"warning_log",error:"error_log"};class Ir{_dropIfMaxReached(t){return this._currentCount[t]>=this._maxAllowed[t]?(this._diag.warn(`disallowing ${t} because the maximum number of ${this._maxAllowed[t].toString()} has already been reached for this session`),this._incrDiagnosticCount(t,"drop"),!0):(this._currentCount[t]=(this._currentCount[t]||0)+1,!1)}truncateString(t,e){return e.length>this._maxLength[t]?(this._diag.warn(`truncating ${t} because it is longer than ${this._maxLength[t].toString()} characters: "${e}"`),this._incrDiagnosticCount(t,"truncate_string"),e.substring(0,this._maxLength[t])):e}_truncateAttributes(t,e,n,r){const i=Object.keys(e);i.length>this._maxAttributes[t]&&(this._diag.warn(`truncating ${t} attributes because there are more than ${this._maxAttributes[t].toString()} set`),this._incrDiagnosticCount(t,"truncate_attributes"));const s={};for(let a=0;a<Math.min(i.length,this._maxAttributes[t]);a++){var o;s[this.truncateString(n,i[a])]=this.truncateString(r,(null==(o=e[i[a]])?void 0:o.toString())||"")}return s}limitBreadcrumb(t){return this._dropIfMaxReached("breadcrumb")?"dropped":{name:this.truncateString("breadcrumb",t)}}limitException(t,e){return this._dropIfMaxReached("exception")?"dropped":{message:this.truncateString("exception",t),attributes:this._truncateAttributes("exception",e,"exception_attribute_key","exception_attribute_value")}}limitLog(t,e,n){const r=Nr[e];return this._dropIfMaxReached(r)?"dropped":{message:this.truncateString(r,t),attributes:this._truncateAttributes(r,n,"log_attribute_key","log_attribute_value")}}limitSessionProperty(t,e){return this._dropIfMaxReached("session_property")?"dropped":{key:this.truncateString("session_property_key",t),value:this.truncateString("session_property_value",e)}}dropReadableSpan(t){const e=t.attributes[$e]===en.Network?"network_request":"span";return this._dropIfMaxReached(e)}reset(){this._diagnosticCounts={},this._currentCount={exception:0,error_log:0,warning_log:0,info_log:0,breadcrumb:0,session_property:0,span:0,network_request:0}}_incrDiagnosticCount(t,e){const n=`emb.app.applied_limit.${t}.${e}.count`;this._diagnosticCounts[n]=(this._diagnosticCounts[n]||0)+1}getDiagnosticCounts(){return this._diagnosticCounts}constructor({diag:t,maxAllowed:e,maxLength:n,maxAttributes:r}){this._diagnosticCounts={},this._currentCount={exception:0,error_log:0,warning_log:0,info_log:0,breadcrumb:0,session_property:0,span:0,network_request:0},this._diag=null!=t?t:Ht.createComponentLogger({namespace:"EmbraceLimitManager"}),this._maxAllowed=e,this._maxLength=n,this._maxAttributes=r}}const kr={maxAllowed:{error_log:500,warning_log:200,info_log:100,exception:500,breadcrumb:100,session_property:100,span:1e3,network_request:1e4},maxLength:{error_log:128,warning_log:128,info_log:128,exception:1024,breadcrumb:256,session_property_key:128,session_property_value:256,log_attribute_key:128,log_attribute_value:256,exception_attribute_key:128,exception_attribute_value:256},maxAttributes:{error_log:50,warning_log:50,info_log:50,exception:50}};function Ur(t){var e=function(t,e){if("object"!==Fr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e);if("object"!==Fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Fr(e)?e:String(e)}function Fr(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}class jr{get attributes(){return this._span.attributes}addEvent(t,e,n){return this._span.addEvent(t,e,n),this}addLink(t){return this._span.addLink(t),this}addLinks(t){return this._span.addLinks(t),this}end(t){this._span.end(t)}isRecording(){return this._span.isRecording()}recordException(t,e){this._span.recordException(t,e)}setAttribute(t,e){return this._span.setAttribute(t,e),this}setAttributes(t){return this._span.setAttributes(t),this}removeAttribute(t){const e=this._span.attributes,{[t]:n}=e,r=function(t,e){if(null==t)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(e,[t].map(Ur));return this._span.attributes=r,this}setStatus(t){return this._span.setStatus(t),this}spanContext(){return this._span.spanContext()}updateName(t){return this._span.updateName(t),this}fail(t={code:"failure"}){t.code&&this._span.setAttribute("emb.error_code",t.code.toUpperCase()),this._span.end(t.endTime)}constructor(t){this._span=t}}class Br{startSpan(t,e={},n){e.attributes=e.attributes?e.attributes:{},e.attributes[$e]=en.Perf;const r=e.parentSpan?re.setSpan(Bt.active(),e.parentSpan):n;return new jr(this._tracer.startSpan(t,e,r))}getSpan(t){const e=re.getSpan(t);if(e)return new jr(e)}constructor({tracerProvider:t}={}){this.setSpan=re.setSpan;const e=null!=t?t:re;this._tracer=e.getTracer("embrace-web-sdk-traces")}}const Hr="embrace_user",Vr="embrace_user_id",$r="embrace_external_user_id";class zr{getEmbraceUserId(){return this._embraceUserId||this._generateNewEmbraceUserId()}setEmbraceUserId(t){this._embraceUserId=t;try{this._storage.setItem(Vr,t)}catch(t){this._diag.warn("Failed to persist user object for storage, keeping it in-memory only",t)}}clearEmbraceUserId(){this._embraceUserId=null;try{this._storage.removeItem(Vr)}catch(t){this._diag.warn("Failed to remove embrace user in storage",t)}}_migrateOldLocalStorageKey(){try{const t=this._storage.getItem(Hr);if(t){const e=JSON.parse(t);(t=>"string"==typeof t[ce]&&32===t[ce].length)(e)?(this._diag.debug("Migrating old user data from storage"),this._storage.setItem(Vr,e[ce]),this._storage.removeItem(Hr)):(this._diag.warn("Invalid user data found in storage, clearing old user data"),this._storage.removeItem(Hr))}}catch(t){this._diag.warn("Failed to get old user data from storage",t)}}_initialSetup(){try{const e=this._storage.getItem(Vr);e?"string"==typeof(t=e)&&32===t.length?this._embraceUserId=e:(this._diag.warn("Invalid embrace user id, generating a new one"),this.clearEmbraceUserId()):this._diag.debug("No existing user found in storage, creating a new one")}catch(t){this._diag.warn("Failed to get embrace user id from storage, defaulting to a new one",t)}var t;this._embraceUserId||(this._embraceUserId=this._generateNewEmbraceUserId())}_generateNewEmbraceUserId(){const t=cn();return this.setEmbraceUserId(t),t}getUserId(){try{return this._storage.getItem($r)}catch(t){return this._diag.warn("Failed to retrieve user id from storage",t),null}}setUserId(t){try{this._storage.setItem($r,t)}catch(t){this._diag.warn("Failed to store user id",t)}}clearUserId(){try{this._storage.removeItem($r)}catch(t){this._diag.warn("Failed to clear user id",t)}}constructor({diag:t,storage:e=localStorage}={}){this._embraceUserId=null,this._diag=null!=t?t:Ht.createComponentLogger({namespace:"EmbraceUserManager"}),this._storage=e,this._migrateOldLocalStorageKey(),this._initialSetup()}}const qr={samplingPct:100},Gr="embrace_remote_config";function Wr(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function Qr(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Wr(s,r,i,o,a,"next",t)}function a(t){Wr(s,r,i,o,a,"throw",t)}o(void 0)})}}function Kr(){return Kr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kr.apply(this,arguments)}const Xr=t=>({samplingPct:t.threshold});class Jr{setConfig(t){this._sdkConfig=Kr({},this._sdkConfig,t)}getConfig(){return this._sdkConfig}refreshRemoteConfig(){return Qr(function*(){if(this._remoteConfigURL)try{const t=yield this._fetchRemoteConfig(this._remoteConfigURL);if(!t)return void this._diag.debug("No changes in remote config, skipping update");const[e,n]=t;this._storage.setItem(Gr,JSON.stringify({config:e,etag:n})),this._sdkConfig=Xr(e),this._etag=n}catch(t){this._diag.warn(`Failed to refresh remote config: ${t instanceof Error?t.message:String(t)}`)}}).call(this)}_getRemoteConfigFromStorage(){try{const t=this._storage.getItem(Gr);return t?JSON.parse(t):null}catch(t){return this._diag.warn(`Failed to parse remote config from storage: ${t instanceof Error?t.message:String(t)}`),null}}_fetchRemoteConfig(t){return Qr(function*(){const e=yield fetch(t,{headers:this._etag?{"If-None-Match":this._etag}:{}}),n=e.headers.get("etag");if(304===e.status)return null;if(!e.ok)return this._diag.warn(`Failed to fetch remote config from ${t}: ${e.statusText}`),null;return[yield e.json(),n]}).call(this)}constructor({appID:t,appVersion:e,deviceId:n,diag:r=Ht.createComponentLogger({namespace:"embrace-config-manager"}),storage:i=localStorage,defaultConfig:s={},embraceConfigURL:o}={}){this._remoteConfigURL=null,this._etag=null,t&&e&&n&&(this._remoteConfigURL=((t,{osVersion:e,appVersion:n,deviceId:r},i)=>`${i||`https://a-${t}.config.emb-api.com`}/v2/config?appId=${t}&osVersion=${e}&appVersion=${n}&deviceId=${r}`)(t,{appVersion:e,deviceId:n,osVersion:"1"},o)),this._diag=r,this._storage=i;const a=this._getRemoteConfigFromStorage();a&&(this._etag=a.etag),this._sdkConfig=Kr({},qr,s,a?Xr(a.config):{})}}class Yr{isSDKEnabled(){const t=this._dynamicConfigManager.getConfig();return e=this._deviceId,!((n=t.samplingPct)<=0||n>100)&&n>=dn(e);var e,n}constructor({dynamicConfigManager:t,deviceId:e}){this._dynamicConfigManager=t,this._deviceId=e}}function Zr(){return Zr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Zr.apply(this,arguments)}let ti=class{get tracer(){return this._tracer}get meter(){return this._meter}get logger(){return this._logger}getModuleDefinitions(){var t;const e=null!=(t=this.init())?t:[];return Array.isArray(e)?e:[e]}getConfig(){return this._config}setConfig(t){this._config=Zr({enabled:!0},t)}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}_updateMetricInstruments(){}_runSpanCustomizationHook(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}constructor(t,e,n){this.instrumentationName=t,this.instrumentationVersion=e,this._config={},this.setConfig(n),this._diag=Ht.createComponentLogger({namespace:t}),this._tracer=re.getTracer(t,e),this._meter=zt.getMeter(t,e),this._logger=we.getLogger(t,e),this._updateMetricInstruments()}};class ei extends ti{get sessionManager(){return this._sessionManager}get logManager(){return this._logManager}get perf(){return this._perf}init(){}setLogManager(t){this._logManager=t}setSessionManager(t){this._sessionManager=t}constructor({instrumentationName:t,instrumentationVersion:e,config:n,diag:r,perf:s}){super(t,e,n),r&&(this._diag=r),this._perf=null!=s?s:new yr,this._sessionManager=u.getSpanSessionManager(),this._logManager=i.getLogManager()}}const ni=["mousedown"];class ri extends ei{disable(){window.removeEventListener("visibilitychange",this._checkVisibilityChange),this._avoidEndingLimitedSessions&&hn({target:window,events:ni,callback:this._onInteractionThrottled})}enable(){window.addEventListener("visibilitychange",this._checkVisibilityChange),this._avoidEndingLimitedSessions&&ln({target:window,events:ni,callback:this._onInteractionThrottled})}constructor({diag:t,perf:e,visibilityWaitTimeMs:n=0,limitedSessionMaxDurationMs:r=0,backgroundSessions:i=!1,visibilityDoc:s=window.document}={}){super({instrumentationName:"SpanSessionVisibilityInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._currentVisibilityState=s.visibilityState,this._checkVisibilityTimeout=null,this._interactionSinceLastVisibilityChange=!1,this._avoidEndingLimitedSessions=r>0,this._checkVisibilityChange=()=>n<=0?(this._currentVisibilityState=s.visibilityState,void this._onVisibilityChange()):(this._checkVisibilityTimeout&&clearTimeout(this._checkVisibilityTimeout),"visible"===s.visibilityState&&this._currentVisibilityState!=s.visibilityState?(this._currentVisibilityState=s.visibilityState,void this._onVisibilityChange()):(this._diag.debug(`Visibility changed to ${s.visibilityState}. Will wait ${(n/1e3).toString()}s, and check if visibility changed`),void(this._checkVisibilityTimeout=setTimeout(()=>{this._currentVisibilityState!=s.visibilityState?(this._currentVisibilityState=s.visibilityState,this._onVisibilityChange()):this._diag.debug(`Visibility was not changed after timeout happened: ${s.visibilityState}`)},n)))),this._onVisibilityChange=()=>{this._diag.debug(`Visibility change detected: ${s.visibilityState}`);const t=this.sessionManager.getSessionStartTime();this._avoidEndingLimitedSessions&&null!==t&&this.perf.millisSinceHRTime(t)<r&&!this._interactionSinceLastVisibilityChange?(this._diag.debug("Not ending the session since it is considered limited"),this.sessionManager.addBreadcrumb(`Tab visibility changed to ${s.visibilityState}`)):(this.sessionManager.endSessionSpanInternal("state_changed"),"hidden"===s.visibilityState&&i?(this._diag.debug("Starting a session since document visibility switched to hidden and `backgroundSessions` is enabled"),this.sessionManager.startSessionSpan({reason:"hidden"})):"visible"===s.visibilityState&&(this._diag.debug("Starting a session since document visibility switched to visible"),this.sessionManager.startSessionSpan({reason:"visible"}))),this._interactionSinceLastVisibilityChange=!1},this._onInteractionThrottled=Tr(()=>{this._interactionSinceLastVisibilityChange=!0},1e3),this._config.enabled&&this.enable()}}const ii=["keydown","mousedown","mousemove","scroll"];class si extends ei{constructor({diag:t}={}){super({instrumentationName:"SpanSessionBrowserActivityInstrumentation",instrumentationVersion:"1.0.0",diag:t,config:{}}),this.disable=()=>{hn({target:window,events:ii,callback:this._onActivityThrottled}),this._activityTimeout&&clearTimeout(this._activityTimeout),this._activityTimeout=null},this.enable=()=>{ln({target:window,events:ii,callback:this._onActivityThrottled})},this._onInactivity=()=>{this._diag.debug("Inactivity detected"),this._activityTimeout&&clearTimeout(this._activityTimeout),this._activityTimeout=null,this.sessionManager.endSessionSpanInternal("inactivity")},this._onActivity=()=>{this._diag.debug("Activity detected"),this._activityTimeout&&clearTimeout(this._activityTimeout),this.sessionManager.getSessionId()||this.sessionManager.startSessionSpan({reason:"activity"}),this._activityTimeout=setTimeout(this._onInactivity,18e5)},this._activityTimeout=null,this._onActivityThrottled=Tr(this._onActivity,3e4),this._config.enabled&&this.enable()}}class oi extends ei{disable(){this.sessionManager.endSessionSpanInternal("unknown")}enable(){this.sessionManager.startSessionSpan({reason:"init"})}constructor({diag:t}={}){super({instrumentationName:"SpanSessionOnLoadInstrumentation",instrumentationVersion:"1.0.0",diag:t,config:{}}),this._config.enabled&&this.enable()}}const ai=144e5;class ui extends ei{constructor({diag:t,perf:e}={}){super({instrumentationName:"SpanSessionTimeoutInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this.disable=()=>{this._sessionTimeout&&clearTimeout(this._sessionTimeout),this._sessionTimeout=null},this.enable=()=>{this._checkTimeout()},this._onTimeout=()=>{this._diag.debug("Timeout detected"),this._sessionTimeout&&clearTimeout(this._sessionTimeout),this.sessionManager.endSessionSpanInternal("timer"),this.sessionManager.startSessionSpan({reason:"timer"}),this._sessionTimeout=setTimeout(this._checkTimeout,ai)},this._checkTimeout=()=>{const t=this.sessionManager.getSessionStartTime();if(t){const e=this.perf.millisSinceHRTime(t),n=ai-e;return n<=0?void this._onTimeout():(this._sessionTimeout&&clearTimeout(this._sessionTimeout),void(this._sessionTimeout=setTimeout(this._checkTimeout,n)))}this._sessionTimeout&&clearTimeout(this._sessionTimeout),this._sessionTimeout=setTimeout(this._checkTimeout,ai)},this._sessionTimeout=null,this._config.enabled&&this.enable()}}class ci extends ei{disable(){window.removeEventListener("error",this._onErrorHandler),window.removeEventListener("unhandledrejection",this._onUnhandledRejectionHandler)}enable(){window.addEventListener("error",this._onErrorHandler),window.addEventListener("unhandledrejection",this._onUnhandledRejectionHandler)}constructor({diag:t,perf:e}={}){super({instrumentationName:"GlobalExceptionInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._onErrorHandler=t=>{this.logManager.logException(t.error||t.message,{handled:!1,timestamp:this.perf.epochMillisFromOriginOffset(t.timeStamp)})},this._onUnhandledRejectionHandler=t=>{let e;t.reason&&t.reason instanceof Error?e=t.reason:(e=new Error("string"==typeof t.reason?t.reason:"Unhandled Rejected Promise"),e.stack=""),this.logManager.logException(e,{handled:!1,timestamp:this.perf.epochMillisFromOriginOffset(t.timeStamp)})},this._config.enabled&&this.enable()}}const li=(t,e)=>{const n=t.nodeName.toLowerCase(),r=e.substring(0,30),i=e.length>30?"...":"";return`<${n}${t.className?` class="${t.className}"`:""}>${r}${i}</${n}>`};class hi extends ei{disable(){document.removeEventListener("click",this._onClickHandler)}enable(){document.addEventListener("click",this._onClickHandler)}constructor({diag:t,perf:e,shouldTrack:n,innerTextForElement:r}={}){super({instrumentationName:"ClicksInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._onClickHandler=t=>{const e=t.target;if(e instanceof HTMLElement&&!e.hasAttribute("disabled")&&(!n||n(e)))try{const n=this.sessionManager.getSessionSpan();n&&n.addEvent("click",{"emb.type":"ux.tap","view.name":li(e,r?r(e):e.innerText),"tap.coords":`${t.x.toString()},${t.y.toString()}`},this.perf.epochMillisFromOriginOffset(t.timeStamp))}catch(t){this._diag.error("failed to create new user interaction span event",t)}},this._config.enabled&&this.enable()}}function di(){return di=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},di.apply(this,arguments)}class pi{u(t){if(t.hadRecentInput)return;const e=this.i[0],n=this.i.at(-1);this.o&&e&&n&&t.startTime-n.startTime<1e3&&t.startTime-e.startTime<5e3?(this.o+=t.value,this.i.push(t)):(this.o=t.value,this.i=[t]),null==this.t||this.t.call(this,t)}constructor(){this.o=0,this.i=[]}}const gi=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},mi=t=>{if("loading"===document.readyState)return"loading";{const e=gi();if(e){if(t<e.domInteractive)return"loading";if(0===e.domContentLoadedEventStart||t<e.domContentLoadedEventStart)return"dom-interactive";if(0===e.domComplete||t<e.domComplete)return"dom-content-loaded"}}return"complete"},fi=t=>{const e=t.nodeName;return 1===t.nodeType?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},_i=t=>{let e="";try{for(;9!==(null==t?void 0:t.nodeType);){const n=t,r=n.id?"#"+n.id:[fi(n),...Array.from(n.classList).sort()].join(".");if(e.length+r.length>99)return e||r;if(e=e?r+">"+e:r,n.id)break;t=n.parentNode}}catch(e){}return e},vi=new WeakMap;function bi(t,e){return vi.get(t)||vi.set(t,new e),vi.get(t)}let Si=-1;const yi=()=>Si,Ti=t=>{addEventListener("pageshow",e=>{e.persisted&&(Si=e.timeStamp,t(e))},!0)},Ei=(t,e,n,r)=>{let i,s;return o=>{e.value>=0&&(o||r)&&(s=e.value-(null!=i?i:0),(s||void 0===i)&&(i=e.value,e.delta=s,e.rating=((t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good")(e.value,n),t(e)))}},wi=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},Li=()=>{const t=gi();var e;return null!=(e=null==t?void 0:t.activationStart)?e:0},Ci=(t,e=-1)=>{const n=gi();let r="navigate";return yi()>=0?r="back-forward-cache":n&&(document.prerendering||Li()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},Ri=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(t=>{Promise.resolve().then(()=>{e(t.getEntries())})});return r.observe(di({type:t,buffered:!0},n)),r}}catch(e){}},Ai=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let xi=-1;const Pi=new Set,Oi=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,Di=t=>{if("hidden"===document.visibilityState){if("visibilitychange"===t.type)for(const t of Pi)t();isFinite(xi)||(xi="visibilitychange"===t.type?t.timeStamp:0,removeEventListener("prerenderingchange",Di,!0))}},Mi=()=>{if(xi<0){var t;const e=Li(),n=document.prerendering||null==(t=globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0])?void 0:t.startTime;xi=null!=n?n:Oi(),addEventListener("visibilitychange",Di,!0),addEventListener("prerenderingchange",Di,!0),Ti(()=>{setTimeout(()=>{xi=Oi()})})}return{get firstHiddenTime(){return xi},onHidden(t){Pi.add(t)}}},Ni=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},Ii=[1800,3e3],ki=(t,e={})=>{Ni(()=>{const n=Mi();let r,i=Ci("FCP");const s=Ri("paint",t=>{for(const e of t)"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<n.firstHiddenTime&&(i.value=Math.max(e.startTime-Li(),0),i.entries.push(e),r(!0)))});s&&(r=Ei(t,i,Ii,e.reportAllChanges),Ti(n=>{i=Ci("FCP"),r=Ei(t,i,Ii,e.reportAllChanges),wi(()=>{i.value=performance.now()-n.timeStamp,r(!0)})}))})},Ui=[.1,.25],Fi=t=>t.find(t=>{var e;return 1===(null==(e=t.node)?void 0:e.nodeType)})||t[0];let ji=0,Bi=1/0,Hi=0;const Vi=t=>{for(const e of t)e.interactionId&&(Bi=Math.min(Bi,e.interactionId),Hi=Math.max(Hi,e.interactionId),ji=Hi?(Hi-Bi)/7+1:0)};let $i;const zi=()=>{var t;return $i?ji:null!=(t=performance.interactionCount)?t:0};let qi=0;class Gi{v(){qi=zi(),this.l.length=0,this.h.clear()}M(){const t=Math.min(this.l.length-1,Math.floor((zi()-qi)/50));return this.l[t]}u(t){if(null==this.m||this.m.call(this,t),!t.interactionId&&"first-input"!==t.entryType)return;const e=this.l.at(-1);let n=this.h.get(t.interactionId);if(n||this.l.length<10||t.duration>e.T){if(n?t.duration>n.T?(n.entries=[t],n.T=t.duration):t.duration===n.T&&t.startTime===n.entries[0].startTime&&n.entries.push(t):(n={id:t.interactionId,entries:[t],T:t.duration},this.h.set(n.id,n),this.l.push(n)),this.l.sort((t,e)=>e.T-t.T),this.l.length>10){const t=this.l.splice(10);for(const e of t)this.h.delete(e.id)}null==this.p||this.p.call(this,n)}}constructor(){this.l=[],this.h=new Map}}const Wi=t=>{const e=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?t():(t=Ai(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e(()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})}))},Qi=[200,500];class Ki{u(t){null==this.m||this.m.call(this,t)}}const Xi=[2500,4e3],Ji=[800,1800],Yi=t=>{document.prerendering?Ni(()=>Yi(t)):"complete"!==document.readyState?addEventListener("load",()=>Yi(t),!0):setTimeout(t)},Zi=["CLS","INP","LCP"],ts=["CLS","INP","LCP","FCP","TTFB"],es={CLS:(t,e={})=>{const n=bi(e=Object.assign({},e),pi),r=new WeakMap;n.t=t=>{var n;if(null==t||null==(n=t.sources)?void 0:n.length){const n=Fi(t.sources),s=null==n?void 0:n.node;if(s){var i;const t=null!=(i=null==e.generateTarget?void 0:e.generateTarget.call(e,s))?i:_i(s);r.set(n,t)}}},((t,e={})=>{const n=Mi();ki(Ai(()=>{let r,i=Ci("CLS",0);const s=bi(e,pi),o=t=>{for(const e of t)s.u(e);s.o>i.value&&(i.value=s.o,i.entries=s.i,r())},a=Ri("layout-shift",o);a&&(r=Ei(t,i,Ui,e.reportAllChanges),n.onHidden(()=>{o(a.takeRecords()),r(!0)}),Ti(()=>{s.o=0,i=Ci("CLS",0),r=Ei(t,i,Ui,e.reportAllChanges),wi(()=>r())}),setTimeout(r))}))})(e=>{const n=(t=>{let e={};if(t.entries.length){var n;const i=t.entries.reduce((t,e)=>t.value>e.value?t:e);if(null==i||null==(n=i.sources)?void 0:n.length){const t=Fi(i.sources);t&&(e={largestShiftTarget:r.get(t),largestShiftTime:i.startTime,largestShiftValue:i.value,largestShiftSource:t,largestShiftEntry:i,loadState:mi(i.startTime)})}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},FCP:(t,e={})=>{ki(e=>{const n=(t=>{let e={timeToFirstByte:0,firstByteToFCP:t.value,loadState:mi(yi())};if(t.entries.length){const n=gi(),r=t.entries.at(-1);if(n){const i=n.activationStart||0,s=Math.max(0,n.responseStart-i);e={timeToFirstByte:s,firstByteToFCP:t.value-s,loadState:mi(t.entries[0].startTime),navigationEntry:n,fcpEntry:r}}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},LCP:(t,e={})=>{const n=bi(e=Object.assign({},e),Ki),r=new WeakMap;n.m=t=>{const n=t.element;if(n){var i;const s=null!=(i=null==e.generateTarget?void 0:e.generateTarget.call(e,n))?i:_i(n);r.set(t,s)}},((t,e={})=>{Ni(()=>{const n=Mi();let r,i=Ci("LCP");const s=bi(e,Ki),o=t=>{e.reportAllChanges||(t=t.slice(-1));for(const e of t)s.u(e),e.startTime<n.firstHiddenTime&&(i.value=Math.max(e.startTime-Li(),0),i.entries=[e],r())},a=Ri("largest-contentful-paint",o);if(a){r=Ei(t,i,Xi,e.reportAllChanges);const n=Ai(()=>{o(a.takeRecords()),a.disconnect(),r(!0)}),s=t=>{t.isTrusted&&(Wi(n),removeEventListener(t.type,s,{capture:!0}))};for(const t of["keydown","click","visibilitychange"])addEventListener(t,s,{capture:!0});Ti(n=>{i=Ci("LCP"),r=Ei(t,i,Xi,e.reportAllChanges),wi(()=>{i.value=performance.now()-n.timeStamp,r(!0)})})}})})(e=>{const n=(t=>{let e={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:t.value};if(t.entries.length){const n=gi();if(n){const i=n.activationStart||0,s=t.entries.at(-1),o=s.url&&performance.getEntriesByType("resource").filter(t=>t.name===s.url)[0],a=Math.max(0,n.responseStart-i),u=Math.max(a,o?(o.requestStart||o.startTime)-i:0),c=Math.min(t.value,Math.max(u,o?o.responseEnd-i:0));e={target:r.get(s),timeToFirstByte:a,resourceLoadDelay:u-a,resourceLoadDuration:c-u,elementRenderDelay:t.value-c,navigationEntry:n,lcpEntry:s},s.url&&(e.url=s.url),o&&(e.lcpResourceEntry=o)}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},INP:(t,e={})=>{const n=bi(e=Object.assign({},e),Gi);let r=[],i=[],s=0;const o=new WeakMap,a=new WeakMap;let u=!1;const c=()=>{u||(Wi(l),u=!0)},l=()=>{const t=n.l.map(t=>o.get(t.entries[0])),e=i.length-50;i=i.filter((n,r)=>r>=e||t.includes(n));const a=new Set;for(const t of i){const e=h(t.startTime,t.processingEnd);for(const t of e)a.add(t)}const c=r.length-1-50;r=r.filter((t,e)=>t.startTime>s&&e>c||a.has(t)),u=!1};n.m=t=>{const e=t.startTime+t.duration;let n;s=Math.max(s,t.processingEnd);for(let r=i.length-1;r>=0;r--){const s=i[r];if(Math.abs(e-s.renderTime)<=8){n=s,n.startTime=Math.min(t.startTime,n.startTime),n.processingStart=Math.min(t.processingStart,n.processingStart),n.processingEnd=Math.max(t.processingEnd,n.processingEnd),n.entries.push(t);break}}n||(n={startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,renderTime:e,entries:[t]},i.push(n)),(t.interactionId||"first-input"===t.entryType)&&o.set(t,n),c()},n.p=t=>{if(!a.get(t)){const r=t.entries[0].target;if(r){var n;const i=null!=(n=null==e.generateTarget?void 0:e.generateTarget.call(e,r))?n:_i(r);a.set(t,i)}}};const h=(t,e)=>{const n=[];for(const i of r)if(!(i.startTime+i.duration<t)){if(i.startTime>e)break;n.push(i)}return n},d=t=>{const e=t.entries[0],r=o.get(e),i=e.processingStart,s=Math.max(e.startTime+e.duration,i),u=Math.min(r.processingEnd,s),c=r.entries.sort((t,e)=>t.processingStart-e.processingStart),l=h(e.startTime,u),d=n.h.get(e.interactionId),p={interactionTarget:a.get(d),interactionType:e.name.startsWith("key")?"keyboard":"pointer",interactionTime:e.startTime,nextPaintTime:s,processedEventEntries:c,longAnimationFrameEntries:l,inputDelay:i-e.startTime,processingDuration:u-i,presentationDelay:s-u,loadState:mi(e.startTime),longestScript:void 0,totalScriptDuration:void 0,totalStyleAndLayoutDuration:void 0,totalPaintDuration:void 0,totalUnattributedDuration:void 0};return(t=>{var e;if(!(null==(e=t.longAnimationFrameEntries)?void 0:e.length))return;const n=t.interactionTime,r=t.inputDelay,i=t.processingDuration;let s,o,a=0,u=0,c=0,l=0;for(const e of t.longAnimationFrameEntries){u=u+e.startTime+e.duration-e.styleAndLayoutStart;for(const t of e.scripts){const e=t.startTime+t.duration;if(e<n)continue;const c=e-Math.max(n,t.startTime),h=t.duration?c/t.duration*t.forcedStyleAndLayoutDuration:0;a+=c-h,u+=h,c>l&&(o=t.startTime<n+r?"input-delay":t.startTime>=n+r+i?"presentation-delay":"processing-duration",s=t,l=c)}}const h=t.longAnimationFrameEntries.at(-1),d=h?h.startTime+h.duration:0;d>=n+r+i&&(c=t.nextPaintTime-d),s&&o&&(t.longestScript={entry:s,subpart:o,intersectingDuration:l}),t.totalScriptDuration=a,t.totalStyleAndLayoutDuration=u,t.totalPaintDuration=c,t.totalUnattributedDuration=t.nextPaintTime-n-a-u-c})(p),Object.assign(t,{attribution:p})};Ri("long-animation-frame",t=>{r=r.concat(t),c()}),((t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=Mi();Ni(()=>{"interactionCount"in performance||$i||($i=Ri("event",Vi,{type:"event",buffered:!0,durationThreshold:0}));let r,i=Ci("INP");var s;const o=bi(e,Gi),a=t=>{Wi(()=>{for(const e of t)o.u(e);const e=o.M();e&&e.T!==i.value&&(i.value=e.T,i.entries=e.entries,r())})},u=Ri("event",a,{durationThreshold:null!=(s=e.durationThreshold)?s:40});r=Ei(t,i,Qi,e.reportAllChanges),u&&(u.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{a(u.takeRecords()),r(!0)}),Ti(()=>{o.v(),i=Ci("INP"),r=Ei(t,i,Qi,e.reportAllChanges)}))})})(e=>{const n=d(e);t(n)},e)},TTFB:(t,e={})=>{((t,e={})=>{let n=Ci("TTFB"),r=Ei(t,n,Ji,e.reportAllChanges);Yi(()=>{const i=gi();i&&(n.value=Math.max(i.responseStart-Li(),0),n.entries=[i],r(!0),Ti(()=>{n=Ci("TTFB",0),r=Ei(t,n,Ji,e.reportAllChanges),r(!0)}))})})(e=>{const n=(t=>{let e={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(t.entries.length){const n=t.entries[0],r=n.activationStart||0,i=Math.max((n.workerStart||n.fetchStart)-r,0),s=Math.max(n.domainLookupStart-r,0),o=Math.max(n.connectStart-r,0),a=Math.max(n.connectEnd-r,0);e={waitingDuration:i,cacheDuration:s-i,dnsDuration:o-s,connectionDuration:a-o,requestDuration:t.value-a,navigationEntry:n}}return Object.assign(t,{attribution:e})})(e);t(n)},e)},FID:void 0};function ns(){return ns=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ns.apply(this,arguments)}class rs extends ei{disable(){}enable(){this._metricsToTrack.forEach(t=>{var e;null==(e=this._listeners[t])||e.call(this._listeners,e=>{const n=this.sessionManager.getSessionSpan();if(!n)return;const r=this._getTimeForMetric(e),i=ns({[$e]:en.WebVital,[He]:this._getAttributedURLForMetric(e),"emb.web_vital.navigation_type":e.navigationType,"emb.web_vital.name":e.name,"emb.web_vital.rating":e.rating,"emb.web_vital.id":e.id,"emb.web_vital.delta":e.delta,"emb.web_vital.value":e.value},((t,e)=>{const n={},r=[];if("CLS"===t){const t=e.attribution;r.push({key:"largestShiftTarget",value:t.largestShiftTarget},{key:"largestShiftValue",value:t.largestShiftValue})}else if("INP"===t){const t=e.attribution;r.push({key:"interactionTarget",value:t.interactionTarget},{key:"interactionType",value:t.interactionType},{key:"nextPaintTime",value:t.nextPaintTime},{key:"inputDelay",value:t.inputDelay},{key:"processingDuration",value:t.processingDuration},{key:"presentationDelay",value:t.presentationDelay},{key:"totalScriptDuration",value:t.totalScriptDuration},{key:"totalStyleAndLayoutDuration",value:t.totalStyleAndLayoutDuration},{key:"totalPaintDuration",value:t.totalPaintDuration},{key:"totalUnattributedDuration",value:t.totalUnattributedDuration},{key:"loadState",value:t.loadState})}else if("LCP"===t){const t=e.attribution;r.push({key:"target",value:t.target},{key:"url",value:t.url},{key:"timeToFirstByte",value:t.timeToFirstByte},{key:"resourceLoadDelay",value:t.resourceLoadDelay},{key:"resourceLoadDuration",value:t.resourceLoadDuration},{key:"elementRenderDelay",value:t.elementRenderDelay})}return r.forEach(t=>{void 0!==t.value&&(n[`emb.web_vital.attribution.${t.key}`]=t.value)}),n})(t,e));n.addEvent(`emb-web-vitals-report-${t}`,i,r)})}),this._urlAttribution&&(null==this._listeners.INP||this._listeners.INP.call(this._listeners,()=>{this._attributedURL.INP=this._urlDocument.URL},{reportAllChanges:!0}),null==this._listeners.LCP||this._listeners.LCP.call(this._listeners,()=>{this._attributedURL.LCP=this._urlDocument.URL},{reportAllChanges:!0}),null==this._listeners.CLS||this._listeners.CLS.call(this._listeners,t=>{const e=t;this._largestShiftTargetForCLS!==e.attribution.largestShiftTarget&&(this._largestShiftTargetForCLS=e.attribution.largestShiftTarget,this._attributedURL.CLS=this._urlDocument.URL)},{reportAllChanges:!0}))}_getTimeForMetric(t){return"CLS"===t.name&&t.attribution.largestShiftTime?this.perf.epochMillisFromOriginOffset(t.attribution.largestShiftTime):"INP"===t.name&&t.attribution.interactionTime?this.perf.epochMillisFromOriginOffset(t.attribution.interactionTime):this.perf.getNowMillis()}_getAttributedURLForMetric(t){return"INP"===t.name&&this._attributedURL.INP?this._attributedURL.INP:"LCP"===t.name&&this._attributedURL.LCP?this._attributedURL.LCP:"CLS"===t.name&&this._attributedURL.CLS&&t.attribution.largestShiftTarget===this._largestShiftTargetForCLS?this._attributedURL.CLS:this._urlDocument.URL}constructor({diag:t,perf:e,trackingLevel:n="core",listeners:r=es,urlDocument:i=window.document,urlAttribution:s=!0}={}){super({instrumentationName:"WebVitalsInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{}}),this._attributedURL={INP:void 0,LCP:void 0,CLS:void 0,FCP:void 0,TTFB:void 0},this._listeners=r,this._urlDocument=i,this._metricsToTrack="core"===n?[...Zi]:[...ts],this._urlAttribution=s,this._config.enabled&&this.enable()}}const is=/\(.*?\)/g;class ss extends ei{constructor({diag:t,shouldCleanupPathOptionsFromRouteName:e=!0}){super({instrumentationName:"NavigationInstrumentation",instrumentationVersion:"1.0.0",diag:t,config:{}}),this._shouldCleanupPathOptionsFromRouteName=!0,this._currentRoute=null,this._currentRouteSpan=null,this._instrumentationType=null,this._removeSessionStartedFn=null,this._removeSessionEndedFn=null,this.setInstrumentationType=t=>{this._instrumentationType=t},this.setCurrentRoute=t=>{var e;this._config.enabled&&t.url!==(null==(e=this._currentRoute)?void 0:e.url)&&(this._endRouteSpan(),this._startRouteSpan(t),this._currentRoute=t)},this._setupSessionListeners=()=>{this._removeSessionStartedFn||(this._removeSessionStartedFn=this.sessionManager.addSessionStartedListener(()=>{this._currentRoute&&!this._currentRouteSpan&&(this._diag.debug("Session started, starting route span."),this._startRouteSpan(this._currentRoute))})),this._removeSessionEndedFn||(this._removeSessionEndedFn=this.sessionManager.addSessionEndedListener(()=>{this._currentRouteSpan&&(this._diag.debug("Session ended, ending route span."),this._endRouteSpan())}))},this._cleanUpSessionListeners=()=>{this._removeSessionStartedFn&&(this._removeSessionStartedFn(),this._removeSessionStartedFn=null),this._removeSessionEndedFn&&(this._removeSessionEndedFn(),this._removeSessionEndedFn=null)},this._startRouteSpan=t=>{this._diag.debug(`Starting route span for url: ${t.url}`),this._setupSessionListeners();const e=this._shouldCleanupPathOptionsFromRouteName?t.path.replace(is,""):t.path;return this._currentRouteSpan=this.tracer.startSpan(e,{attributes:{[$e]:en.View,[tn]:e}}),this._instrumentationType&&this._currentRouteSpan.setAttribute("emb.instrumentation",this._instrumentationType),this._currentRouteSpan},this._endRouteSpan=()=>{this._currentRouteSpan&&this._currentRoute&&(this._diag.debug(`Ending route span for url: ${this._currentRoute.url}`),this._currentRouteSpan.end(),this._currentRouteSpan=null)},this.enable=()=>{this._diag.debug("NavigationInstrumentation enabled, listening for navigation events.")},this.disable=()=>{this._cleanUpSessionListeners(),this.setConfig({enabled:!1}),this._diag.debug("NavigationInstrumentation disabled, stopped listening for navigation events.")},this._shouldCleanupPathOptionsFromRouteName=e,this._config.enabled&&this.enable()}}let os;function as(t){var e;const n=t.tracerProvider||re.getTracerProvider(),r=t.meterProvider||zt.getMeterProvider(),i=t.loggerProvider||we.getLoggerProvider();var s;const o=null!=(s=null==(e=t.instrumentations)?void 0:e.flat())?s:[];return function(t,e,n,r){for(let i=0,s=t.length;i<s;i++){const s=t[i];e&&s.setTracerProvider(e),n&&s.setMeterProvider(n),r&&s.setLoggerProvider&&s.setLoggerProvider(r),s.getConfig().enabled||s.enable()}}(o,n,r,i),()=>{!function(t){t.forEach(t=>t.disable())}(o)}}let us=console.error.bind(console);function cs(t,e,n){const r=!!t[e]&&Object.prototype.propertyIsEnumerable.call(t,e);Object.defineProperty(t,e,{configurable:!0,enumerable:r,writable:!0,value:n})}const ls=(t,e,n)=>{if(!t||!t[e])return void us("no original function "+String(e)+" to wrap");if(!n)return us("no wrapper function"),void us((new Error).stack);const r=t[e];if("function"!=typeof r||"function"!=typeof n)return void us("original object and wrapper must be functions");const i=n(r,e);return cs(i,"__original",r),cs(i,"__unwrap",()=>{t[e]===i&&cs(t,e,r)}),cs(i,"__wrapped",!0),cs(t,e,i),i},hs=(t,e,n)=>{if(!t)return us("must provide one or more modules to patch"),void us((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach(t=>{e.forEach(e=>{ls(t,e,n)})}):us("must provide one or more functions to wrap on modules")},ds=(t,e)=>{if(!t||!t[e])return us("no function to unwrap."),void us((new Error).stack);const n=t[e];n.__unwrap?n.__unwrap():us("no original to unwrap to -- has "+String(e)+" already been unwrapped?")},ps=(t,e)=>{if(!t)return us("must provide one or more modules to patch"),void us((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach(t=>{e.forEach(e=>{ds(t,e)})}):us("must provide one or more functions to unwrap on modules")};function gs(){return gs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gs.apply(this,arguments)}class ms{get meter(){return this._meter}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){var t;const e=null!=(t=this.init())?t:[];return Array.isArray(e)?e:[e]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(t){this._config=gs({enabled:!0},t)}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(t,e,n,r){if(t)try{t(n,r)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}constructor(t,e,n){this._config={},this._wrap=ls,this._unwrap=ds,this._massWrap=hs,this._massUnwrap=ps,this.instrumentationName=t,this.instrumentationVersion=e,this.setConfig(n),this._diag=Ht.createComponentLogger({namespace:t}),this._tracer=re.getTracer(t,e),this._meter=zt.getMeter(t,e),this._logger=we.getLogger(t,e),this._updateMetricInstruments()}}class fs extends ms{constructor(t,e,n){super(t,e,n),this._config.enabled&&this.enable()}}function _s(t,e,n){let r,i;try{i=t()}catch(t){r=t}finally{return e(r,i),i}}function vs(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped}var bs;function Ss(t,e){let n=bs.OLD;const r=null==e?void 0:e.split(",").map(t=>t.trim()).filter(t=>""!==t);for(const e of null!=r?r:[]){if(e.toLowerCase()===t+"/dup"){n=bs.DUPLICATE;break}e.toLowerCase()===t&&(n=bs.STABLE)}return n}!function(t){t[t.STABLE=1]="STABLE",t[t.OLD=2]="OLD",t[t.DUPLICATE=3]="DUPLICATE"}(bs||(bs={}));const ys=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;function Ts(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class Es{static FromAttributeList(t){const e=new Es({});return e._rawAttributes=Rs(t),e._asyncAttributesPending=t.filter(([t,e])=>ys(e)).length>0,e}get asyncAttributesPending(){return this._asyncAttributesPending}waitForAsyncAttributes(){return(t=function*(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){const[e,n]=this._rawAttributes[t];this._rawAttributes[t]=[e,ys(n)?yield n:n]}this._asyncAttributesPending=!1}},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Ts(s,r,i,o,a,"next",t)}function a(t){Ts(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}get attributes(){if(this.asyncAttributesPending&&Ht.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const t={};for(const[r,i]of this._rawAttributes){var e,n;if(ys(i))Ht.debug(`Unsettled resource attribute ${r} skipped`);else if(null!=i)null!=(e=t)[n=r]||(e[n]=i)}return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}merge(t){return null==t?this:Es.FromAttributeList([...t.getRawAttributes(),...this.getRawAttributes()])}constructor(t){var e;this._asyncAttributesPending=!1;const n=null!=(e=t.attributes)?e:{};this._rawAttributes=Object.entries(n).map(([t,e])=>(ys(e)&&(this._asyncAttributesPending=!0),[t,e])),this._rawAttributes=Rs(this._rawAttributes)}}function ws(t){return Es.FromAttributeList(Object.entries(t))}function Ls(){return ws({})}function Cs(){return ws({[Ue]:"unknown_service",[Fe]:An[Fe],[je]:An[je],[Be]:An[Be]})}function Rs(t){return t.map(([t,e])=>ys(e)?[t,e.catch(e=>{Ht.debug("promise rejection for resource attribute: %s - %s",t,e)})]:[t,e])}function As(){return As=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},As.apply(this,arguments)}class xs{spanContext(){return this._spanContext}setAttribute(t,e){if(null==e||this._isSpanEnded())return this;if(0===t.length)return Ht.warn(`Invalid attribute key: ${t}`),this;if(!yn(e))return Ht.warn(`Invalid attribute value set for key: ${t}`),this;const{attributeCountLimit:n}=this._spanLimits;return void 0!==n&&Object.keys(this.attributes).length>=n&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(e),this)}setAttributes(t){for(const[e,n]of Object.entries(t))this.setAttribute(e,n);return this}addEvent(t,e,n){if(this._isSpanEnded())return this;const{eventCountLimit:r}=this._spanLimits;if(0===r)return Ht.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==r&&this.events.length>=r&&(0===this._droppedEventsCount&&Ht.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Un(e)&&(Un(n)||(n=e),e=void 0);const i=bn(e);return this.events.push({name:t,attributes:i,time:this._getTime(n),droppedAttributesCount:0}),this}addLink(t){return this.links.push(t),this}addLinks(t){return this.links.push(...t),this}setStatus(t){return this._isSpanEnded()||(this.status=As({},t),null!=this.status.message&&"string"!=typeof t.message&&(Ht.warn(`Dropping invalid status.message of type '${typeof t.message}', expected 'string'`),delete this.status.message)),this}updateName(t){return this._isSpanEnded()||(this.name=t),this}end(t){this._isSpanEnded()?Ht.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`):(this._ended=!0,this.endTime=this._getTime(t),this._duration=function(t,e){let n=e[0]-t[0],r=e[1]-t[1];return r<0&&(n-=1,r+=Pn),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(Ht.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&Ht.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this))}_getTime(t){if("number"==typeof t&&t<=Cn.now())return Mn(t+this._performanceOffset);if("number"==typeof t)return On(t);if(t instanceof Date)return On(t.getTime());if(kn(t))return t;if(this._startTimeProvided)return On(Date.now());const e=Cn.now()-this._performanceStartTime;return Fn(this.startTime,On(e))}isRecording(){return!1===this._ended}recordException(t,e){const n={};"string"==typeof t?n[xe]=t:t&&(t.code?n[Oe]=t.code.toString():t.name&&(n[Oe]=t.name),t.message&&(n[xe]=t.message),t.stack&&(n[Pe]=t.stack)),n[Oe]||n[xe]?this.addEvent("exception",n,e):Ht.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const t=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);Ht.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,t)}return this._ended}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_truncateToSize(t){const e=this._attributeValueLengthLimit;return e<=0?(Ht.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map(t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t):t}constructor(t){this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:It.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1];const e=Date.now();var n;this._spanContext=t.spanContext,this._performanceStartTime=Cn.now(),this._performanceOffset=e-(this._performanceStartTime+Dn()),this._startTimeProvided=null!=t.startTime,this._spanLimits=t.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=t.spanProcessor,this.name=t.name,this.parentSpanContext=t.parentSpanContext,this.kind=t.kind,this.links=t.links||[],this.startTime=this._getTime(null!=(n=t.startTime)?n:e),this.resource=t.resource,this.instrumentationScope=t.scope,null!=t.attributes&&this.setAttributes(t.attributes),this._spanProcessor.onStart(this,t.context)}}var Ps;!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Ps||(Ps={}));class Os{shouldSample(){return{decision:Ps.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class Ds{shouldSample(){return{decision:Ps.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class Ms{shouldSample(t,e,n,r,i,s){const o=re.getSpanContext(t);return o&&xt(o)?o.isRemote?o.traceFlags&I.SAMPLED?this._remoteParentSampled.shouldSample(t,e,n,r,i,s):this._remoteParentNotSampled.shouldSample(t,e,n,r,i,s):o.traceFlags&I.SAMPLED?this._localParentSampled.shouldSample(t,e,n,r,i,s):this._localParentNotSampled.shouldSample(t,e,n,r,i,s):this._root.shouldSample(t,e,n,r,i,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}constructor(t){var e,n,r,i;this._root=t.root,this._root||(wn(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Ds),this._remoteParentSampled=null!=(e=t.remoteParentSampled)?e:new Ds,this._remoteParentNotSampled=null!=(n=t.remoteParentNotSampled)?n:new Os,this._localParentSampled=null!=(r=t.localParentSampled)?r:new Ds,this._localParentNotSampled=null!=(i=t.localParentNotSampled)?i:new Os}}class Ns{shouldSample(t,e){return{decision:At(e)&&this._accumulate(e)<this._upperBound?Ps.RECORD_AND_SAMPLED:Ps.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let e=0;for(let n=0;n<t.length/8;n++){const r=8*n;e=(e^parseInt(t.slice(r,r+8),16))>>>0}return e}constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(4294967295*this._ratio)}}function Is(){return{sampler:ks(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:null!=void 0?undefined:1/0,attributeCountLimit:null!=void 0?undefined:128},spanLimits:{attributeValueLengthLimit:null!=void 0?undefined:1/0,attributeCountLimit:null!=void 0?undefined:128,linkCountLimit:null!=void 0?undefined:128,eventCountLimit:null!=void 0?undefined:128,attributePerEventCountLimit:null!=void 0?undefined:128,attributePerLinkCountLimit:null!=void 0?undefined:128}}}function ks(){const t=null!=void 0?undefined:"parentbased_always_on";switch(t){case"always_on":return new Ds;case"always_off":return new Os;case"parentbased_always_on":return new Ms({root:new Ds});case"parentbased_always_off":return new Ms({root:new Os});case"traceidratio":return new Ns(Us());case"parentbased_traceidratio":return new Ms({root:new Ns(Us())});default:return Ht.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "parentbased_always_on".`),new Ms({root:new Ds})}}function Us(){return Ht.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1}const Fs=1/0;class js{forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(t,e){}onEnd(t){this._shutdownOnce.isCalled||0!==(t.spanContext().traceFlags&I.SAMPLED)&&this._addToBuffer(t)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(t){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&Ht.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(Ht.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()}_flushAll(){return new Promise((t,e)=>{const n=[];for(let t=0,e=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);t<e;t++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{t()}).catch(e)})}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((t,e)=>{const n=setTimeout(()=>{e(new Error("Timeout"))},this._exportTimeoutMillis);Bt.with(gn(Bt.active()),()=>{let r;this._finishedSpans.length<=this._maxExportBatchSize?(r=this._finishedSpans,this._finishedSpans=[]):r=this._finishedSpans.splice(0,this._maxExportBatchSize);const i=()=>this._exporter.export(r,r=>{var i;(clearTimeout(n),r.code===jn.SUCCESS)?t():e(null!=(i=r.error)?i:new Error("BatchSpanProcessor: span export failed"))});let s=null;for(let t=0,e=r.length;t<e;t++){const e=r[t];e.resource.asyncAttributesPending&&e.resource.waitForAsyncAttributes&&(null!=s||(s=[]),s.push(e.resource.waitForAsyncAttributes()))}null===s?i():Promise.all(s).then(i,t=>{wn(t),e(t)})})})}_maybeStartTimer(){if(this._isExporting)return;const t=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{this._isExporting=!1,wn(t)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout(()=>t(),this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}constructor(t,e){this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0,this._exporter=t,this._maxExportBatchSize="number"==typeof(null==e?void 0:e.maxExportBatchSize)?e.maxExportBatchSize:null!=void 0?undefined:512,this._maxQueueSize="number"==typeof(null==e?void 0:e.maxQueueSize)?e.maxQueueSize:null!=void 0?undefined:2048,this._scheduledDelayMillis="number"==typeof(null==e?void 0:e.scheduledDelayMillis)?e.scheduledDelayMillis:null!=void 0?undefined:5e3,this._exportTimeoutMillis="number"==typeof(null==e?void 0:e.exportTimeoutMillis)?e.exportTimeoutMillis:null!=void 0?undefined:3e4,this._shutdownOnce=new br(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Ht.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}}class Bs extends js{onInit(t){!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush().catch(t=>{wn(t)})},this._pageHideListener=()=>{this.forceFlush().catch(t=>{wn(t)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}constructor(t,e){super(t,e),this.onInit(e)}}class Hs{constructor(){this.generateTraceId=$s(16),this.generateSpanId=$s(8)}}const Vs=Array(32);function $s(t){return function(){for(let e=0;e<2*t;e++)Vs[e]=Math.floor(16*Math.random())+48,Vs[e]>=58&&(Vs[e]+=39);return String.fromCharCode.apply(null,Vs.slice(0,2*t))}}class zs{startSpan(t,e={},n=Bt.active()){e.root&&(n=re.deleteSpan(n));const r=re.getSpan(n);if(mn(n)){Ht.debug("Instrumentation suppressed, returning Noop Span");return re.wrapSpanContext(_t)}const i=null==r?void 0:r.spanContext(),s=this._idGenerator.generateSpanId();let o,a,u;var c;i&&re.isSpanContextValid(i)?(a=i.traceId,u=i.traceState,o=i):a=this._idGenerator.generateTraceId();const l=null!=(c=e.kind)?c:Nt.INTERNAL;var h;const d=(null!=(h=e.links)?h:[]).map(t=>({context:t.context,attributes:bn(t.attributes)})),p=bn(e.attributes),g=this._sampler.shouldSample(n,a,t,l,p,d);var m;u=null!=(m=g.traceState)?m:u;const f={traceId:a,spanId:s,traceFlags:g.decision===Mt.RECORD_AND_SAMPLED?I.SAMPLED:I.NONE,traceState:u};if(g.decision===Mt.NOT_RECORD){Ht.debug("Recording is off, propagating context in a non-recording span");return re.wrapSpanContext(f)}const _=bn(Object.assign(p,g.attributes));return new xs({resource:this._resource,scope:this.instrumentationScope,context:n,spanContext:f,name:t,kind:l,links:d,parentSpanContext:o,attributes:_,startTime:e.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(t,e,n,r){let i,s,o;if(arguments.length<2)return;2===arguments.length?o=e:3===arguments.length?(i=e,o=n):(i=e,s=n,o=r);const a=null!=s?s:Bt.active(),u=this.startSpan(t,i,a),c=re.setSpan(a,u);return Bt.with(c,o,void 0,u)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}constructor(t,e,n,r){const i=function(t){const e={sampler:ks()},n=Is(),r=Object.assign({},n,e,t);return r.generalLimits=Object.assign({},n.generalLimits,t.generalLimits||{}),r.spanLimits=Object.assign({},n.spanLimits,t.spanLimits||{}),r}(e);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=e.idGenerator||new Hs,this._resource=n,this._spanProcessor=r,this.instrumentationScope=t}}class qs{forceFlush(){const t=[];for(const e of this._spanProcessors)t.push(e.forceFlush());return new Promise(e=>{Promise.all(t).then(()=>{e()}).catch(t=>{wn(t||new Error("MultiSpanProcessor: forceFlush failed")),e()})})}onStart(t,e){for(const n of this._spanProcessors)n.onStart(t,e)}onEnd(t){for(const e of this._spanProcessors)e.onEnd(t)}shutdown(){const t=[];for(const e of this._spanProcessors)t.push(e.shutdown());return new Promise((e,n)=>{Promise.all(t).then(()=>{e()},n)})}constructor(t){this._spanProcessors=t}}var Gs,Ws;!function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"}(Gs||(Gs={}));class Qs{getTracer(t,e,n){const r=`${t}@${e||""}:${(null==n?void 0:n.schemaUrl)||""}`;return this._tracers.has(r)||this._tracers.set(r,new zs({name:t,version:e,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(r)}forceFlush(){const t=this._config.forceFlushTimeoutMillis,e=this._activeSpanProcessor._spanProcessors.map(e=>new Promise(n=>{let r;const i=setTimeout(()=>{n(new Error(`Span processor did not completed within timeout period of ${t} ms`)),r=Gs.timeout},t);e.forceFlush().then(()=>{clearTimeout(i),r!==Gs.timeout&&(r=Gs.resolved,n(r))}).catch(t=>{clearTimeout(i),r=Gs.error,n(t)})}));return new Promise((t,n)=>{Promise.all(e).then(e=>{const r=e.filter(t=>t!==Gs.resolved);r.length>0?n(r):t()}).catch(t=>n([t]))})}shutdown(){return this._activeSpanProcessor.shutdown()}constructor(t={}){var e;this._tracers=new Map;const n=or({},Is(),function(t){var e,n,r,i;const s=Object.assign({},t.spanLimits);var o,a,u,c,l,h,d,p;return s.attributeCountLimit=null!=(c=null!=(u=null!=(a=null!=(o=null==(e=t.spanLimits)?void 0:e.attributeCountLimit)?o:null==(n=t.generalLimits)?void 0:n.attributeCountLimit)?a:void 0)?u:void 0)?c:128,s.attributeValueLengthLimit=null!=(p=null!=(d=null!=(h=null!=(l=null==(r=t.spanLimits)?void 0:r.attributeValueLengthLimit)?l:null==(i=t.generalLimits)?void 0:i.attributeValueLengthLimit)?h:void 0)?d:void 0)?p:Fs,Object.assign({},t,{spanLimits:s})}(t));var r;this._resource=null!=(r=n.resource)?r:Cs(),this._config=Object.assign({},n,{resource:this._resource});const i=[];(null==(e=t.spanProcessors)?void 0:e.length)&&i.push(...t.spanProcessors),this._activeSpanProcessor=new qs(i)}}class Ks{_bindFunction(t=U,e){const n=this,r=function(...r){return n.with(t,()=>e.apply(this,r))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),r}active(){return this._currentContext}bind(t,e){return void 0===t&&(t=this.active()),"function"==typeof e?this._bindFunction(t,e):e}disable(){return this._currentContext=U,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=U),this}with(t,e,n,...r){const i=this._currentContext;this._currentContext=t||U;try{return e.call(n,...r)}finally{this._currentContext=i}}constructor(){this._enabled=!1,this._currentContext=U}}class Xs extends Qs{register(t={}){var e;re.setGlobalTracerProvider(this),null!==(e=t.propagator)&&(void 0!==e?te.setGlobalPropagator(e):te.setGlobalPropagator(new Bn({propagators:[new Kn,new vn]}))),function(t){if(null!==t){if(void 0===t){const t=new Ks;return t.enable(),void Bt.setGlobalContextManager(t)}t.enable(),Bt.setGlobalContextManager(t)}}(t.contextManager)}constructor(t={}){super(t)}}!function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(Ws||(Ws={}));let Js;function Ys(t,e){return e in t}function Zs(t,e,n,r=!0){if(Ys(n,e)&&"number"==typeof n[e]&&(!r||0!==n[e]))return t.addEvent(e,n[e])}function to(t,e,n=!1,r,i){if(void 0===r&&(r=0!==e[Ws.START_TIME]),n||(Zs(t,Ws.FETCH_START,e,r),Zs(t,Ws.DOMAIN_LOOKUP_START,e,r),Zs(t,Ws.DOMAIN_LOOKUP_END,e,r),Zs(t,Ws.CONNECT_START,e,r),Zs(t,Ws.SECURE_CONNECTION_START,e,r),Zs(t,Ws.CONNECT_END,e,r),Zs(t,Ws.REQUEST_START,e,r),Zs(t,Ws.RESPONSE_START,e,r),Zs(t,Ws.RESPONSE_END,e,r)),!i){const n=e[Ws.ENCODED_BODY_SIZE];void 0!==n&&t.setAttribute("http.response_content_length",n);const r=e[Ws.DECODED_BODY_SIZE];void 0!==r&&n!==r&&t.setAttribute("http.response_content_length_uncompressed",r)}}function eo(){return"undefined"!=typeof location?location.origin:void 0}function no(t,e,n,r,i=new WeakSet,s){const o=ro(t),a=function(t,e,n,r,i,s){const o=In(e),a=In(n);let u=r.filter(e=>{const n=In(Nn(e[Ws.FETCH_START])),r=In(Nn(e[Ws.RESPONSE_END]));return e.initiatorType.toLowerCase()===(s||"xmlhttprequest")&&e.name===t&&n>=o&&r<=a});u.length>0&&(u=u.filter(t=>!i.has(t)));return u}(t=o.toString(),e,n,r,i,s);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const u=function(t){return t.slice().sort((t,e)=>{const n=t[Ws.FETCH_START],r=e[Ws.FETCH_START];return n>r?1:n<r?-1:0})}(a);if(o.origin!==eo()&&u.length>1){let t=u[0],e=function(t,e,n){const r=In(n),i=In(Nn(e));let s,o=t[1];const a=t.length;for(let e=1;e<a;e++){const n=t[e],a=In(Nn(n[Ws.FETCH_START])),u=r-In(Nn(n[Ws.RESPONSE_END]));a>=i&&(!s||u<s)&&(s=u,o=n)}return o}(u,t[Ws.RESPONSE_END],n);const r=t[Ws.RESPONSE_END];return e[Ws.FETCH_START]<r&&(e=t,t=void 0),{corsPreFlightRequest:t,mainRequest:e}}return{mainRequest:a[0]}}function ro(t){if("function"==typeof URL)return new URL(t,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);const e=(Js||(Js=document.createElement("a")),Js);return e.href=t,e}function io(t,e){let n=e||[];("string"==typeof n||n instanceof RegExp)&&(n=[n]);return ro(t).origin===eo()||n.some(e=>fr(t,e))}var so=function(t){return t.DOCUMENT_LOAD="documentLoad",t.DOCUMENT_FETCH="documentFetch",t.RESOURCE_FETCH="resourceFetch",t}({}),oo=function(t){return t.FIRST_PAINT="firstPaint",t.FIRST_CONTENTFUL_PAINT="firstContentfulPaint",t}({});const ao={"first-paint":oo.FIRST_PAINT,"first-contentful-paint":oo.FIRST_CONTENTFUL_PAINT};class uo extends ei{init(){this._diag.debug("Initializing document load instrumentation")}_addResourcesSpans(t){performance.getEntriesByType("resource").forEach(e=>{this._initResourceSpan(e,t)})}_collectPerformance(){const t=Array.from(document.getElementsByTagName("meta")).find(t=>t.getAttribute("name")===Gn),e=(()=>{const t={},e=window.performance.getEntriesByType("navigation")[0];return Object.values(Ws).forEach(n=>{if(Ys(e,n)){const r=e[n];"number"==typeof r&&(t[n]=r)}}),t})(),n=t&&t.content||"";Bt.with(te.extract(U,{traceparent:n}),()=>{var t;const n=this._startSpan(so.DOCUMENT_LOAD,Ws.FETCH_START,e);var r;n&&(Bt.with(re.setSpan(Bt.active(),n),()=>{const t=this._startSpan(so.DOCUMENT_FETCH,Ws.FETCH_START,e);t&&(t.setAttribute(He,location.href),Bt.with(re.setSpan(Bt.active(),t),()=>{var n;to(t,e,this.getConfig().ignoreNetworkEvents),this._addCustomAttributesOnSpan(t,null==(n=this.getConfig().applyCustomAttributesOnSpan)?void 0:n.documentFetch),this._endSpan(t,Ws.RESPONSE_END,e)}))}),n.setAttribute($e,en.DocumentLoad),n.setAttribute(He,location.href),n.setAttribute(Ve,navigator.userAgent),this._addResourcesSpans(n),this.getConfig().ignoreNetworkEvents||(Zs(n,Ws.FETCH_START,e),Zs(n,Ws.UNLOAD_EVENT_START,e),Zs(n,Ws.UNLOAD_EVENT_END,e),Zs(n,Ws.DOM_INTERACTIVE,e),Zs(n,Ws.DOM_CONTENT_LOADED_EVENT_START,e),Zs(n,Ws.DOM_CONTENT_LOADED_EVENT_END,e),Zs(n,Ws.DOM_COMPLETE,e),Zs(n,Ws.LOAD_EVENT_START,e),Zs(n,Ws.LOAD_EVENT_END,e)),this.getConfig().ignorePerformancePaintEvents||(r=n,window.performance.getEntriesByType("paint").forEach(({name:t,startTime:e})=>{Ys(ao,t)&&r.addEvent(ao[t],e)})),this._addCustomAttributesOnSpan(n,null==(t=this.getConfig().applyCustomAttributesOnSpan)?void 0:t.documentLoad),this._endSpan(n,Ws.LOAD_EVENT_END,e))})}_endSpan(t,e,n){t&&(Ys(n,e)&&"number"==typeof n[e]?t.end(n[e]):t.end())}_initResourceSpan(t,e){const n=this._startSpan(so.RESOURCE_FETCH,Ws.FETCH_START,t,e);var r;n&&(n.setAttribute($e,en.ResourceFetch),n.setAttribute(He,t.name),to(n,t,this.getConfig().ignoreNetworkEvents),t.deliveryType&&n.setAttribute("delivery_type",t.deliveryType),n.setAttribute("entry_type",t.entryType),n.setAttribute("initiator_type",t.initiatorType),t.renderBlockingStatus&&n.setAttribute("render_blocking_status",t.renderBlockingStatus),n.setAttribute(Ne,t.responseStatus),n.setAttribute(Rr,t.encodedBodySize),n.setAttribute("http.response.size",t.transferSize),n.setAttribute("decoded_body_size",t.decodedBodySize),this._addCustomAttributesOnResourceSpan(n,t,null==(r=this.getConfig().applyCustomAttributesOnSpan)?void 0:r.resourceFetch),this._endSpan(n,Ws.RESPONSE_END,t))}_startSpan(t,e,n,r){if(Ys(n,e)&&"number"==typeof n[e]){return this.tracer.startSpan(t,{startTime:n[e]},r?re.setSpan(Bt.active(),r):void 0)}}_waitForPageLoad(){"complete"===window.document.readyState?this._onDocumentLoaded():window.addEventListener("load",this._onDocumentLoaded)}_addCustomAttributesOnSpan(t,e){e&&_s(()=>{e(t)},t=>{t&&this._diag.error("addCustomAttributesOnSpan",t)})}_addCustomAttributesOnResourceSpan(t,e,n){n&&_s(()=>{n(t,e)},t=>{t&&this._diag.error("addCustomAttributesOnResourceSpan",t)})}enable(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()}disable(){window.removeEventListener("load",this._onDocumentLoaded)}constructor({diag:t,perf:e,enabled:n,applyCustomAttributesOnSpan:r,ignorePerformancePaintEvents:i=!1,ignoreNetworkEvents:s=!1}={}){super({instrumentationName:"DocumentLoadInstrumentation",instrumentationVersion:"1.0.0",diag:t,perf:e,config:{enabled:n,applyCustomAttributesOnSpan:r,ignorePerformancePaintEvents:i,ignoreNetworkEvents:s}}),this._onDocumentLoaded=()=>{window.setTimeout(()=>{this._collectPerformance()},0)},this._config.enabled&&this.enable()}}class co{set severityText(t){this._isLogRecordReadonly()||(this._severityText=t)}get severityText(){return this._severityText}set severityNumber(t){this._isLogRecordReadonly()||(this._severityNumber=t)}get severityNumber(){return this._severityNumber}set body(t){this._isLogRecordReadonly()||(this._body=t)}get body(){return this._body}get eventName(){return this._eventName}set eventName(t){this._isLogRecordReadonly()||(this._eventName=t)}get droppedAttributesCount(){return this.totalAttributesCount-Object.keys(this.attributes).length}setAttribute(t,e){return this._isLogRecordReadonly()||null===e?this:0===t.length?(Ht.warn(`Invalid attribute key: ${t}`),this):yn(e)||"object"==typeof e&&!Array.isArray(e)&&Object.keys(e).length>0?(this.totalAttributesCount+=1,Object.keys(this.attributes).length>=this._logRecordLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(1===this.droppedAttributesCount&&Ht.warn("Dropping extra attributes."),this):(yn(e)?this.attributes[t]=this._truncateToSize(e):this.attributes[t]=e,this)):(Ht.warn(`Invalid attribute value set for key: ${t}`),this)}setAttributes(t){for(const[e,n]of Object.entries(t))this.setAttribute(e,n);return this}setBody(t){return this.body=t,this}setEventName(t){return this.eventName=t,this}setSeverityNumber(t){return this.severityNumber=t,this}setSeverityText(t){return this.severityText=t,this}_makeReadonly(){this._isReadonly=!0}_truncateToSize(t){const e=this._logRecordLimits.attributeValueLengthLimit;return e<=0?(Ht.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map(t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t):t}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_isLogRecordReadonly(){return this._isReadonly&&Ht.warn("Can not execute the operation on emitted log record"),this._isReadonly}constructor(t,e,n){this.attributes={},this.totalAttributesCount=0,this._isReadonly=!1;const{timestamp:r,observedTimestamp:i,eventName:s,severityNumber:o,severityText:a,body:u,attributes:c={},context:l}=n,h=Date.now();if(this.hrTime=Nn(null!=r?r:h),this.hrTimeObserved=Nn(null!=i?i:h),l){const t=re.getSpanContext(l);t&&xt(t)&&(this.spanContext=t)}this.severityNumber=o,this.severityText=a,this.body=u,this.resource=t.resource,this.instrumentationScope=e,this._logRecordLimits=t.logRecordLimits,this._eventName=s,this.setAttributes(c)}}function lo(){return lo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lo.apply(this,arguments)}class ho{emit(t){const e=t.context||Bt.active(),n=new co(this._sharedState,this.instrumentationScope,lo({context:e},t));this._sharedState.activeProcessor.onEmit(n,e),n._makeReadonly()}constructor(t,e){this.instrumentationScope=t,this._sharedState=e}}class po{forceFlush(){return Promise.resolve()}onEmit(t,e){}shutdown(){return Promise.resolve()}}function go(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function mo(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){go(s,r,i,o,a,"next",t)}function a(t){go(s,r,i,o,a,"throw",t)}o(void 0)})}}class fo{forceFlush(){return mo(function*(){const t=this.forceFlushTimeoutMillis;yield Promise.all(this.processors.map(e=>mr(e.forceFlush(),t)))}).call(this)}onEmit(t,e){this.processors.forEach(n=>n.onEmit(t,e))}shutdown(){return mo(function*(){yield Promise.all(this.processors.map(t=>t.shutdown()))}).call(this)}constructor(t,e){this.processors=t,this.forceFlushTimeoutMillis=e}}class _o{constructor(t,e,n,r){this.loggers=new Map,this.registeredLogRecordProcessors=[],this.resource=t,this.forceFlushTimeoutMillis=e,this.logRecordLimits=n,this.processors=r,r.length>0?(this.registeredLogRecordProcessors=r,this.activeProcessor=new fo(this.registeredLogRecordProcessors,this.forceFlushTimeoutMillis)):this.activeProcessor=new po}}class vo{getLogger(t,e,n){if(this._shutdownOnce.isCalled)return Ht.warn("A shutdown LoggerProvider cannot provide a Logger"),fe;t||Ht.warn("Logger requested without instrumentation scope name.");const r=t||"unknown",i=`${r}@${e||""}:${(null==n?void 0:n.schemaUrl)||""}`;return this._sharedState.loggers.has(i)||this._sharedState.loggers.set(i,new ho({name:r,version:e,schemaUrl:null==n?void 0:n.schemaUrl},this._sharedState)),this._sharedState.loggers.get(i)}forceFlush(){return this._shutdownOnce.isCalled?(Ht.warn("invalid attempt to force flush after LoggerProvider shutdown"),this._shutdownOnce.promise):this._sharedState.activeProcessor.forceFlush()}shutdown(){return this._shutdownOnce.isCalled?(Ht.warn("shutdown may only be called once per LoggerProvider"),this._shutdownOnce.promise):this._shutdownOnce.call()}_shutdown(){return this._sharedState.activeProcessor.shutdown()}constructor(t={}){const e=or({},{forceFlushTimeoutMillis:3e4,logRecordLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},includeTraceContext:!0},t);var n;const r=null!=(n=t.resource)?n:Cs();var i,s,o,a,u,c,l,h;this._sharedState=new _o(r,e.forceFlushTimeoutMillis,(s=e.logRecordLimits,{attributeCountLimit:null!=(u=null!=(a=null!=(o=s.attributeCountLimit)?o:void 0)?a:void 0)?u:128,attributeValueLengthLimit:null!=(h=null!=(l=null!=(c=s.attributeValueLengthLimit)?c:void 0)?l:void 0)?h:1/0}),null!=(i=null==t?void 0:t.processors)?i:[]),this._shutdownOnce=new br(this._shutdown,this)}}function bo(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class So{onEmit(t){this._shutdownOnce.isCalled||this._addToBuffer(t)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}shutdown(){return this._shutdownOnce.call()}_shutdown(){return(t=function*(){this.onShutdown(),yield this._flushAll(),yield this._exporter.shutdown()},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){bo(s,r,i,o,a,"next",t)}function a(t){bo(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}_addToBuffer(t){this._finishedLogRecords.length>=this._maxQueueSize||(this._finishedLogRecords.push(t),this._maybeStartTimer())}_flushAll(){return new Promise((t,e)=>{const n=[],r=Math.ceil(this._finishedLogRecords.length/this._maxExportBatchSize);for(let t=0;t<r;t++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{t()}).catch(e)})}_flushOneBatch(){return this._clearTimer(),0===this._finishedLogRecords.length?Promise.resolve():new Promise((t,e)=>{mr(this._export(this._finishedLogRecords.splice(0,this._maxExportBatchSize)),this._exportTimeoutMillis).then(()=>t()).catch(e)})}_maybeStartTimer(){void 0===this._timer&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedLogRecords.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{wn(t)})},this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}_export(t){const e=()=>Sr._export(this._exporter,t).then(t=>{var e;t.code!==jn.SUCCESS&&wn(null!=(e=t.error)?e:new Error(`BatchLogRecordProcessor: log record export failed (status ${t})`))}).catch(wn),n=t.map(t=>t.resource).filter(t=>t.asyncAttributesPending);return 0===n.length?e():Promise.all(n.map(t=>null==t.waitForAsyncAttributes?void 0:t.waitForAsyncAttributes.call(t))).then(e,wn)}constructor(t,e){var n,r,i,s,o,a,u,c;this._finishedLogRecords=[],this._exporter=t,this._maxExportBatchSize=null!=(r=null!=(n=null==e?void 0:e.maxExportBatchSize)?n:void 0)?r:512,this._maxQueueSize=null!=(s=null!=(i=null==e?void 0:e.maxQueueSize)?i:void 0)?s:2048,this._scheduledDelayMillis=null!=(a=null!=(o=null==e?void 0:e.scheduledDelayMillis)?o:void 0)?a:5e3,this._exportTimeoutMillis=null!=(c=null!=(u=null==e?void 0:e.exportTimeoutMillis)?u:void 0)?c:3e4,this._shutdownOnce=new br(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Ht.warn("BatchLogRecordProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}}class yo extends So{onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}_onInit(t){!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush()},this._pageHideListener=()=>{this.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}constructor(t,e){super(t,e),this._onInit(e)}}function To(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function Eo(t){const e=new Uint8Array(t.length/2);let n=0;for(let r=0;r<t.length;r+=2){const i=To(t.charCodeAt(r)),s=To(t.charCodeAt(r+1));e[n++]=i<<4|s}return e}function wo(t){const e=BigInt(1e9);return BigInt(t[0])*e+BigInt(t[1])}function Lo(t){const e=wo(t);return n=e,{low:Number(BigInt.asUintN(32,n)),high:Number(BigInt.asUintN(32,n>>BigInt(32)))};var n}const Co="undefined"!=typeof BigInt?function(t){return wo(t).toString()}:In;function Ro(t){return t}function Ao(t){if(void 0!==t)return Eo(t)}const xo={encodeHrTime:Lo,encodeSpanContext:Eo,encodeOptionalSpanContext:Ao};function Po(t){if(void 0===t)return xo;var e;const n=null==(e=t.useLongBits)||e;var r;const i=null!=(r=t.useHex)&&r;return{encodeHrTime:n?Lo:Co,encodeSpanContext:i?Ro:Eo,encodeOptionalSpanContext:i?Ro:Ao}}function Oo(t){return{attributes:Mo(t.attributes),droppedAttributesCount:0}}function Do(t){return{name:t.name,version:t.version}}function Mo(t){return Object.keys(t).map(e=>No(e,t[e]))}function No(t,e){return{key:t,value:Io(e)}}function Io(t){const e=typeof t;return"string"===e?{stringValue:t}:"number"===e?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:"boolean"===e?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(Io)}}:"object"===e&&null!=t?{kvlistValue:{values:Object.entries(t).map(([t,e])=>No(t,e))}}:{}}function ko(t,e){const n=function(t){const e=new Map;for(const n of t){const{resource:t,instrumentationScope:{name:r,version:i="",schemaUrl:s=""}}=n;let o=e.get(t);o||(o=new Map,e.set(t,o));const a=`${r}@${i}:${s}`;let u=o.get(a);u||(u=[],o.set(a,u)),u.push(n)}return e}(t);return Array.from(n,([t,n])=>({resource:Oo(t),scopeLogs:Array.from(n,([,t])=>({scope:Do(t[0].instrumentationScope),logRecords:t.map(t=>function(t,e){var n,r,i;return{timeUnixNano:e.encodeHrTime(t.hrTime),observedTimeUnixNano:e.encodeHrTime(t.hrTimeObserved),severityNumber:t.severityNumber,severityText:t.severityText,body:Io(t.body),eventName:t.eventName,attributes:Uo(t.attributes),droppedAttributesCount:t.droppedAttributesCount,flags:null==(n=t.spanContext)?void 0:n.traceFlags,traceId:e.encodeOptionalSpanContext(null==(r=t.spanContext)?void 0:r.traceId),spanId:e.encodeOptionalSpanContext(null==(i=t.spanContext)?void 0:i.spanId)}}(t,e)),schemaUrl:t[0].instrumentationScope.schemaUrl})),schemaUrl:void 0}))}function Uo(t){return Object.keys(t).map(e=>No(e,t[e]))}function Fo(t,e){var n,r,i;const s=t.spanContext(),o=t.status,a=(null==(n=t.parentSpanContext)?void 0:n.spanId)?e.encodeSpanContext(null==(r=t.parentSpanContext)?void 0:r.spanId):void 0;return{traceId:e.encodeSpanContext(s.traceId),spanId:e.encodeSpanContext(s.spanId),parentSpanId:a,traceState:null==(i=s.traceState)?void 0:i.serialize(),name:t.name,kind:null==t.kind?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:Mo(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(t=>function(t,e){return{attributes:t.attributes?Mo(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e)),droppedEventsCount:t.droppedEventsCount,status:{code:o.code,message:o.message},links:t.links.map(t=>function(t,e){var n;return{attributes:t.attributes?Mo(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:null==(n=t.context.traceState)?void 0:n.serialize(),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e)),droppedLinksCount:t.droppedLinksCount}}function jo(t,e){const n=function(t){const e=new Map;for(const n of t){let t=e.get(n.resource);t||(t=new Map,e.set(n.resource,t));const r=`${n.instrumentationScope.name}@${n.instrumentationScope.version||""}:${n.instrumentationScope.schemaUrl||""}`;let i=t.get(r);i||(i=[],t.set(r,i)),i.push(n)}return e}(t),r=[],i=n.entries();let s=i.next();for(;!s.done;){const[t,n]=s.value,o=[],a=n.values();let u=a.next();for(;!u.done;){const t=u.value;if(t.length>0){const n=t.map(t=>Fo(t,e));o.push({scope:Do(t[0].instrumentationScope),spans:n,schemaUrl:t[0].instrumentationScope.schemaUrl})}u=a.next()}const c={resource:Oo(t),scopeSpans:o,schemaUrl:void 0};r.push(c),s=i.next()}return r}const Bo={serializeRequest:t=>{const e={resourceLogs:ko(t,Po({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}},Ho={serializeRequest:t=>{const e={resourceSpans:jo(t,Po({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};class Vo{export(t,e){this._delegate.export(t,e)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}constructor(t){this._delegate=t}}class $o extends Vo{constructor(t){super(_a(t,Bo))}}const zo=(t,e)=>Zo(t,e)+"/v2/logs";function qo(){return qo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qo.apply(this,arguments)}class Go extends $o{constructor({appID:t,userID:e,embraceDataURL:n}){super(qo({},ta,{headers:Yo(t,e),url:zo(t,n)}))}}function Wo(){return Wo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wo.apply(this,arguments)}class Qo extends Vo{constructor(t){super(_a(Wo({},t,{compression:"gzip"}),Ho))}}const Ko=(t,e)=>Zo(t,e)+"/v2/spans";function Xo(){return Xo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xo.apply(this,arguments)}class Jo extends Qo{constructor({appID:t,userID:e,embraceDataURL:n}){super(Xo({},ta,{headers:Yo(t,e),url:Ko(t,n)}))}}const Yo=(t,e)=>({"X-EM-AID":t,"X-EM-DID":e}),Zo=(t,e)=>e||`https://a-${t}.data.emb-api.com`,ta={compression:"gzip",keepalive:!0,concurrencyLimit:5,timeoutMillis:3e4};class ea extends Error{constructor(t,e,n){super(t),this.name="OTLPExporterError",this.data=n,this.code=e}}function na(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class ra{pushPromise(t){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(t);const e=()=>{const e=this._sendingPromises.indexOf(t);this._sendingPromises.splice(e,1)};t.then(e,e)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}awaitAll(){return(t=function*(){yield Promise.all(this._sendingPromises)},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){na(s,r,i,o,a,"next",t)}function a(t){na(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}constructor(t){this._sendingPromises=[],this._concurrencyLimit=t}}function ia(t){return new ra(t.concurrencyLimit)}function sa(){return{handleResponse(t){null!=t&&function(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}(t)&&null!=t.partialSuccess&&0!==Object.keys(t.partialSuccess).length&&Ht.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}}}function oa(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}class aa{export(t,e){if(this._diagLogger.debug("items to be sent",t),this._promiseQueue.hasReachedLimit())return void e({code:jn.FAILED,error:new Error("Concurrent export limit reached")});const n=this._serializer.serializeRequest(t);null!=n?this._promiseQueue.pushPromise(this._transport.send(n,this._timeout).then(t=>{if("success"!==t.status)"failure"===t.status&&t.error?e({code:jn.FAILED,error:t.error}):"retryable"===t.status?e({code:jn.FAILED,error:new ea("Export failed with retryable status")}):e({code:jn.FAILED,error:new ea("Export failed with unknown error")});else{if(null!=t.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(t.data))}catch(e){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",e,t.data)}e({code:jn.SUCCESS})}},t=>e({code:jn.FAILED,error:t}))):e({code:jn.FAILED,error:new Error("Nothing to send")})}forceFlush(){return this._promiseQueue.awaitAll()}shutdown(){return(t=function*(){this._diagLogger.debug("shutdown started"),yield this.forceFlush(),this._transport.shutdown()},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){oa(s,r,i,o,a,"next",t)}function a(t){oa(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var t}constructor(t,e,n,r,i){this._transport=t,this._serializer=e,this._responseHandler=n,this._promiseQueue=r,this._timeout=i,this._diagLogger=Ht.createComponentLogger({namespace:"OTLPExportDelegate"})}}function ua(t,e,n){return r={transport:n,serializer:e,promiseHandler:ia(t)},i={timeout:t.timeoutMillis},new aa(r.transport,r.serializer,sa(),r.promiseHandler,i.timeout);var r,i}function ca(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function la(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){ca(s,r,i,o,a,"next",t)}function a(t){ca(s,r,i,o,a,"throw",t)}o(void 0)})}}function ha(){return ha=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ha.apply(this,arguments)}class da{static _compressRequest(t){return la(function*(){const e=new CompressionStream("gzip"),n=e.writable.getWriter();n.write(t),n.close();const r=[],i=e.readable.getReader();let s=!1;for(;!s;){const t=yield i.read();t.value&&r.push(t.value),s=t.done}const o=new Uint8Array(r.reduce((t,e)=>t+e.length,0));let a=0;for(const t of r)o.set(t,a),a+=t.length;return o})()}send(t,e){return this._asyncSend(t,e)}shutdown(){}_asyncSend(t,e){return la(function*(){let n=t;const r=ha({"Content-Type":"application/json"},this._config.headers);"gzip"===this._config.compression&&(n=yield da._compressRequest(t),r["Content-Encoding"]="gzip",r["Content-Length"]=n.length.toString());try{return(yield fetch(this._config.url,{method:"POST",keepalive:!0,headers:r,body:n,signal:AbortSignal.timeout(e)})).ok?{status:"success"}:{status:"failure",error:new Error("Fetch request failed")}}catch(t){return{status:"failure",error:new Error("Fetch request errored")}}}).call(this)}constructor(t){this._config=t}}const pa=t=>new da(t);function ga(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}const ma=()=>40*Math.random()-20;class fa{send(t,e){return(n=function*(){const n=this._perf.getNowMillis()+e;let r=yield this._transport.send(t,e),i=5,s=1e3;for(;"retryable"===r.status&&i>0;){i--;const e=Math.max(Math.min(s,5e3)+ma(),0);var o;s*=1.5;const a=null!=(o=r.retryInMillis)?o:e,u=n-this._perf.getNowMillis();if(a>u)return r;r=yield this._retry(t,u,a)}return r},function(){var t=this,e=arguments;return new Promise(function(r,i){var s=n.apply(t,e);function o(t){ga(s,r,i,o,a,"next",t)}function a(t){ga(s,r,i,o,a,"throw",t)}o(void 0)})}).call(this);var n}shutdown(){this._transport.shutdown()}_retry(t,e,n){return new Promise((r,i)=>{setTimeout(()=>{this._transport.send(t,e).then(r,i)},n)})}constructor(t,e=new yr){this._transport=t,this._perf=e}}const _a=(t,e)=>{return ua(t,e,(n={transport:pa(t)},new fa(n.transport,null!=(r=n.perf)?r:new yr)));var n,r};class va{get diag(){return this._diag}get processorName(){return this._processorName}constructor({diag:t,processorName:e}){this._processorName=e,this._diag=null!=t?t:Ht.createComponentLogger({namespace:e})}}function ba(){return ba=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ba.apply(this,arguments)}const Sa="embrace_pending_";class ya extends va{forceFlush(){return this.diag.debug("forceFlush called for EmbraceSessionBatchedSpanProcessor. This is a no op"),Promise.resolve(void 0)}onEnd(t){if(this._shutdownOnce.isCalled)this.diag.debug("span ended after processor shutdown. Ignoring span.");else if((t=>t.attributes[$e]===en.Session)(t))this.diag.debug("session span ended. Exporting all pending spans."),this._exportSpans([t,...this._pendingSpans]),this._pendingSpans=[];else{if(this.diag.debug("non-session span ended. Adding to pending spans queue."),this._limitManager.dropReadableSpan(t))return;this._pendingSpans.push(t)}}_exportSpans(t){Sr._export(this._exporter,t).then(t=>{var e;t.code===jn.FAILED&&this.diag.error(`spans failed to export: ${(null==(e=t.error)?void 0:e.message)||"unknown error"}`)}).catch(t=>{let e="unknown error";t&&t instanceof Error?e=t.message:"string"==typeof t&&(e=t),this.diag.error(`spans failed to export: ${e}`)})}onStart(){}getPendingSpansCount(){return this._pendingSpans.length}storePendingSpans(t,e){try{const n=`${Sa}${t}_${Date.now()}`;this._storage.setItem(n,JSON.stringify([e,...this._pendingSpans]))}catch(t){this.diag.error("Failed to store spans to storage:",t)}}clearStoredSpans(t){try{const e=[];for(let n=0;n<this._storage.length;n++){const r=this._storage.key(n);r&&r.startsWith(`${Sa}${t}_`)&&e.push(r)}e.forEach(t=>{this._storage.removeItem(t)})}catch(t){this.diag.error("Failed to clear stored spans from storage:",t)}}_startExpiredSpansCheck(){this._checkExpiredSpansInterval=setInterval(()=>{this._checkAndExportExpiredSpans()},6e4)}_checkAndExportExpiredSpans(){try{const t=[];for(let e=0;e<this._storage.length;e++){const n=this._storage.key(e);n&&n.startsWith(Sa)&&t.push(n)}const e=Date.now();t.forEach(t=>{const n=t.split("_"),r=parseInt(n[n.length-1],10);if(isNaN(r)||e-r<=36e5)return;const i=this._storage.getItem(t),s=JSON.parse(i);this._exportSpans(s),this._storage.removeItem(t)})}catch(t){this.diag.error("Failed to check and export expired spans:",t)}}shutdown(){return this._shutdownOnce.call()}constructor(t){var{exporter:e,limitManager:n,storage:r=window.localStorage}=t,i=function(t,e){if(null==t)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,["exporter","limitManager","storage"]);super(ba({},i,{processorName:"EmbraceSessionBatchedSpanProcessor"})),this._pendingSpans=[],this._shutdown=()=>(this._checkExpiredSpansInterval&&clearInterval(this._checkExpiredSpansInterval),this._exporter.shutdown()),this._exporter=e,this._shutdownOnce=new br(this._shutdown,this),this._limitManager=n,this._storage=r,this._startExpiredSpansCheck()}}class Ta{forceFlush(){return Promise.resolve(void 0)}onEmit(t){t.setAttributes({[Ar]:cn(),[xr]:this._spanSessionManager.getSessionId()})}shutdown(){return Promise.resolve(void 0)}constructor({spanSessionManager:t}){this._spanSessionManager=t}}const Ea=/.+:\/\/.+/;class wa{forceFlush(){return Promise.resolve(void 0)}onEnd(t){var e,n,r,i,s,o,a,u,c;(t=>{if((t.attributes[De]||t.attributes[Le])&&("number"==typeof t.attributes[Ne]||"number"==typeof t.attributes[Re])){var e;const n=null!=(e=t.attributes[He])?e:t.attributes[Ce];return!(!n||"string"!=typeof n||!Ea.exec(n))}return!1})(t)&&(t.attributes[$e]=en.Network,null!=(e=t.attributes)[n=He]||(e[n]=t.attributes[Ce]),null!=(r=t.attributes)[i=Ne]||(r[i]=t.attributes[Re]),null!=(s=t.attributes)[o=De]||(s[o]=t.attributes[Le]),null!=(a=t.attributes)[u=Rr]||(a[u]=t.attributes["http.response_content_length"]),null!=(c=t.attributes)["http.request.body.size"]||(c["http.request.body.size"]=t.attributes["http.request_content_length"]))}onStart(){}shutdown(){return Promise.resolve(void 0)}}class La{forceFlush(){return Promise.resolve(void 0)}onEmit(t){t.attributes[$e]||t.setAttribute($e,en.SystemLog),t.setAttribute(He,this._urlDocument.URL)}shutdown(){return Promise.resolve(void 0)}constructor({urlDocument:t=window.document}={}){this._urlDocument=t}}class Ca{forceFlush(){return Promise.resolve(void 0)}onEmit(t){this._userManager.getUserId()&&t.setAttributes({[Pr]:this._userManager.getUserId()})}shutdown(){return Promise.resolve(void 0)}constructor({userManager:t}){this._userManager=t}}class Ra{forceFlush(){return Promise.resolve(void 0)}onEnd(t){const e=this._userManager.getUserId();e&&(t.attributes[Pr]=e)}onStart(){}shutdown(){return Promise.resolve(void 0)}constructor({userManager:t}){this._userManager=t}}class Aa{forceFlush(){return Promise.resolve(void 0)}onEmit(t){this._attributeScrubbers.forEach(e=>{const n=t.attributes[e.key];n&&"string"==typeof n&&t.setAttribute(e.key,e.scrub(n))})}shutdown(){return Promise.resolve(void 0)}constructor({attributeScrubbers:t}){this._attributeScrubbers=t}}class xa{forceFlush(){return Promise.resolve(void 0)}onEnd(t){this._attributeScrubbers.forEach(e=>{const n=t.attributes[e.key];n&&"string"==typeof n&&(t.attributes[e.key]=e.scrub(n))})}onStart(){}shutdown(){return Promise.resolve(void 0)}constructor({attributeScrubbers:t}){this._attributeScrubbers=t}}const Pa="2.0.1",Oa="embrace-web-sdk",Da="embrace_app_instance_id",Ma=(t,e)=>{let n=null;try{n=t.getItem(Da)}catch(t){e.warn("Failed to retrieve app instance ID from session storage",t)}if(!n){e.debug("No existing app instance ID found in session storage, creating a new one"),n=cn();try{t.setItem(Da,n)}catch(t){e.warn("Failed to persist app instance ID to session storage",t)}}return n};var Na;!function(t){t.COMPONENT="component",t.HTTP_STATUS_TEXT="http.status_text"}(Na||(Na={}));var Ia,ka={};function Ua(){return Ia||(Ia=1,Object.defineProperty(ka,"__esModule",{value:!0}),ka.ATTR_HTTP_USER_AGENT=ka.ATTR_HTTP_URL=ka.ATTR_HTTP_STATUS_CODE=ka.ATTR_HTTP_SCHEME=ka.ATTR_HTTP_RESPONSE_CONTENT_LENGTH=ka.ATTR_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED=ka.ATTR_HTTP_REQUEST_BODY_SIZE=ka.ATTR_HTTP_METHOD=ka.ATTR_HTTP_HOST=void 0,ka.ATTR_HTTP_HOST="http.host",ka.ATTR_HTTP_METHOD="http.method",ka.ATTR_HTTP_REQUEST_BODY_SIZE="http.request.body.size",ka.ATTR_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED="http.request_content_length_uncompressed",ka.ATTR_HTTP_RESPONSE_CONTENT_LENGTH="http.response_content_length",ka.ATTR_HTTP_SCHEME="http.scheme",ka.ATTR_HTTP_STATUS_CODE="http.status_code",ka.ATTR_HTTP_URL="http.url",ka.ATTR_HTTP_USER_AGENT="http.user_agent"),ka}var Fa=Ua();function ja(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}const Ba=Ht.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});function Ha(...t){if(t[0]instanceof URL||"string"==typeof t[0]){const e=t[1];if(!(null==e?void 0:e.body))return Promise.resolve();if(e.body instanceof ReadableStream){const{body:t,length:n}=function(t){if(!t.pipeThrough)return Ba.warn("Platform has ReadableStream but not pipeThrough!"),{body:t,length:Promise.resolve(void 0)};let e,n=0;const r=new Promise(t=>{e=t}),i=new TransformStream({start(){},transform(t,e){return(r=function*(){const r=yield t;n+=r.byteLength,e.enqueue(t)},function(){var t=this,e=arguments;return new Promise(function(n,i){var s=r.apply(t,e);function o(t){ja(s,n,i,o,a,"next",t)}function a(t){ja(s,n,i,o,a,"throw",t)}o(void 0)})})();var r},flush(){e(n)}});return{body:t.pipeThrough(i),length:r}}(e.body);return e.body=t,n}return Promise.resolve(function(t){if(e=t,"undefined"!=typeof Document&&e instanceof Document)return(new XMLSerializer).serializeToString(document).length;var e;if("string"==typeof t)return $a(t);if(t instanceof Blob)return t.size;if(t instanceof FormData)return function(t){let e=0;for(const[n,r]of t.entries())e+=n.length,r instanceof Blob?e+=r.size:e+=r.length;return e}(t);if(t instanceof URLSearchParams)return $a(t.toString());if(void 0!==t.byteLength)return t.byteLength;return void Ba.warn("unknown body type")}(e.body))}{const e=t[0];return(null==e?void 0:e.body)?e.clone().text().then(t=>$a(t)):Promise.resolve()}}const Va=new TextEncoder;function $a(t){return Va.encode(t).byteLength}function za(t){const e=function(){void 0===Ga&&(Ga=qa);return Ga}(),n=t.toUpperCase();return n in e?n:"_OTHER"}const qa={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let Ga;const Wa={"https:":"443","http:":"80"};const Qa="0.203.0";var Ka;const Xa="object"==typeof process&&"node"===(null==(Ka=process.release)?void 0:Ka.name);class Ja extends fs{init(){}_addChildSpan(t,e){const n=this.tracer.startSpan("CORS Preflight",{startTime:e[Ws.FETCH_START]},re.setSpan(Bt.active(),t)),r=!(this._semconvStability&bs.OLD);to(n,e,this.getConfig().ignoreNetworkEvents,void 0,r),n.end(e[Ws.RESPONSE_END])}_addFinalSpanAttributes(t,e){const n=ro(e.url);if(this._semconvStability&bs.OLD&&(t.setAttribute(Fa.ATTR_HTTP_STATUS_CODE,e.status),null!=e.statusText&&t.setAttribute(Na.HTTP_STATUS_TEXT,e.statusText),t.setAttribute(Fa.ATTR_HTTP_HOST,n.host),t.setAttribute(Fa.ATTR_HTTP_SCHEME,n.protocol.replace(":","")),"undefined"!=typeof navigator&&t.setAttribute(Fa.ATTR_HTTP_USER_AGENT,navigator.userAgent)),this._semconvStability&bs.STABLE){t.setAttribute(Ne,e.status),t.setAttribute(Ie,n.hostname);const r=function(t){const e=Number(t.port||Wa[t.protocol]);return e&&!isNaN(e)?e:void 0}(n);r&&t.setAttribute(ke,r)}}_addHeaders(t,e){if(!io(e,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return te.inject(Bt.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(t instanceof Request)te.inject(Bt.active(),t.headers,{set:(t,e,n)=>t.set(e,"string"==typeof n?n:String(n))});else if(t.headers instanceof Headers)te.inject(Bt.active(),t.headers,{set:(t,e,n)=>t.set(e,"string"==typeof n?n:String(n))});else if(t.headers instanceof Map)te.inject(Bt.active(),t.headers,{set:(t,e,n)=>t.set(e,"string"==typeof n?n:String(n))});else{const e={};te.inject(Bt.active(),e),t.headers=Object.assign({},e,t.headers||{})}}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(t,e={}){if(_r(t,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let n="";const r={};if(this._semconvStability&bs.OLD){const i=(e.method||"GET").toUpperCase();n=`HTTP ${i}`,r[Na.COMPONENT]=this.moduleName,r[Fa.ATTR_HTTP_METHOD]=i,r[Fa.ATTR_HTTP_URL]=t}if(this._semconvStability&bs.STABLE){const i=e.method,s=za(e.method||"GET");n||(n=s),r[De]=s,s!==i&&(r[Me]=i),r[He]=t}return this.tracer.startSpan(n,{kind:Nt.CLIENT,attributes:r})}_findResourceAndAddNetworkEvents(t,e,n){let r=e.entries;if(!r.length){if(!performance.getEntriesByType)return;r=performance.getEntriesByType("resource")}const i=no(e.spanUrl,e.startTime,n,r,this._usedResources,"fetch");if(i.mainRequest){const e=i.mainRequest;this._markResourceAsUsed(e);const n=i.corsPreFlightRequest;n&&(this._addChildSpan(t,n),this._markResourceAsUsed(n));const r=!(this._semconvStability&bs.OLD);to(t,e,this.getConfig().ignoreNetworkEvents,void 0,r)}}_markResourceAsUsed(t){this._usedResources.add(t)}_endSpan(t,e,n){const r=On(Date.now()),i=Mn();this._addFinalSpanAttributes(t,n),this._semconvStability&bs.STABLE&&n.status>=400&&(t.setStatus({code:It.ERROR}),t.setAttribute(Ae,String(n.status))),setTimeout(()=>{var n;null==(n=e.observer)||n.disconnect(),this._findResourceAndAddNetworkEvents(t,e,i),this._tasksCount--,this._clearResources(),t.end(r)},300)}_patchConstructor(){return t=>{const e=this;return function(...n){const r=this,i=ro(n[0]instanceof Request?n[0].url:String(n[0])).href,s=n[0]instanceof Request?n[0]:n[1]||{},o=e._createSpan(i,s);if(!o)return t.apply(this,n);const a=e._prepareSpanData(i);function u(t,n){e._applyAttributesAfterFetch(t,s,n),e._endSpan(t,a,{status:n.status||0,statusText:n.message,url:i})}function c(t,n){e._applyAttributesAfterFetch(t,s,n),n.status>=200&&n.status<400?e._endSpan(t,a,n):e._endSpan(t,a,{status:n.status,statusText:n.statusText,url:i})}function l(t,e,n){try{const e=n.clone().body;if(e){const r=e.getReader(),i=()=>{r.read().then(({done:e})=>{e?c(t,n):i()},e=>{u(t,e)})};i()}else c(t,n)}finally{e(n)}}function h(t,e,n){try{u(t,n)}finally{e(n)}}return e.getConfig().measureRequestSize&&Ha(...n).then(t=>{t&&(e._semconvStability&bs.OLD&&o.setAttribute(Fa.ATTR_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED,t),e._semconvStability&bs.STABLE&&o.setAttribute(Fa.ATTR_HTTP_REQUEST_BODY_SIZE,t))}).catch(t=>{e._diag.warn("getFetchBodyLength",t)}),new Promise((n,a)=>Bt.with(re.setSpan(Bt.active(),o),()=>(e._addHeaders(s,i),e._callRequestHook(o,s),e._tasksCount++,t.apply(r,s instanceof Request?[s]:[i,s]).then(l.bind(r,o,n),h.bind(r,o,a)))))}}}_applyAttributesAfterFetch(t,e,n){const r=this.getConfig().applyCustomAttributesOnSpan;r&&_s(()=>r(t,e,n),t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)})}_callRequestHook(t,e){const n=this.getConfig().requestHook;n&&_s(()=>n(t,e),t=>{t&&this._diag.error("requestHook",t)})}_prepareSpanData(t){const e=Mn(),n=[];if("function"!=typeof PerformanceObserver)return{entries:n,startTime:e,spanUrl:t};const r=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{"fetch"===e.initiatorType&&e.name===t&&n.push(e)})});return r.observe({entryTypes:["resource"]}),{entries:n,observer:r,startTime:e,spanUrl:t}}enable(){Xa?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):(vs(fetch)&&(this._unwrap(Ln,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(Ln,"fetch",this._patchConstructor()))}disable(){Xa||(this._unwrap(Ln,"fetch"),this._usedResources=new WeakSet)}constructor(t={}){super("@opentelemetry/instrumentation-fetch",Qa,t),this.component="fetch",this.version=Qa,this.moduleName=this.component,this._usedResources=new WeakSet,this._tasksCount=0,this._semconvStability=Ss("http",null==t?void 0:t.semconvStabilityOptIn)}}var Ya;!function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"}(Ya||(Ya={}));const Za=Ht.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-xml-http-request/utils"});function tu(t){return e=t,"undefined"!=typeof Document&&e instanceof Document?(new XMLSerializer).serializeToString(document).length:"string"==typeof t?nu(t):t instanceof Blob?t.size:t instanceof FormData?function(t){let e=0;for(const[n,r]of t.entries())e+=n.length,r instanceof Blob?e+=r.size:e+=r.length;return e}(t):t instanceof URLSearchParams?nu(t.toString()):void 0!==t.byteLength?t.byteLength:void Za.warn("unknown body type");var e}const eu=new TextEncoder;function nu(t){return eu.encode(t).byteLength}const ru={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0};let iu;function su(){return void 0===iu&&(iu=ru),iu}const ou={"https:":"443","http:":"80"};const au="0.203.0";var uu;!function(t){t.HTTP_STATUS_TEXT="http.status_text"}(uu||(uu={}));class cu extends fs{init(){}_addHeaders(t,e){if(!io(ro(e).href,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return te.inject(Bt.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}const n={};te.inject(Bt.active(),n),Object.keys(n).forEach(e=>{t.setRequestHeader(e,String(n[e]))})}_addChildSpan(t,e){Bt.with(re.setSpan(Bt.active(),t),()=>{const t=this.tracer.startSpan("CORS Preflight",{startTime:e[Ws.FETCH_START]}),n=!(this._semconvStability&bs.OLD);to(t,e,this.getConfig().ignoreNetworkEvents,void 0,n),t.end(e[Ws.RESPONSE_END])})}_addFinalSpanAttributes(t,e,n){if(this._semconvStability&bs.OLD){if(void 0!==e.status&&t.setAttribute("http.status_code",e.status),void 0!==e.statusText&&t.setAttribute(uu.HTTP_STATUS_TEXT,e.statusText),"string"==typeof n){const e=ro(n);t.setAttribute("http.host",e.host),t.setAttribute("http.scheme",e.protocol.replace(":",""))}t.setAttribute("http.user_agent",navigator.userAgent)}this._semconvStability&bs.STABLE&&e.status&&t.setAttribute(Ne,e.status)}_applyAttributesAfterXHR(t,e){const n=this.getConfig().applyCustomAttributesOnSpan;"function"==typeof n&&_s(()=>n(t,e),t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)})}_addResourceObserver(t,e){const n=this._xhrMem.get(t);n&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(n.createdResources={observer:new PerformanceObserver(t=>{const r=t.getEntries(),i=ro(e);r.forEach(t=>{"xmlhttprequest"===t.initiatorType&&t.name===i.href&&n.createdResources&&n.createdResources.entries.push(t)})}),entries:[]},n.createdResources.observer.observe({entryTypes:["resource"]}))}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(Cn.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)}_findResourceAndAddNetworkEvents(t,e,n,r,i){if(!(n&&r&&i&&t.createdResources))return;let s=t.createdResources.entries;s&&s.length||(s=Cn.getEntriesByType("resource"));const o=no(ro(n).href,r,i,s,this._usedResources);if(o.mainRequest){const t=o.mainRequest;this._markResourceAsUsed(t);const n=o.corsPreFlightRequest;n&&(this._addChildSpan(e,n),this._markResourceAsUsed(n));const r=!(this._semconvStability&bs.OLD);to(e,t,this.getConfig().ignoreNetworkEvents,void 0,r)}}_cleanPreviousSpanInformation(t){const e=this._xhrMem.get(t);if(e){const n=e.callbackToRemoveEvents;n&&n(),this._xhrMem.delete(t)}}_createSpan(t,e,n){if(_r(e,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");let r="";const i=ro(e),s={};if(this._semconvStability&bs.OLD&&(r=n.toUpperCase(),s["http.method"]=n,s["http.url"]=i.toString()),this._semconvStability&bs.STABLE){const t=n,e=function(t){const e=su(),n=t.toUpperCase();return n in e?n:"_OTHER"}(n);r||(r=e),s[De]=e,e!==t&&(s[Me]=t),s[He]=i.toString(),s[Ie]=i.hostname;const o=function(t){const e=Number(t.port||ou[t.protocol]);return e&&!isNaN(e)?e:void 0}(i);o&&(s[ke]=o)}const o=this.tracer.startSpan(r,{kind:Nt.CLIENT,attributes:s});return o.addEvent(Ya.METHOD_OPEN),this._cleanPreviousSpanInformation(t),this._xhrMem.set(t,{span:o,spanUrl:e}),o}_markResourceAsUsed(t){this._usedResources.add(t)}_patchOpen(){return t=>{const e=this;return function(...n){const r=n[0],i=n[1];return e._createSpan(this,i,r),t.apply(this,n)}}}_patchSend(){const t=this;function e(e,n,r,i){const s=t._xhrMem.get(n);if(!s)return;if(s.status=n.status,s.statusText=n.statusText,t._xhrMem.delete(n),s.span){const e=s.span;t._applyAttributesAfterXHR(e,n),t._semconvStability&bs.STABLE&&(r?i&&(e.setStatus({code:It.ERROR,message:i}),e.setAttribute(Ae,i)):s.status&&s.status>=400&&(e.setStatus({code:It.ERROR}),e.setAttribute(Ae,String(s.status))))}const o=Mn(),a=Date.now();setTimeout(()=>{!function(e,n,r,i){const s=n.callbackToRemoveEvents;"function"==typeof s&&s();const{span:o,spanUrl:a,sendStartTime:u}=n;o&&(t._findResourceAndAddNetworkEvents(n,o,a,u,r),o.addEvent(e,i),t._addFinalSpanAttributes(o,n,a),o.end(i),t._tasksCount--),t._clearResources()}(e,s,o,a)},300)}function n(){e(Ya.EVENT_ERROR,this,!0,"error")}function r(){e(Ya.EVENT_ABORT,this,!1)}function i(){e(Ya.EVENT_TIMEOUT,this,!0,"timeout")}function s(){this.status<299?e(Ya.EVENT_LOAD,this,!1):e(Ya.EVENT_ERROR,this,!1)}return e=>function(...o){const a=t._xhrMem.get(this);if(!a)return e.apply(this,o);const u=a.span,c=a.spanUrl;if(u&&c){if(t.getConfig().measureRequestSize&&(null==o?void 0:o[0])){const e=tu(o[0]);void 0!==e&&(t._semconvStability&bs.OLD&&u.setAttribute("http.request_content_length_uncompressed",e),t._semconvStability&bs.STABLE&&u.setAttribute("http.request.body.size",e))}Bt.with(re.setSpan(Bt.active(),u),()=>{t._tasksCount++,a.sendStartTime=Mn(),u.addEvent(Ya.METHOD_SEND),this.addEventListener("abort",r),this.addEventListener("error",n),this.addEventListener("load",s),this.addEventListener("timeout",i),a.callbackToRemoveEvents=()=>{!function(e){e.removeEventListener("abort",r),e.removeEventListener("error",n),e.removeEventListener("load",s),e.removeEventListener("timeout",i);const o=t._xhrMem.get(e);o&&(o.callbackToRemoveEvents=void 0)}(this),a.createdResources&&a.createdResources.observer.disconnect()},t._addHeaders(this,c),t._addResourceObserver(this,c)})}return e.apply(this,o)}}enable(){this._diag.debug("applying patch to",this.moduleName,this.version),vs(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),vs(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())}disable(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}constructor(t={}){super("@opentelemetry/instrumentation-xml-http-request",au,t),this.component="xml-http-request",this.version=au,this.moduleName=this.component,this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet,this._semconvStability=Ss("http",null==t?void 0:t.semconvStabilityOptIn)}}function lu(){return lu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lu.apply(this,arguments)}const hu=(t={},{logManager:e,spanSessionManager:n}={})=>{var r,i,s,o,a,u;const c=[new oi(t["session-on-load"]),new ri(t["session-visibility"]),new si(t["session-activity"]),new ui(t["session-timeout"])];(null==(r=t.omit)?void 0:r.has("exception"))||c.push(new ci(t.exception)),(null==(i=t.omit)?void 0:i.has("click"))||c.push(new hi(t.click)),(null==(s=t.omit)?void 0:s.has("web-vital"))||c.push(new rs(t["web-vital"])),(null==(o=t.omit)?void 0:o.has("document-load"))||c.push(new uo(t["document-load"])),(null==(a=t.omit)?void 0:a.has("@opentelemetry/instrumentation-fetch"))||c.push(new Ja(lu({},t.network,t["@opentelemetry/instrumentation-fetch"]))),(null==(u=t.omit)?void 0:u.has("@opentelemetry/instrumentation-xml-http-request"))||c.push(new cu(lu({},t.network,t["@opentelemetry/instrumentation-xml-http-request"])));for(const t of c)t instanceof ei&&(n&&t.setSessionManager(n),e&&t.setLogManager(e));return c};function du(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function pu(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){du(s,r,i,o,a,"next",t)}function a(t){du(s,r,i,o,a,"throw",t)}o(void 0)})}}class gu{forceFlush(){return pu(function*(){})()}onStart(t,e){var n;const r=null==(n=this._sessionIdProvider)?void 0:n.getSessionId();r&&t.setAttribute("session.id",r)}onEnd(t){}shutdown(){return pu(function*(){})()}constructor(t){this._sessionIdProvider=t}}const mu=new class{constructor({diagLogger:t=Ht.createComponentLogger({namespace:"embrace-registry"})}={}){this._sdk=null,this.register=t=>{null!==this._sdk&&this._diag.warn("previously registered sdk will be overwritten"),this._sdk=t},this.clear=()=>{null===this._sdk&&this._diag.warn("sdk already cleared, this is a no-op"),this._sdk=null},this.registered=()=>this._sdk,this._diag=t}},fu=/\/\/(.+):(.+)@(.+)\//,_u=["AWSAccessKeyId","Signature","sig","`X-Goog-Signature","password","auth","pw","token"],vu=({value:t,queryParamRegex:e,scrubPath:n,scrubQuery:r})=>{let i=t;return n&&(i=i.replace(fu,"//REDACTED:REDACTED@$3/")),r&&(i=i.replaceAll(e,"$1$2=REDACTED")),i},bu=t=>{const e=[..._u,...t||[]],n=new RegExp(`(^|&|\\?)(${e.join("|")})=[^&]+`,"g");return[{key:He,scrub:t=>vu({value:t,queryParamRegex:n,scrubPath:!0,scrubQuery:!0})},{key:Ce,scrub:t=>vu({value:t,queryParamRegex:n,scrubPath:!0,scrubQuery:!0})},{key:"url.path",scrub:t=>vu({value:t,queryParamRegex:n,scrubPath:!0,scrubQuery:!1})},{key:"url.query",scrub:t=>vu({value:t,queryParamRegex:n,scrubPath:!1,scrubQuery:!0})}]};function Su(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}const yu=({registerGlobally:t})=>{const e=new zr;return t&&pe.setGlobalUserManager(e),e},Tu=({limitManager:t,registerGlobally:e})=>{const n=new Mr({limitManager:t});return e&&u.setGlobalSessionManager(n),n},Eu=({sendingToEmbrace:t,appID:e,enduserPseudoID:n,resource:r,spanSessionManager:i,userManager:s,spanExporters:o,spanProcessors:a=[],propagator:u=null,contextManager:c=null,limitManager:l,attributeScrubbers:h,embraceDataURL:d,registerGlobally:p})=>{const g=[...a,(m=i,new gu(m)),new wa,new Ra({userManager:s}),new xa({attributeScrubbers:h})];var m;null==o||o.forEach(t=>{g.push(new Bs(t))}),t&&e&&n&&g.push(new ya({exporter:new Jo({appID:e,embraceDataURL:d,userID:n}),limitManager:l}));const f=new Xs({resource:r,spanProcessors:g,spanLimits:{attributeCountLimit:2*kr.maxAllowed.session_property,attributePerEventCountLimit:20,eventCountLimit:2*kr.maxAllowed.breadcrumb,attributeValueLengthLimit:1024}}),_=new Br({tracerProvider:p?void 0:f});return p&&(ue.setGlobalTraceManager(_),f.register({contextManager:c,propagator:u})),{tracerProvider:f,embraceTraceManager:_}},wu=({sendingToEmbrace:t,appID:e,enduserPseudoID:n,resource:r,userManager:s,logExporters:o,logProcessors:a,spanSessionManager:u,limitManager:c,attributeScrubbers:l,embraceDataURL:h,registerGlobally:d})=>{const p=[...a,new Ta({spanSessionManager:u}),new La,new Ca({userManager:s}),new Aa({attributeScrubbers:l})];null==o||o.forEach(t=>{p.push(new yo(t))}),t&&e&&n&&p.push(new yo(new Go({appID:e,embraceDataURL:h,userID:n})));const g=new vo({resource:r,processors:p}),m=new Cr({spanSessionManager:u,limitManager:c,loggerProvider:d?void 0:g});return d&&(we.setGlobalLoggerProvider(g),i.setGlobalLogManager(m)),{loggerProvider:g,embraceLogManager:m}};return t.getNavigationInstrumentation=(t={})=>(os||(os=new ss(t)),os),t.initSDK=({appID:e,appVersion:n,resource:r=Ls(),spanExporters:i=[],logExporters:s=[],spanProcessors:o=[],propagator:a=null,defaultInstrumentationConfig:u,instrumentations:c=[],contextManager:l=null,logProcessors:h=[],attributeScrubbers:d=[],enableDefaultAttributeScrubbing:p=!0,additionalQueryParamsToScrub:g=[],logLevel:m=t.DiagLogLevel.ERROR,embraceDataURL:f,embraceConfigURL:_,diagLogger:v=Ht.createComponentLogger({namespace:"embrace-sdk"}),dynamicSDKConfigManager:b,dynamicSDKConfig:S,registerGlobally:y=!0}={appID:""})=>{try{const t=new yr,T=t.getNowMillis();if(y){const t=mu.registered();if(null!==t)return v.warn("SDK has already been successfully initialized, skipping this invocation of initSDK"),t}Ht.setLogger(new j,{logLevel:m});const E=r.merge((({diagLogger:t,appVersion:e,pageSessionStorage:n})=>{const r=null!=e?e:"EmbIOAppVersionX.X.X".trim();return ws({[Ue]:Oa,[je]:Oa,app_version:r,app_framework:1,sdk_version:Pa,[Be]:Pa,sdk_simple_version:1,sdk_platform:"web",[Fe]:"webjs",[Ye]:Ma(n,t),[Ve]:window.navigator.userAgent,screen_resolution:`${window.screen.width}x${window.screen.height}`})})({diagLogger:v,appVersion:n,pageSessionStorage:window.sessionStorage})),w=!!e&&(t=>{if(void 0===t)throw new Error("appID is required when using Embrace exporter");if(5!==t.length)throw new Error("appID should be 5 characters long");return!0})(e);if(!w&&!s.length&&!i.length)throw new Error("when the embrace appID is omitted then at least one logExporter or spanExporter must be set");const L=yu({registerGlobally:y}),C=L.getEmbraceUserId();if(w&&!C)throw new Error("userID is required when using Embrace exporter");const R=null!=b?b:new Jr({appID:e,appVersion:n,embraceConfigURL:_,defaultConfig:S,deviceId:C});R.refreshRemoteConfig();if(!new Yr({dynamicConfigManager:R,deviceId:C}).isSDKEnabled())return v.debug("SDK is disabled, skipping initialization."),!1;const A=new Ir(kr),x=[...p?bu(g):[],...d],P=Tu({limitManager:A,registerGlobally:y}),{tracerProvider:O,embraceTraceManager:D}=Eu({sendingToEmbrace:w,appID:e,enduserPseudoID:C,resource:E,spanSessionManager:P,userManager:L,spanExporters:i,spanProcessors:o,propagator:a,contextManager:l,limitManager:A,attributeScrubbers:x,embraceDataURL:f,registerGlobally:y});P.setTracerProvider(O);const{loggerProvider:M,embraceLogManager:N}=wu({sendingToEmbrace:w,appID:e,enduserPseudoID:C,resource:E,userManager:L,logExporters:s,logProcessors:h,spanSessionManager:P,limitManager:A,attributeScrubbers:x,embraceDataURL:f,registerGlobally:y});as(y?{instrumentations:[hu(u),...c]}:{tracerProvider:O,loggerProvider:M,instrumentations:[hu(u,{logManager:N,spanSessionManager:P}),...c]}),v.info("successfully initialized the SDK");const I={setDynamicConfig:t=>{R.setConfig(t)},flush:()=>{return(t=function*(){yield O.forceFlush(),yield M.forceFlush()},function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){Su(s,r,i,o,a,"next",t)}function a(t){Su(s,r,i,o,a,"throw",t)}o(void 0)})})();var t},log:N,trace:D,session:P,user:L};return y&&mu.register(I),P.recordSDKStartupDuration(t.getNowMillis()-T),I}catch(t){const e=t instanceof Error?t.message:"Unknown error.";return v.error(`failed to initialize the SDK: ${e}`),!1}},t.log=i,t.session=u,t.trace=ue,t.user=pe,t}({});window.EmbraceWebSdk=EmbraceWebSdk;
//# sourceMappingURL=bundle.js.map
